<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="description" content="openEHR Decision Language specification">
<meta name="keywords" content="expressions, rules, guidelines">
<title>Decision Language specification</title>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/openehr.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_decision_language_specification">Decision Language specification</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_primary_author">Primary Author</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_related_documents">1.2. Related Documents</a></li>
<li><a href="#_status">1.3. Status</a></li>
<li><a href="#_feedback">1.4. Feedback</a></li>
<li><a href="#_conformance">1.5. Conformance</a></li>
</ul>
</li>
<li><a href="#_overview">2. Overview</a>
<ul class="sectlevel2">
<li><a href="#_requirements">2.1. Requirements</a>
<ul class="sectlevel3">
<li><a href="#_caller_interaction">2.1.1. Caller Interaction</a></li>
<li><a href="#_representation">2.1.2. Representation</a></li>
<li><a href="#_binding_to_data_context">2.1.3. Binding to Data Context</a></li>
<li><a href="#_type_system">2.1.4. Type System</a></li>
</ul>
</li>
<li><a href="#_execution_model">2.2. Execution Model</a></li>
</ul>
</li>
<li><a href="#_dlm_syntax">3. DLM Syntax</a>
<ul class="sectlevel2">
<li><a href="#_identifiers">3.1. Identifiers</a></li>
<li><a href="#_identification_section">3.2. Identification Section</a></li>
<li><a href="#_language_and_description_sections">3.3. Language and Description Sections</a></li>
<li><a href="#_use_model_section">3.4. Use_model Section</a></li>
<li><a href="#_use_section">3.5. Use Section</a></li>
<li><a href="#_preconditions_section">3.6. Preconditions Section</a></li>
<li><a href="#_reference_section">3.7. Reference Section</a></li>
<li><a href="#_input_section">3.8. Input Section</a>
<ul class="sectlevel3">
<li><a href="#_subject_variables">3.8.1. Subject Variables</a>
<ul class="sectlevel4">
<li><a href="#_variable_naming">3.8.1.1. Variable Naming</a></li>
<li><a href="#_unavailable_values">3.8.1.2. Unavailable Values</a></li>
</ul>
</li>
<li><a href="#_tracked_variables">3.8.2. Tracked Variables</a></li>
<li><a href="#_quantitative_tracked_variables">3.8.3. Quantitative Tracked Variables</a></li>
</ul>
</li>
<li><a href="#_rules_section">3.9. Rules Section</a></li>
<li><a href="#_output_section">3.10. Output Section</a></li>
<li><a href="#_terminology_section">3.11. Terminology Section</a></li>
</ul>
</li>
<li><a href="#_dlm_model">4. DLM Model</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">4.1. Overview</a></li>
<li><a href="#_decision_logic_module_package">4.2. Decision Logic Module Package</a>
<ul class="sectlevel3">
<li><a href="#_pre_conditions_section">4.2.1. Pre-conditions Section</a></li>
<li><a href="#_reference_section_2">4.2.2. Reference Section</a></li>
<li><a href="#_input_section_2">4.2.3. Input Section</a></li>
<li><a href="#_rules_section_2">4.2.4. Rules Section</a></li>
<li><a href="#_class_descriptions">4.2.5. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_decision_logic_module_class">4.2.5.1. DECISION_LOGIC_MODULE Class</a></li>
<li><a href="#_dlm_reference_section_class">4.2.5.2. DLM_REFERENCE_SECTION Class</a></li>
<li><a href="#_dlm_input_section_class">4.2.5.3. DLM_INPUT_SECTION Class</a></li>
<li><a href="#_dlm_rules_section_class">4.2.5.4. DLM_RULES_SECTION Class</a></li>
<li><a href="#_dlm_rule_class">4.2.5.5. DLM_RULE Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_dlm_concrete_model">4.3. DLM Concrete Model</a>
<ul class="sectlevel3">
<li><a href="#_subject_variables_2">4.3.1. Subject Variables</a></li>
<li><a href="#_class_descriptions_2">4.3.2. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_state_variable_class">4.3.2.1. STATE_VARIABLE Class</a></li>
<li><a href="#_value_snapshot_class">4.3.2.2. VALUE_SNAPSHOT Class</a></li>
<li><a href="#_tracked_state_variable_class">4.3.2.3. TRACKED_STATE_VARIABLE Class</a></li>
<li><a href="#_tracked_quantitative_variable_class">4.3.2.4. TRACKED_QUANTITATIVE_VARIABLE Class</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_references">References</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="https://specifications.openehr.org/images/openEHR_logo_RGB.svg" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_decision_language_specification" class="sect0"><a class="anchor" href="#_decision_language_specification"></a>Decision Language specification</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all fit-content spread">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="https://www.openehr.org/programs/specification" target="_blank" rel="noopener">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: PROC latest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: DEVELOPMENT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: expressions, rules, guidelines</p></td>
</tr>
</tbody>
</table>
<div class="imageblock text-center">
<div class="content">
<object type="image/svg+xml" data="openehr_block_diagram.svg" width="60%"><span class="alt">openEHR components</span></object>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2020 - 2021 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="https://www.openehr.org" target="_blank" rel="noopener">The openEHR Foundation</a> is an independent, non-profit foundation, facilitating the sharing of health records by consumers and clinicians via open specifications, clinical models and open platform implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://specifications.openehr.org/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://specifications.openehr.org/components/PROC/open_issues" target="_blank" rel="noopener">Problem Reports</a><br>
 Web: <a href="https://specifications.openehr.org" target="_blank" rel="noopener">specifications.openEHR.org</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record"><a class="anchor" href="#_amendment_record"></a>Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser, Implementer</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>PROC Release 2.0.0 (unreleased)</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue"></a>0.6.0</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://specifications.openehr.org/tickets/SPECPROC-41" target="_blank" rel="noopener">SPECPROC-41</a>. Add Decision Language specification.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>02 Jan 2021</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements"><a class="anchor" href="#_acknowledgements"></a>Acknowledgements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_primary_author"><a class="anchor" href="#_primary_author"></a>Primary Author</h3>
<div class="ulist">
<ul>
<li>
<p>Thomas Beale, Ars Semantica; openEHR Foundation Management Board.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document specifies the openEHR Decision Language, in both abstract syntax form and as a related model. The latter defines the semantics of a first order predicate style logic that can be used to write Decision Logic Modules (DLMs) containing rule-sets that may be used standalone or with a Process / Plan oriented system such as <a href="https://specifications.openehr.org/releases/PROC/latest/task_planning.html" target="_blank" rel="noopener">openEHR Task Planning</a>.</p>
</div>
<div class="paragraph">
<p>The intended audience includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standards bodies producing health informatics standards;</p>
</li>
<li>
<p>Academic groups using openEHR;</p>
</li>
<li>
<p>Solution vendors.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_documents"><a class="anchor" href="#_related_documents"></a>1.2. Related Documents</h3>
<div class="paragraph">
<p>Prerequisite documents for reading this document include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/BASE/latest/architecture_overview.html" target="_blank" rel="noopener">openEHR Architecture Overview</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Related documents include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/PROC/latest/task_planning.html" target="_blank" rel="noopener">openEHR Task Planning specification</a>;</p>
</li>
<li>
<p>The <a href="https://specifications.openehr.org/releases/CDS/latest/GDL2.html" target="_blank" rel="noopener">Guideline Definition Language (GDL2)</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.3. Status</h3>
<div class="paragraph">
<p>This specification is in the DEVELOPMENT state. The development version of this document can be found at <a href="https://specifications.openehr.org/releases/PROC/latest/decision_language.html" target="_blank" rel="noopener">https://specifications.openehr.org/releases/PROC/latest/decision_language.html</a>.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
</div>
<div class="sect2">
<h3 id="_feedback"><a class="anchor" href="#_feedback"></a>1.4. Feedback</h3>
<div class="paragraph">
<p>Feedback may be provided on the <a href="https://discourse.openehr.org/c/specifications/task-planning-gdl" target="_blank" rel="noopener">process specifications forum</a>.</p>
</div>
<div class="paragraph">
<p>Issues may be raised on the <a href="https://specifications.openehr.org/components/PROC/open_issues" target="_blank" rel="noopener">specifications Problem Report tracker</a>.</p>
</div>
<div class="paragraph">
<p>To see changes made due to previously reported issues, see the <a href="https://specifications.openehr.org/components/PROC/history" target="_blank" rel="noopener">PROC component Change Request tracker</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conformance"><a class="anchor" href="#_conformance"></a>1.5. Conformance</h3>
<div class="paragraph">
<p>Conformance of a data or software artifact to an openEHR specification is determined by a formal test of that artifact against the relevant <a href="https://specifications.openehr.org/releases/ITS/latest/index" target="_blank" rel="noopener">openEHR Implementation Technology Specification(s) (ITSs)</a>, such as an IDL interface or an XML-schema. Since ITSs are formal derivations from underlying models, ITS conformance indicates model conformance.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>2. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The openEHR Decision Language (DL) and model defines a formalism for expressing decision logic and rules used by process-oriented healthcare information systems, active forms and so on. Decision logic usually sits within a larger environment of plans, guidelines and data sources such as the EHR, as described in the <a href="https://specifications.openehr.org/releases/PROC/latest/overview.html#_conceptual_framework" target="_blank" rel="noopener">openEHR Process and Planning Overview</a>. The primary encapsulation of DL is within a Decision Logic Module (DLM).</p>
</div>
<div class="paragraph">
<p>Within the openEHR ecosystem, Task Plans and GDL3 guidelines both require a way of expressing rules and declaring input variables. Guidelines additionally need a way of declaring output variables. These needs are achieved with the flexible use of a single kind of multi-section module called a decision logic module (DLM).</p>
</div>
<div class="paragraph">
<p>The Decision Language is a high-level language in which modules containing the following elements may be written:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>reference data</em>: domain constants;</p>
</li>
<li>
<p><em>input variables</em>: data items representing external variables relating to the subject (i.e. patient);</p>
</li>
<li>
<p><em>conditions</em>: Boolean-returning domain-specified criteria;</p>
</li>
<li>
<p><em>rules</em>: domain-specified rules structures based on condition/action structures, which may return any type;</p>
</li>
<li>
<p><em>rule-sets</em>: related sets of rules in various forms, including decision tables;</p>
</li>
<li>
<p><em>outputs</em>: computed results of rule invocations, including logic trace information;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All symbolic elements, including constants, variables and rules may be treated as <em>codes</em> for which a translation terminology is supplied, enabling a DLM to be translated and presented in any natural language.</p>
</div>
<div class="sect2">
<h3 id="_requirements"><a class="anchor" href="#_requirements"></a>2.1. Requirements</h3>
<div class="paragraph">
<p>The requirements of openEHR Decision Language fall into a number of categories, described below.</p>
</div>
<div class="paragraph tbd">
<p>TBD: this section only very rough for now.</p>
</div>
<div class="sect3">
<h4 id="_caller_interaction"><a class="anchor" href="#_caller_interaction"></a>2.1.1. Caller Interaction</h4>
<div class="ulist">
<ul>
<li>
<p>the ability to capture the reasoning chain for presentation to a caller as a justification;</p>
</li>
<li>
<p>the ability to provide a decision and its possible outcomes, with the current recommendation indicated;</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_representation"><a class="anchor" href="#_representation"></a>2.1.2. Representation</h4>
<div class="ulist">
<ul>
<li>
<p>multi-lingual translations for symbolic variables, in a similar way to the <a href="https://specifications.openehr.org/releases/AM/latest/ADL2.html" target="_blank" rel="noopener">openEHR Archetype Definition Language (ADL2)</a>;</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_binding_to_data_context"><a class="anchor" href="#_binding_to_data_context"></a>2.1.3. Binding to Data Context</h4>
<div class="ulist">
<ul>
<li>
<p>bindings that connect variables to external data sources;</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_type_system"><a class="anchor" href="#_type_system"></a>2.1.4. Type System</h4>
<div class="ulist">
<ul>
<li>
<p>an ability to use externally defined information models that supply types that may be used in DL statements.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_execution_model"><a class="anchor" href="#_execution_model"></a>2.2. Execution Model</h3>
<div class="paragraph tbd">
<p>TBD:</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dlm_syntax"><a class="anchor" href="#_dlm_syntax"></a>3. DLM Syntax</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The openEHR Decision Language (DL) is primarily used to write Decision Logic Modules (DLMs). A DLM has the following structure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dlm &lt;form&gt; &lt;identifier&gt;

definitions -- Descriptive

    |
    | lang and translations meta-data, as for archetypes
    |
    language = {
            original_language: [ISO_639-1::en],
            translations: {...}
        }
        ;

    |
    | description meta-data, as for archetypes
    |
    description = {...}
        ;

[use_model
    &lt;reference model ids; defaults to openEHR Foundation &amp; Base types&gt;]

[use
    &lt;local identifier&gt;: &lt;dlm identifier&gt;
    &lt;local identifier&gt;: &lt;dlm identifier&gt;]

[preconditions
    &lt;conditions that act as pre-conditions for this module&gt;]

[definitions -- Reference
    &lt;constant definitions&gt;]

input -- Administrative State
    &lt;administrative subject variables&gt;

input -- Historical State
    &lt;historical subject variables&gt;

input -- Tracked State
    &lt;real-time subject variable&gt;

rules -- Conditions
    &lt;conditions expressed as EL functions&gt;

rules -- Main
    &lt;computational rules expressed as EL functions&gt;

rules -- Output
    &lt;output rules expressed as EL functions&gt;

definitions -- Terminology
    terminology = {...};</pre>
</div>
</div>
<div class="paragraph">
<p>Many of the sections are optional and are only used in specific <em>forms</em> of DLM, indicated by the <code>&lt;form&gt;</code> on the first line.</p>
</div>
<div class="paragraph">
<p>The <code>definitions&#8201;&#8212;&#8201;Descriptive</code> and <code>definitions&#8201;&#8212;&#8201;Terminology</code> sections (which are logically identical data structures to the same-named sections in openEHR archetypes, but in a JSON5 superset form) can be omitted for DLMs in development for which no descriptive meta-data or terminology is needed.</p>
</div>
<div class="sect2">
<h3 id="_identifiers"><a class="anchor" href="#_identifiers"></a>3.1. Identifiers</h3>
<div class="paragraph">
<p>All identifiers in a DLM are strings with no whitespace. If the <code>terminology</code> section is present, these identifiers are included with linguistic definitions and translations, in the same way as archetypes. This approach enables the symbolic variables such as <code>is_type1_diabetic</code> to be used in rules, and to have a full, formal, multi-lingual definition, such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="ts"><span></span><span class="tok-nx">definitions</span> <span class="tok-o">--</span> <span class="tok-nx">Terminology</span>

    <span class="tok-nx">terminology</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
        <span class="tok-nx">term_definitions</span><span class="tok-o">:</span> <span class="tok-p">{</span>
            <span class="tok-s2">&quot;en&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
                <span class="tok-s2">&quot;resting_heart_rate&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
                    <span class="tok-nx">text</span><span class="tok-o">:</span> <span class="tok-s2">&quot;heart rate at rest&quot;</span><span class="tok-p">,</span>
                    <span class="tok-nx">description</span><span class="tok-o">:</span> <span class="tok-s2">&quot;...&quot;</span>
                <span class="tok-p">}</span>
                <span class="tok-p">...</span>
                <span class="tok-s2">&quot;SpO2&quot;</span><span class="tok-o">:</span> <span class="tok-p">{</span>
                    <span class="tok-nx">text</span><span class="tok-o">:</span> <span class="tok-s2">&quot;Oxygen saturation&quot;</span><span class="tok-p">;</span>
                    <span class="tok-nx">description</span><span class="tok-o">:</span> <span class="tok-s2">&quot;...&quot;</span>
                <span class="tok-p">}</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_identification_section"><a class="anchor" href="#_identification_section"></a>3.2. Identification Section</h3>
<div class="paragraph">
<p>The identification section takes the form <code>dlm &lt;form&gt; &lt;identifier&gt;</code>, where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;form&gt;</code>: flavour of DLM artefact, with value <code>ruleset | guideline</code>;</p>
</li>
<li>
<p><code>&lt;identifier&gt;</code>: identifier, in the format <code>&lt;concept&gt;.vN.N.N</code> where <code>vN.N.N</code> represents a numeric version of the logical form <code>major.minor.patch</code>, and whose values over time obey the <a href="http://semver.org" target="_blank" rel="noopener">Semver.org rules</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following shows the identification line for a guideline:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>dlm guideline chadvasc2.v1.0.5</pre>
</div>
</div>
<div class="paragraph">
<p>A reference to a DLM may be effected by quoting the whole identifier, or a form with the minor and / or patch parts of the version missing. Either of these forms identify the most recent matching DLm available. For example, the reference <code>NHS-chops14.v4</code> identifies whatever the most recent minor version of the <code>v4</code> major version of the NHS-chops DLM is locally available.</p>
</div>
</div>
<div class="sect2">
<h3 id="_language_and_description_sections"><a class="anchor" href="#_language_and_description_sections"></a>3.3. Language and Description Sections</h3>
<div class="paragraph">
<p>The <code>language</code> and <code>description</code> sections are the same as for openEHR archetypes, and are formally defined by the <a href="https://specifications.openehr.org/releases/BASE/latest/resource.html" target="_blank" rel="noopener">openEHR Resource specification</a>. The following provides an example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="ts"><span></span><span class="tok-nx">definitions</span> <span class="tok-o">--</span> <span class="tok-nx">Descriptive</span>

    <span class="tok-nx">language</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
            <span class="tok-nx">original_language</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-nx">ISO_639</span><span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-o">::</span><span class="tok-nx">en</span><span class="tok-p">]</span>
        <span class="tok-p">}</span>
        <span class="tok-p">;</span>

    <span class="tok-nx">description</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
            <span class="tok-nx">lifecycle_state</span><span class="tok-o">:</span> <span class="tok-s2">&quot;unmanaged&quot;</span><span class="tok-p">,</span>
            <span class="tok-nx">original_author</span><span class="tok-o">:</span> <span class="tok-p">{</span>
                <span class="tok-nx">name</span><span class="tok-o">:</span>           <span class="tok-s2">&quot;Thomas Beale&quot;</span><span class="tok-p">,</span>
                <span class="tok-nx">email</span><span class="tok-o">:</span>          <span class="tok-s2">&quot;thomas.beale@openEHR.org&quot;</span><span class="tok-p">,</span>
                <span class="tok-nx">organisation</span><span class="tok-o">:</span>   <span class="tok-s2">&quot;openEHR Foundation &lt;http://www.openEHR.org&gt;&quot;</span><span class="tok-p">,</span>
                <span class="tok-nx">date</span><span class="tok-o">:</span>           <span class="tok-s2">&quot;2021-01-10&quot;</span>
            <span class="tok-p">},</span>
            <span class="tok-nx">details</span><span class="tok-o">:</span> <span class="tok-p">{</span>
                <span class="tok-s2">&quot;en&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
                    <span class="tok-nx">language</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-nx">ISO_639</span><span class="tok-o">-</span><span class="tok-mi">1</span><span class="tok-o">::</span><span class="tok-nx">en</span><span class="tok-p">],</span>
                    <span class="tok-nx">purpose</span><span class="tok-o">:</span> <span class="tok-s2">&quot;To record an individual&#39;s QRISK3 score.&quot;</span>
                <span class="tok-p">}</span>
            <span class="tok-p">},</span>
            <span class="tok-nx">copyright</span><span class="tok-o">:</span>  <span class="tok-s2">&quot;© 2021 openEHR Foundation&quot;</span><span class="tok-p">,</span>
            <span class="tok-nx">licence</span><span class="tok-o">:</span>    <span class="tok-s2">&quot;Creative Commons CC-BY &lt;https://creativecommons.org/licenses/by/3.0/&gt;&quot;</span><span class="tok-p">,</span>
            <span class="tok-nx">ip_acknowledgements</span><span class="tok-o">:</span> <span class="tok-p">{</span>
                <span class="tok-s2">&quot;ClinRisk&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;This content developed from original publication of</span>
<span class="tok-s2">                    © 2017 ClinRisk Ltd., see https://qrisk.org&quot;</span><span class="tok-p">,</span>
                <span class="tok-s2">&quot;QRISK&quot;</span> <span class="tok-o">:</span> <span class="tok-s2">&quot;QRISK® is a registered trademark of the University of Nottingham and EMIS&quot;</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>
        <span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_use_model_section"><a class="anchor" href="#_use_model_section"></a>3.4. Use_model Section</h3>
<div class="paragraph">
<p>The optional <code>use_model</code> section enables a DLM to specify a model that defines the type system for the DLM. The identifier of the model must be resolvable to a BMM model, i.e. a model for which an <a href="https://specifications.openehr.org/releases/LANG/latest/bmm.html" target="_blank" rel="noopener">openEHR Basic Meta-Model</a> file is available. This might be a well-known model such as the <a href="https://specifications.openehr.org/releases/RM/latest/index" target="_blank" rel="noopener">openEHR Reference Model</a> (<a href="https://specifications.openehr.org/releases/ITS-BMM/latest" target="_blank" rel="noopener">BMM form</a>), or a custom model created for local use. The model identifier must include a version matching part, with at least the major version present. The following example specifies the use of the openEHR RM in the latest <code>1.1</code> version available.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>use_model
    openEHR-RM.v1.1</pre>
</div>
</div>
<div class="paragraph">
<p>The types defined in all 'used' models become available to the DLM for use in declarations. If no model is specified, the <a href="https://specifications.openehr.org/releases/BASE/latest" target="_blank" rel="noopener">openEHR Base and Foundation types</a> are assumed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_use_section"><a class="anchor" href="#_use_section"></a>3.5. Use Section</h3>
<div class="paragraph">
<p>A DLM can use other DLMs, by declaring each DLM with an identifier in the <code>use</code> section. The identifier must include a version-matching part. The following example declares the identifier <code>BSA</code> as a convenient local label to refer to the latest version of the DLM <code>Body_surface_area.v1</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>use
    BSA: Body_surface_area.v1</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_preconditions_section"><a class="anchor" href="#_preconditions_section"></a>3.6. Preconditions Section</h3>
<div class="paragraph">
<p>The <code>preconditions</code> section is used to state logical conditions that must evaluate to true for the DLM to be used for the subject. Any Boolean-typed identifier may be used from the <code>input</code>, <code>condition</code> or <code>rules</code> sections, or any Boolean-returning logical expression referencing any identifiers declared in the DLM. A typical <code>preconditions</code> section is shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>preconditions
    is_pregnant</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reference_section"><a class="anchor" href="#_reference_section"></a>3.7. Reference Section</h3>
<div class="paragraph">
<p>The <code>reference</code> section of a DLM contains what might be thought of constant definitions, i.e. identifiers declared with fixed values. The following illustrates.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="ts"><span></span><span class="tok-nx">definitions</span> <span class="tok-o">--</span> <span class="tok-nx">Reference</span>

    <span class="tok-nx">paracetamol_dose</span>: <span class="tok-kt">Quantity</span> <span class="tok-o">=</span> <span class="tok-mi">1</span><span class="tok-nx">g</span><span class="tok-p">;</span>
    <span class="tok-nx">chlorphenamine_dose</span>: <span class="tok-kt">Quantity</span> <span class="tok-o">=</span> <span class="tok-mi">10</span><span class="tok-nx">mg</span><span class="tok-p">;</span>
    <span class="tok-nx">prednisolone_dose_per_m2</span>: <span class="tok-kt">Quantity</span> <span class="tok-o">=</span> <span class="tok-mi">40</span><span class="tok-nx">mg</span><span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>These may be data structures of significant complexity, such as the following risk tables.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="ts"><span></span><span class="tok-nx">definitions</span> <span class="tok-o">--</span> <span class="tok-nx">Reference</span>

    <span class="tok-nx">Snoking_interaction_scales</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
            <span class="tok-p">[</span><span class="tok-nx">female</span><span class="tok-p">]</span><span class="tok-o">:</span> <span class="tok-p">{</span>
                 <span class="tok-p">[</span><span class="tok-nx">age_1</span><span class="tok-p">]</span><span class="tok-o">:</span>   <span class="tok-p">{</span>
                    <span class="tok-p">[</span><span class="tok-nx">non_smoker</span><span class="tok-p">]</span><span class="tok-o">:</span>                   <span class="tok-mi">0</span><span class="tok-p">,</span>
                    <span class="tok-p">[</span><span class="tok-nx">ex_smoker</span><span class="tok-p">]</span><span class="tok-o">:</span>                   <span class="tok-o">-</span><span class="tok-mf">4.70571617858518910</span><span class="tok-p">,</span>
                    <span class="tok-p">[</span><span class="tok-nx">light_smoker</span><span class="tok-p">]</span><span class="tok-o">:</span>                <span class="tok-o">-</span><span class="tok-mf">2.74303834035733370</span><span class="tok-p">,</span>
                    <span class="tok-p">[</span><span class="tok-nx">moderate_smoker</span><span class="tok-p">]</span><span class="tok-o">:</span>             <span class="tok-o">-</span><span class="tok-mf">0.866080888293921820</span><span class="tok-p">,</span>
                    <span class="tok-p">[</span><span class="tok-nx">heavy_smoker</span><span class="tok-p">]</span><span class="tok-o">:</span>                 <span class="tok-mf">0.902415623697106480</span>
                <span class="tok-p">},</span>
                <span class="tok-p">[</span><span class="tok-nx">age_2</span><span class="tok-p">]</span><span class="tok-o">:</span>   <span class="tok-p">{</span>
                    <span class="tok-p">[</span><span class="tok-nx">non_smoker</span><span class="tok-p">]</span><span class="tok-o">:</span>                   <span class="tok-mi">0</span><span class="tok-p">,</span>
                    <span class="tok-p">[</span><span class="tok-nx">etc</span><span class="tok-p">]</span><span class="tok-o">:</span>                         <span class="tok-o">-</span><span class="tok-mf">0.0755892446431930260000000</span>
                <span class="tok-p">}</span>
            <span class="tok-p">},</span>
            <span class="tok-p">[</span><span class="tok-nx">male</span><span class="tok-p">]</span><span class="tok-o">:</span> <span class="tok-p">{</span>
                 <span class="tok-p">[</span><span class="tok-nx">age_1</span><span class="tok-p">]</span><span class="tok-o">:</span>   <span class="tok-p">{</span>
                    <span class="tok-p">[</span><span class="tok-nx">non_smoker</span><span class="tok-p">]</span><span class="tok-o">:</span>                   <span class="tok-mi">0</span><span class="tok-p">,</span>
                    <span class="tok-p">[</span><span class="tok-nx">etc</span><span class="tok-p">]</span><span class="tok-o">:</span>                         <span class="tok-o">-</span><span class="tok-mf">0.2101113393351634600000000</span>
                <span class="tok-p">},</span>
                <span class="tok-p">[</span><span class="tok-nx">age_2</span><span class="tok-p">]</span><span class="tok-o">:</span>   <span class="tok-p">{</span>
                    <span class="tok-p">[</span><span class="tok-nx">non_smoker</span><span class="tok-p">]</span><span class="tok-o">:</span>                   <span class="tok-mi">0</span><span class="tok-p">,</span>
                    <span class="tok-p">[</span><span class="tok-nx">etc</span><span class="tok-p">]</span><span class="tok-o">:</span>                         <span class="tok-o">-</span><span class="tok-mf">0.0004985487027532612100000</span>
                <span class="tok-p">}</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>
        <span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_input_section"><a class="anchor" href="#_input_section"></a>3.8. Input Section</h3>
<div class="sect3">
<h4 id="_subject_variables"><a class="anchor" href="#_subject_variables"></a>3.8.1. Subject Variables</h4>
<div class="paragraph">
<p>The <code>input</code> section contains declarations of all <em>subject variables</em> used by a DLM. At a minimum, a subject variable declaration states the symbolic name and type of the variable in the manner typical of a typed programming language, as exemplified by the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="kotlin"><span></span><span class="tok-n">input</span>
    <span class="tok-n">heart_rate</span><span class="tok-p">:</span> <span class="tok-n">Quantity</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Although a subject variable declaration appears to declare a simple property of a type such as a <code>Quantity</code>, in fact it creates an instance of a proxy object described below in <a href="#_dlm_model">Section 4</a>, that provides access to snapshot values of the variable over time, as well as other smart facilities including null-value detection and range conversion, described in the sections below.</p>
</div>
<div class="sect4">
<h5 id="_variable_naming"><a class="anchor" href="#_variable_naming"></a>3.8.1.1. Variable Naming</h5>
<div class="paragraph">
<p>The naming of a subject variable is important, and should reflect its intended domain meaning <em>with respect to the guideline or plan</em> which it formalises. Thus, a cardiology guideline might use a variable <code>systolic_bp</code> to mean 'current instantaneous systolic blood pressure' and a variable <code>target_systolic_bp</code> to mean a target pressure for the patient to aim for over the course of hypertension treatment. However a guideline that refers to different systolic blood pressures, e.g. historical, average and current might use variables such as <code>actual_systolic_bp</code>, <code>24h_average_systolic_bp</code> etc.</p>
</div>
<div class="paragraph">
<p>The naming is important in another way. Generally a subject variable should reflect a fact or assertion about the subject in reality rather than a purely epistemic view relating to an information system. For example a variable <code>is_type1_diabetic</code> is intended to reflect the patient&#8217;s real diabetic status, not just the knowledge of the local hospital EMR system of whether the patient is diabetic. Such variables may be termed 'ontic' i.e. reflecting the real world, rather than reflecting states of knowledge of some information source. The reason for using ontic variables is to allow DLM authors to define rules in terms of true clinical reality based on reliable previously established facts, rather than continually having to compensate for missing or unreliable knowledge within a guideline.</p>
</div>
<div class="paragraph">
<p>Epistemic variables may of course be defined, e.g. the variable <code>has_diabetes_diagnosis</code> directly reflects the idea that the presence of a diagnosis of a condition is distinct from the true fact of having the condition. These are typically used when the purpose of the guideline is to establish the presence or otherwise of the condition named in such variables.</p>
</div>
</div>
<div class="sect4">
<h5 id="_unavailable_values"><a class="anchor" href="#_unavailable_values"></a>3.8.1.2. Unavailable Values</h5>
<div class="paragraph">
<p>One of the facilities created by a declaration of the form <code>identifier: Type</code> are subordinate predicate functions to detect if a value is available for the variable, i.e. if it is not logically null. Lack of a value is caused either by the true absence of the data in back-end systems (e.g. blood pressure has not recently been measured) or a technical failure to query or otherwise interrogate the relevant system.</p>
</div>
<div class="paragraph">
<p>It should be noted that within the overall conceptual model of process-based computing in openEHR, the common problem of a failure to locate a data item in back-end systems causing a live user to be asked to supply it is assumed to be addressed outside the DLM itself. This means that the simple lack of a value in back-end systems does not need to be compensated for by logic (such as null checks) in a DLM itself - it will already have been done in the Subject Proxy service. Consequently, if a variable value is unavailable within a DLM computation, this already takes into account attempts to obtain a value from a user.</p>
</div>
<div class="paragraph">
<p>The general case is that any subject variable might not have a value available for it, or at least a sufficiently <em>current</em> value (see next section for the concept of currency) at the moment of a particular rule invocation (remembering that the same rule might be invoked repeatedly over time). This means that the simple (primary variable) reference <code>systolic_blood_pressure</code> may in fact return a null value. If rules containing primary variable references such as <code>systolic_blood_pressure</code> are written under a non-null assumption, a null value will cause an exception of type <code>no available value</code>, and the original rule invocation will fail.</p>
</div>
<div class="paragraph">
<p>In most cases this is likely to be the preferred style of rule expression, since it makes rules simpler and clearer. However, in some cases, it may be known a priori that certain variables are only sometimes likely to be available, and if so, they are used, but if not, no exception is generated. This may be achieved by calling the subordinate predicate <code>is_available</code> as a guard on the direct access, as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="kotlin"><span></span><span class="tok-n">rules</span>

    <span class="tok-n">is_hypertensive</span><span class="tok-p">:</span>
        <span class="tok-n">Result</span> <span class="tok-p">:=</span> <span class="tok-n">systolic_blood_pressure</span><span class="tok-p">.</span><span class="tok-n">is_available</span> <span class="tok-n">and</span> <span class="tok-n">then</span> <span class="tok-n">systolic_blood_pressure</span><span class="tok-p">.</span><span class="tok-n">in_range</span><span class="tok-p">([</span><span class="tok-n">high</span><span class="tok-p">])</span> <span class="tok-n">or</span>  <span class="tok-p">...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, the semi-strict Boolean operator <code>and then</code> ensures the second reference to <code>systolic_blood_pressure</code> will only be evaluated if <code>systolic_blood_pressure.is_available</code> returns True.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_tracked_variables"><a class="anchor" href="#_tracked_variables"></a>3.8.2. Tracked Variables</h4>
<div class="paragraph">
<p>An important category of subject variable is the <em>tracked variable</em>, which enables the current value of a variable, with some lag, to be obtained automatically from the back-end system. The acceptable lag is indicated by the subordinate <em>currency</em> attribute, as a temporal duration. This specifies how recent the value obtained from the external world (the 'sample') must be to be valid from the point of view of the DLM. Currency may be understood as the converse of 'staleness', that is, a variable sample that must be say 1 hour or less old is understood as stale after 1 hour.</p>
</div>
<div class="paragraph">
<p>The use of the currency modifier establishes that a subject variable is a time-related sample of some kind (instantaneous, average, minimum, etc) of a real-world time-varying continuant quality (e.g. blood pressure) of an independent continuant entity (usually a person).</p>
</div>
<div class="paragraph">
<p>Since the various physiological and disease process that occur in a human body have significantly differing temporal rhythms, currency will vary widely for different subject variables, as per the following examples.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="ts"><span></span><span class="tok-nx">input</span> <span class="tok-o">--</span> <span class="tok-nx">Administrative</span> <span class="tok-nx">State</span>

    <span class="tok-o">|</span>
    <span class="tok-o">|</span> <span class="tok-nx">untracked</span> <span class="tok-nx">variable</span><span class="tok-o">:</span>
    <span class="tok-o">|</span> <span class="tok-nx">DOB</span> <span class="tok-nx">never</span> <span class="tok-nx">changes</span><span class="tok-p">,</span> <span class="tok-nx">no</span> <span class="tok-nx">currency</span> <span class="tok-nx">needed</span>
    <span class="tok-o">|</span>
    <span class="tok-nx">date_of_birth</span>: <span class="tok-kt">Date</span>
        <span class="tok-p">;</span>

<span class="tok-nx">input</span> <span class="tok-o">--</span> <span class="tok-nx">Historical</span> <span class="tok-nx">State</span>

    <span class="tok-o">|</span>
    <span class="tok-o">|</span> <span class="tok-nx">tracked</span> <span class="tok-nx">variable</span><span class="tok-o">:</span>
    <span class="tok-o">|</span> <span class="tok-nx">weight</span> <span class="tok-nx">changes</span> <span class="tok-nx">over</span> <span class="tok-nx">a</span> <span class="tok-nx">period</span> <span class="tok-nx">of</span> <span class="tok-nx">days</span>
    <span class="tok-o">|</span>
    <span class="tok-nx">weight</span>: <span class="tok-kt">Quantity</span>
        <span class="tok-nx">currency</span> <span class="tok-o">=</span> <span class="tok-mi">3</span> <span class="tok-nx">days</span>
        <span class="tok-p">;</span>

    <span class="tok-o">|</span>
    <span class="tok-o">|</span> <span class="tok-nx">untracked</span> <span class="tok-nx">variable</span><span class="tok-o">:</span>
    <span class="tok-o">|</span> <span class="tok-nx">assuming</span> <span class="tok-nx">an</span> <span class="tok-nx">adult</span> <span class="tok-nx">subject</span><span class="tok-p">,</span> <span class="tok-nx">height</span> <span class="tok-nx">constant</span>
    <span class="tok-o">|</span>
    <span class="tok-nx">height</span>: <span class="tok-kt">Quantity</span>
        <span class="tok-p">;</span>

<span class="tok-nx">input</span> <span class="tok-o">--</span> <span class="tok-nx">Tracked</span> <span class="tok-nx">State</span>

    <span class="tok-o">|</span>
    <span class="tok-o">|</span> <span class="tok-nx">tracked</span> <span class="tok-nx">variable</span><span class="tok-o">:</span>
    <span class="tok-o">|</span> <span class="tok-nx">blood</span> <span class="tok-nx">glucose</span> <span class="tok-nx">changes</span> <span class="tok-nx">within</span> <span class="tok-nx">minutes</span> <span class="tok-k">in</span> <span class="tok-nx">response</span> <span class="tok-nx">to</span> <span class="tok-nx">food</span>
    <span class="tok-o">|</span>
    <span class="tok-nx">blood_glucose</span>: <span class="tok-kt">Quantity</span>
        <span class="tok-nx">currency</span> <span class="tok-o">=</span> <span class="tok-mi">15</span> <span class="tok-nx">min</span>
        <span class="tok-p">;</span>

    <span class="tok-o">|</span>
    <span class="tok-o">|</span> <span class="tok-nx">tracked</span> <span class="tok-nx">variable</span><span class="tok-o">:</span>
    <span class="tok-o">|</span> <span class="tok-nx">Heart</span><span class="tok-o">-</span><span class="tok-nx">rate</span> <span class="tok-nx">may</span> <span class="tok-nx">change</span> <span class="tok-nx">quickly</span>
    <span class="tok-o">|</span>
    <span class="tok-nx">heart_rate</span>: <span class="tok-kt">Quantity</span>
        <span class="tok-nx">currency</span> <span class="tok-o">=</span> <span class="tok-mi">5</span> <span class="tok-nx">sec</span>
        <span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Variables for which no currency is stated may be understood as having the currency equal to the age of the subject.</p>
</div>
</div>
<div class="sect3">
<h4 id="_quantitative_tracked_variables"><a class="anchor" href="#_quantitative_tracked_variables"></a>3.8.3. Quantitative Tracked Variables</h4>
<div class="paragraph">
<p>Many tracked variables are quantitative, and a ubiquitous need within clinical guidelines and rules is to be able to refer to a continuous variable such as vital signs and most lab test values as being in a designated range. Such ranges may be the usual ones published e.g. the normal and high ranges for lipids in a cholesterol test for adults, or ranges defined by the DLM.</p>
</div>
<div class="paragraph tbd">
<p>TBD: could ranges be declared elsewhere and re-used, e.g. standard BMI ranges, BP ranges etc?</p>
</div>
<div class="paragraph">
<p>The ranges for a subject variable are declared in the following way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="kotlin"><span></span><span class="tok-n">input</span> <span class="tok-p">--</span> <span class="tok-n">Tracked</span> <span class="tok-n">State</span>

    <span class="tok-p">|</span>
    <span class="tok-p">|</span> <span class="tok-n">Systolic</span> <span class="tok-n">BP</span> <span class="tok-p">(</span><span class="tok-n">mmHg</span><span class="tok-p">)</span>
    <span class="tok-p">|</span>
    <span class="tok-n">systolic_blood_pressure</span><span class="tok-p">:</span> <span class="tok-n">Real</span>
        <span class="tok-n">currency</span> <span class="tok-p">=</span> <span class="tok-m">1</span> <span class="tok-n">min</span>
        <span class="tok-n">ranges</span><span class="tok-p">[</span><span class="tok-s">&quot;mmHg&quot;</span><span class="tok-p">]</span> <span class="tok-p">=</span>
            <span class="tok-p">------------------------------------</span>
            <span class="tok-p">|</span><span class="tok-err">≥</span> <span class="tok-m">180</span><span class="tok-p">|:</span>            <span class="tok-p">[</span><span class="tok-n">critical_high</span><span class="tok-p">],</span>
            <span class="tok-p">|&gt;</span> <span class="tok-m">140</span><span class="tok-p">|:</span>            <span class="tok-p">[</span><span class="tok-n">very_high</span><span class="tok-p">],</span>
            <span class="tok-p">|&gt;</span> <span class="tok-m">120</span><span class="tok-p">|:</span>            <span class="tok-p">[</span><span class="tok-n">high</span><span class="tok-p">],</span>
            <span class="tok-p">|&gt;</span> <span class="tok-m">90</span> <span class="tok-p">..</span> <span class="tok-err">≤</span> <span class="tok-m">120</span><span class="tok-p">|:</span>    <span class="tok-p">[</span><span class="tok-n">normal</span><span class="tok-p">],</span>
            <span class="tok-p">|</span><span class="tok-err">≤</span> <span class="tok-m">90</span><span class="tok-p">|:</span>             <span class="tok-p">[</span><span class="tok-n">low</span><span class="tok-p">],</span>
            <span class="tok-p">|</span><span class="tok-err">≤</span> <span class="tok-m">50</span><span class="tok-p">|:</span>             <span class="tok-p">[</span><span class="tok-n">critical_low</span><span class="tok-p">]</span>
            <span class="tok-p">------------------------------------</span>
        <span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above declaration allows the use of the predefined <code>range</code> function, which returns the most precise range in which the value falls, in rule expressions such as the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="kotlin"><span></span>    <span class="tok-n">Result</span> <span class="tok-p">:=</span>
        <span class="tok-n">case</span> <span class="tok-n">systolic_blood_pressure</span><span class="tok-p">.</span><span class="tok-n">range</span> <span class="tok-k">in</span>
            <span class="tok-p">=====================================</span>
<span class="tok-na">            [critical_high]</span><span class="tok-p">:</span>         <span class="tok-p">[</span><span class="tok-n">emergency</span><span class="tok-p">],</span>
            <span class="tok-p">-------------------------------------</span>
<span class="tok-na">            [high]</span><span class="tok-p">,</span> <span class="tok-p">[</span><span class="tok-n">very_high</span><span class="tok-p">]:</span>     <span class="tok-p">[</span><span class="tok-n">high_risk</span><span class="tok-p">],</span>
            <span class="tok-p">-------------------------------------</span>
            <span class="tok-p">*:</span>                       <span class="tok-p">[</span><span class="tok-n">monitor</span><span class="tok-p">]</span>
            <span class="tok-p">=====================================</span>
        <span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that ranges may be defined in two ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>to be overlapping, such that <code>[high]</code> refers to any value higher than 120, while <code>[very_high]</code> refers to any value over 140;</p>
</li>
<li>
<p>non-overlapping, such that each sub-range stops at the start of the next one.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the latter case, determining that a patient has high blood pressure requires an expression of the form <code>systolic_blood_pressure.in_range ({[high], [very_high], [critical_high]})</code>, using a set argument.</p>
</div>
<div class="paragraph">
<p>Sometimes there are multiple ranges, usually due to alternative units systems. This is handled by the use of a <em>discriminator</em> on a number of <em>range groups</em>. The following shows an example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="kotlin"><span></span><span class="tok-n">input</span> <span class="tok-p">--</span> <span class="tok-n">Tracked</span> <span class="tok-n">State</span>

    <span class="tok-n">PaO2_FiO2_ratio</span><span class="tok-p">:</span> <span class="tok-n">Quantity</span>
        <span class="tok-n">currency</span> <span class="tok-p">=</span> <span class="tok-m">1</span> <span class="tok-n">min</span><span class="tok-p">,</span>
        <span class="tok-n">ranges</span><span class="tok-p">[</span><span class="tok-s">&quot;mm[Hg]&quot;</span><span class="tok-p">]</span> <span class="tok-p">=</span>
            <span class="tok-p">---------------------------------</span>
            <span class="tok-p">|</span><span class="tok-err">≥</span><span class="tok-m">400</span> <span class="tok-p">|:</span>        <span class="tok-p">[</span><span class="tok-n">normal</span><span class="tok-p">],</span>
            <span class="tok-p">|</span><span class="tok-m">300</span> <span class="tok-p">..</span> <span class="tok-m">399</span><span class="tok-p">|:</span>   <span class="tok-p">[</span><span class="tok-n">low</span><span class="tok-p">],</span>
            <span class="tok-p">|</span><span class="tok-m">200</span> <span class="tok-p">..</span> <span class="tok-m">299</span><span class="tok-p">|:</span>   <span class="tok-p">[</span><span class="tok-n">very_low</span><span class="tok-p">],</span>
            <span class="tok-p">|</span><span class="tok-m">100</span> <span class="tok-p">..</span> <span class="tok-m">199</span><span class="tok-p">|:</span>   <span class="tok-p">[</span><span class="tok-n">extremely_low</span><span class="tok-p">],</span>
            <span class="tok-p">|&lt;</span><span class="tok-m">100</span><span class="tok-p">|:</span>         <span class="tok-p">[</span><span class="tok-n">critical_low</span><span class="tok-p">]</span>
            <span class="tok-p">---------------------------------</span>
        <span class="tok-p">;,</span>
        <span class="tok-n">ranges</span><span class="tok-p">[</span><span class="tok-s">&quot;kPa&quot;</span><span class="tok-p">]</span> <span class="tok-p">=</span>
            <span class="tok-p">---------------------------------</span>
            <span class="tok-p">|</span><span class="tok-err">≥</span><span class="tok-m">53</span><span class="tok-p">|:</span>          <span class="tok-p">[</span><span class="tok-n">normal</span><span class="tok-p">],</span>
            <span class="tok-p">|</span><span class="tok-m">39.9</span> <span class="tok-p">..</span> <span class="tok-m">53</span><span class="tok-p">|:</span>   <span class="tok-p">[</span><span class="tok-n">low</span><span class="tok-p">],</span>
            <span class="tok-p">|</span><span class="tok-m">26.6</span> <span class="tok-p">..</span> <span class="tok-m">39.8</span><span class="tok-p">|:</span> <span class="tok-p">[</span><span class="tok-n">very_low</span><span class="tok-p">],</span>
            <span class="tok-p">|</span><span class="tok-m">13.3</span> <span class="tok-p">..</span> <span class="tok-m">26.5</span><span class="tok-p">|:</span> <span class="tok-p">[</span><span class="tok-n">extremely_low</span><span class="tok-p">],</span>
            <span class="tok-p">|&lt;</span><span class="tok-m">13.3</span><span class="tok-p">|:</span>        <span class="tok-p">[</span><span class="tok-n">critical_low</span><span class="tok-p">]</span>
            <span class="tok-p">---------------------------------</span>
        <span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To access a range within this structure, an expression of the form <code>systolic_blood_pressure.in_range (["kPa"], [high])</code> is needed. This makes use of an overload of the <code>in_range()</code> function taking two keys. We can now see that the simpler form <code>systolic_blood_pressure.in_range ([critical_high])</code> first chooses the first range group, and then extracts the required entry.</p>
</div>
<div class="paragraph">
<p>The above case reveals the general structure of the <code>ranges</code> property, with a formal type equivalent to <code>Map &lt;Terminology_code, Map &lt;Interval &lt;T&gt;, Terminology_code&gt;</code>, where <code>T</code> is the declared type of the subject variable. In both the simple and discriminator cases, the entry <code>|&gt;  140|: [very_high]</code> defines a <code>[key, value]</code> pair whose key is of type <code>Interval &lt;Real&gt;</code> and whose value is of type <code>Terminology_code</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rules_section"><a class="anchor" href="#_rules_section"></a>3.9. Rules Section</h3>
<div class="paragraph">
<p>The DLM <code>rules</code> section is the section of primary importance, since it contains the rules for which a DLM is created. DLM rules are formally expressed as functions in the <a href="https://specifications.openehr.org/releases/LANG/latest/expression_language.html" target="_blank" rel="noopener">openEHR Expression Language</a>, based on the <a href="https://specifications.openehr.org/releases/LANG/latest/bmm.html" target="_blank" rel="noopener">openEHR BMM</a>.</p>
</div>
<div class="paragraph">
<p>This section may be typically divided into two or more groups for authoring convenience. The first group may be used for simple Boolean-returning 0-order functions that represent 'named conditions', for use in the primary rules. The <code>Boolean</code> type may be omitted, since all conditions have this as their formal type. The following is an example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="kotlin"><span></span><span class="tok-n">rules</span> <span class="tok-p">--</span> <span class="tok-n">Conditions</span>

    <span class="tok-n">her2_positive</span><span class="tok-p">:</span>
        <span class="tok-n">Result</span> <span class="tok-p">:=</span> <span class="tok-n">her2_expression</span> <span class="tok-p">=</span> <span class="tok-p">[</span><span class="tok-n">positive</span><span class="tok-p">]</span>
        <span class="tok-p">;</span>

    <span class="tok-n">non_class_I_heart_failure</span><span class="tok-p">:</span>
        <span class="tok-n">Result</span> <span class="tok-p">:=</span> <span class="tok-n">has_heart_failure_class_II</span> <span class="tok-n">or</span>
                    <span class="tok-n">has_heart_failure_class_III</span> <span class="tok-n">or</span>
                    <span class="tok-n">has_heart_failure_class_IV</span>
        <span class="tok-p">;</span>

    <span class="tok-n">anthracyclines_contraindicated</span><span class="tok-p">:</span>
        <span class="tok-n">Result</span> <span class="tok-p">:=</span> <span class="tok-n">has_transmural_MI</span> <span class="tok-n">or</span>
            <span class="tok-n">ejection_fraction</span><span class="tok-p">.</span><span class="tok-n">in_range</span> <span class="tok-p">([</span><span class="tok-n">low</span><span class="tok-p">])</span> <span class="tok-n">or</span>
            <span class="tok-n">non_class_I_heart_failure</span>
        <span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The primary rules may be included in a separate <code>rules</code> group, consisting of 0-order functions returning any type. EL structures of any complexity may be used. The following provides an example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="kotlin"><span></span><span class="tok-n">rules</span> <span class="tok-p">--</span> <span class="tok-n">Main</span>

    <span class="tok-n">hypertension_risk</span><span class="tok-p">:</span> <span class="tok-n">Terminology_term</span>
        <span class="tok-n">Result</span> <span class="tok-p">:=</span>
            <span class="tok-n">choice</span> <span class="tok-k">in</span>
                <span class="tok-p">=================================================</span>
                <span class="tok-n">has_pre_eclampsia</span> <span class="tok-n">or</span>
                <span class="tok-n">has_eclampsia</span><span class="tok-p">:</span>                      <span class="tok-p">[</span><span class="tok-n">emergency</span><span class="tok-p">],</span>
                <span class="tok-p">-------------------------------------------------</span>
                <span class="tok-n">previous_obstetric_hypertension</span> <span class="tok-n">or</span>
                <span class="tok-n">previous_pre_eclampsia</span> <span class="tok-n">or</span>
                <span class="tok-n">previous_eclampsia</span> <span class="tok-n">or</span>
                <span class="tok-n">has_pregnancy_hypertension</span><span class="tok-p">:</span>         <span class="tok-p">[</span><span class="tok-n">high_risk</span><span class="tok-p">],</span>
                <span class="tok-p">-------------------------------------------------</span>
                <span class="tok-p">*:</span>                                  <span class="tok-p">[</span><span class="tok-n">low_risk</span><span class="tok-p">]</span>
                <span class="tok-p">=================================================</span>
            <span class="tok-p">;</span>

    <span class="tok-n">gestational_diabetes_risk</span><span class="tok-p">:</span> <span class="tok-n">Boolean</span>
        <span class="tok-n">Result</span> <span class="tok-p">:=</span>
            <span class="tok-n">bmi</span><span class="tok-p">.</span><span class="tok-n">in_range</span> <span class="tok-p">([</span><span class="tok-n">high</span><span class="tok-p">])</span> <span class="tok-n">or</span>
            <span class="tok-n">previous_macrosomic_baby</span> <span class="tok-n">or</span>
            <span class="tok-n">previous_gestational_diabetes</span> <span class="tok-n">or</span>
            <span class="tok-n">family_history_of_diabetes</span> <span class="tok-n">or</span>
            <span class="tok-n">race_related_diabetes_risk</span>
        <span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_output_section"><a class="anchor" href="#_output_section"></a>3.10. Output Section</h3>
<div class="paragraph tbd">
<p>TBD:</p>
</div>
</div>
<div class="sect2">
<h3 id="_terminology_section"><a class="anchor" href="#_terminology_section"></a>3.11. Terminology Section</h3>
<div class="paragraph">
<p>The <code>definitions&#8201;&#8212;&#8201;Terminology</code> section of a DLM serves the same purpose as the terminology section in an openEHR archetype, which is to provide multi-lingual definitions of all codes used in the artefact. Unlike archetypes, the codes in a DLM may be freely named, since they act as names of all symbolic entities referenced elsewhere in the DLM, including rules (i.e. functions), subject variables and constants. A typical DLM terminology section is shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="ts"><span></span><span class="tok-nx">definitions</span> <span class="tok-o">--</span> <span class="tok-nx">Terminology</span>

    <span class="tok-nx">terminology</span> <span class="tok-o">=</span> <span class="tok-p">{</span>
        <span class="tok-nx">term_definitions</span><span class="tok-o">:</span> <span class="tok-p">{</span>
            <span class="tok-s2">&quot;en&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
                <span class="tok-s2">&quot;date_of_birth&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
                    <span class="tok-nx">text</span><span class="tok-o">:</span> <span class="tok-s2">&quot;Date of birth&quot;</span>
                <span class="tok-p">},</span>
                <span class="tok-s2">&quot;age_in_years&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
                    <span class="tok-nx">text</span><span class="tok-o">:</span> <span class="tok-s2">&quot;Age (years)&quot;</span>
                <span class="tok-p">},</span>
                <span class="tok-s2">&quot;qRisk_score&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
                    <span class="tok-nx">text</span><span class="tok-o">:</span> <span class="tok-s2">&quot;QRISK2 score&quot;</span>
                <span class="tok-p">},</span>
                <span class="tok-s2">&quot;diabetes_status&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
                    <span class="tok-nx">text</span><span class="tok-o">:</span> <span class="tok-s2">&quot;Diabetic status of subject&quot;</span>
                <span class="tok-p">},</span>
                <span class="tok-s2">&quot;no_diabetes&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
                    <span class="tok-nx">text</span><span class="tok-o">:</span> <span class="tok-s2">&quot;Non-diabetic&quot;</span>
                <span class="tok-p">},</span>
                <span class="tok-s2">&quot;type1_diabetes&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
                    <span class="tok-nx">text</span><span class="tok-o">:</span> <span class="tok-s2">&quot;Has type 1 diabetes&quot;</span>
                <span class="tok-p">},</span>
                <span class="tok-s2">&quot;type2_diabetes&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
                    <span class="tok-nx">text</span><span class="tok-o">:</span> <span class="tok-s2">&quot;Has type 2 diabetes&quot;</span>
                <span class="tok-p">}</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>

        <span class="tok-nx">value_sets</span><span class="tok-o">:</span> <span class="tok-p">{</span>
            <span class="tok-s2">&quot;diabetes_status&quot;</span> <span class="tok-o">:</span> <span class="tok-p">{</span>
                <span class="tok-nx">id</span><span class="tok-o">:</span> <span class="tok-s2">&quot;diabetes_status&quot;</span><span class="tok-p">,</span>
                <span class="tok-nx">members</span><span class="tok-o">:</span> <span class="tok-p">[</span><span class="tok-s2">&quot;no_diabetes&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;type1_diabetes&quot;</span><span class="tok-p">,</span> <span class="tok-s2">&quot;type2_diabetes&quot;</span><span class="tok-p">]</span>
            <span class="tok-p">}</span>
        <span class="tok-p">}</span>
    <span class="tok-p">}</span>
    <span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dlm_model"><a class="anchor" href="#_dlm_model"></a>4. DLM Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>4.1. Overview</h3>
<div class="paragraph">
<p>The structure of the <code>proc.decision_language</code> packages is shown below.</p>
</div>
<div id="dl_packages" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/PROC-decision_language-packages.svg" alt="PROC decision language packages" width="50%">
</div>
<div class="title">Figure 1. <code>proc.decision_language</code> Package strucure</div>
</div>
<div class="paragraph">
<p>The packages are described below.</p>
</div>
</div>
<div class="sect2">
<h3 id="_decision_logic_module_package"><a class="anchor" href="#_decision_logic_module_package"></a>4.2. Decision Logic Module Package</h3>
<div class="paragraph">
<p>The module structure of a Decision Logic Module is formally represented by a class model consisting of minimal extensions to the BMM class (i.e. <code>BMM_CLASS</code>) concept. A DLM is thus understood as a special kind of module expressible as a constrained form of class definition, such that only certain types of features are allowed. It also has additions for documentary meta-data and terminology provided by the <code>AUTHORED_RESOURCE</code> class <a href="https://specifications.openehr.org/releases/BASE/latest/resource.html#_resource_package" target="_blank" rel="noopener">from the openEHR BASE component</a>.</p>
</div>
<div class="paragraph">
<p>The meta-model is shown below, with the meta-class <code>DECISION_LOGIC_MODULE</code> being the root entity.</p>
</div>
<div id="dl_dlm" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/PROC-decision_language.dlm.svg" alt="PROC decision language.dlm">
</div>
<div class="title">Figure 2. <code>proc.decision_language.dlm</code> Package</div>
</div>
<div class="paragraph">
<p>Within this model, the various DLM sections are modelled as specialisations of the BMM meta-class <code>BMM_FEATURE_GROUP</code>, so as to restrict the kind of features they may define. These are described in the following sub-sections.</p>
</div>
<div class="sect3">
<h4 id="_pre_conditions_section"><a class="anchor" href="#_pre_conditions_section"></a>4.2.1. Pre-conditions Section</h4>
<div class="paragraph">
<p>The DLM <code>preconditions</code> section is formally represented as a feature group called <code>'preconditions'</code> whose members are limited to being a single <code>BMM_FUNCTION</code> containing the Boolean expression that appears in that section. The expression may reference only rules and input variables.</p>
</div>
</div>
<div class="sect3">
<h4 id="_reference_section_2"><a class="anchor" href="#_reference_section_2"></a>4.2.2. Reference Section</h4>
<div class="paragraph">
<p>The DLM <code>reference</code> section is formally represented as a feature group called <code>'reference'</code> whose members are limited to BMM constants.</p>
</div>
</div>
<div class="sect3">
<h4 id="_input_section_2"><a class="anchor" href="#_input_section_2"></a>4.2.3. Input Section</h4>
<div class="paragraph">
<p>The DLM <code>input</code> section is formally represented as a feature group called <code>'input'</code> whose members are limited to BMM constants of a specific concrete type <code>TRACKED_VARIABLE&lt;T&gt;</code> and descendants, supplied by the <code>proc.decision_language.concrete</code> package.</p>
</div>
</div>
<div class="sect3">
<h4 id="_rules_section_2"><a class="anchor" href="#_rules_section_2"></a>4.2.4. Rules Section</h4>
<div class="paragraph">
<p>The DLM <code>rules</code> section is formally represented as a feature group called <code>'rules'</code> whose members are limited to BMM functions. A specific meta-type <code>DLM_RULE</code> is used in case extensions to the standard <code>BMM_FUNCTION</code> are required.</p>
</div>
</div>
<div class="sect3">
<h4 id="_class_descriptions"><a class="anchor" href="#_class_descriptions"></a>4.2.5. Class Descriptions</h4>
<div class="sect4">
<h5 id="_decision_logic_module_class"><a class="anchor" href="#_decision_logic_module_class"></a>4.2.5.1. DECISION_LOGIC_MODULE Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DECISION_LOGIC_MODULE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Specialised kind of class that represents a Decision Logic Module (DLM).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><a href="/releases/RM/latest/common.html#_authored_resource_class" target="_blank" rel="noopener">AUTHORED_RESOURCE</a></code>, <code><a href="/releases/LANG/latest/bmm.html#_bmm_simple_class_class" target="_blank" rel="noopener">BMM_SIMPLE_CLASS</a></code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>create_bmm_class</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Generate a <code>BMM_CLASS</code> structure whose feature groups correspond to the formal sections of a DLM, instantiated using the <code>DLM_XXX_SECTION</code> classes.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_dlm_reference_section_class"><a class="anchor" href="#_dlm_reference_section_class"></a>4.2.5.2. DLM_REFERENCE_SECTION Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DLM_REFERENCE_SECTION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Specialised feature group used in DLM to represent the <code>reference</code> section.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><a href="/releases/LANG/latest/bmm.html#_bmm_feature_group_class" target="_blank" rel="noopener">BMM_FEATURE_GROUP</a></code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>name</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_string_class" target="_blank" rel="noopener">String</a><br>
{default&#160;=&#160;"reference"}</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name of this feature group; defaults to 'reference'.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>features</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_list_class">List<sup></a>&lt;<a href="/releases/LANG/latest/bmm.html#_bmm_constant_class">BMM_CONSTANT</sup></a>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Constant definitions needed by module.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_dlm_input_section_class"><a class="anchor" href="#_dlm_input_section_class"></a>4.2.5.3. DLM_INPUT_SECTION Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DLM_INPUT_SECTION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Specialised feature group used in DLM to represent the <code>input</code> section. Contains only <code>SUBJECT_TRACKED_VARIABLE</code> members.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><a href="/releases/LANG/latest/bmm.html#_bmm_feature_group_class" target="_blank" rel="noopener">BMM_FEATURE_GROUP</a></code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>name</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_string_class" target="_blank" rel="noopener">String</a><br>
{default&#160;=&#160;"input"}</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name of this feature group; defaults to 'input'.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>features</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_list_class">List<sup></a>&lt;<a href="/releases/LANG/latest/bmm.html#_bmm_constant_class">BMM_CONSTANT</sup></a>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Input variable proxies.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_dlm_rules_section_class"><a class="anchor" href="#_dlm_rules_section_class"></a>4.2.5.4. DLM_RULES_SECTION Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DLM_RULES_SECTION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Specialised feature group used in DLM to represent the <code>rules</code> section. Contains only <code>DLM_RULE</code> members.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><a href="/releases/LANG/latest/bmm.html#_bmm_feature_group_class" target="_blank" rel="noopener">BMM_FEATURE_GROUP</a></code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>name</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_string_class" target="_blank" rel="noopener">String</a><br>
{default&#160;=&#160;"rules"}</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name of this feature group; defaults to 'rules'.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>features</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_list_class" target="_blank" rel="noopener">List</a>&lt;<a href="#_dlm_rule_class">DLM_RULE</a>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Rules for this module.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_dlm_rule_class"><a class="anchor" href="#_dlm_rule_class"></a>4.2.5.5. DLM_RULE Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DLM_RULE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Specialised form of <code>BMM_FUNCTION</code> that acts as a DLM rule.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><a href="/releases/LANG/latest/bmm.html#_bmm_function_class" target="_blank" rel="noopener">BMM_FUNCTION</a></code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dlm_concrete_model"><a class="anchor" href="#_dlm_concrete_model"></a>4.3. DLM Concrete Model</h3>
<div class="paragraph">
<p>In order to supply a few of the key constructs of a DLM, a concrete model is provided with specific types that express the needed semantics. The main types required relate to input variables. The DLM concrete model UML is shown below.</p>
</div>
<div id="dl_concrete" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/PROC-decision_language.concrete.svg" alt="PROC decision language.concrete">
</div>
<div class="title">Figure 3. <code>proc.decision_language.concrete</code> Package</div>
</div>
<div class="sect3">
<h4 id="_subject_variables_2"><a class="anchor" href="#_subject_variables_2"></a>4.3.1. Subject Variables</h4>
<div class="paragraph">
<p>The variable definitions found in the <code>input</code> section of a DLM are designed to facilitate both intuitive DLM authoring and tracking of values over time from real data sources, typically health records, devices and so on. The generic class <code>STATE_VARIABLE&lt;T&gt;</code> and descendants provide a representation of a subject variable with a symbolic name. The generic type parameter is substituted with types used for representing atomic data values, including primitive types such as <code>String</code>, <code>Integer</code> etc, as well as types like <code>Terminology_code</code>, <code>Quantity</code> etc, as available in the  models (type definitions) <em>used</em> by a DLM.</p>
</div>
<div class="paragraph">
<p>The class <code>STATE_VARIABLE&lt;T&gt;</code> models the simplest case: a variable that may be queried once for an execution run. This is sufficient for subject variables that are not time-dependent, and will not change during the execution, such as <code>date_of_birth</code>, <code>sex</code>, and Boolean variables such as <code>is_type1_diabetic</code>. The <code><em>history</em></code> attribute contains the variable value (normally only one sample), while the features <code>is_available()</code> and <code>unavailable_reason()</code> provide a way for missing data to be checked for.</p>
</div>
<div class="paragraph">
<p>For time-varying variables, the values must usually be tracked. The class <code>TRACKED_STATE_VARIABLE&lt;T&gt;</code> is is provided for this purpose, and adds the meta-attribute <code><em>currency</em></code>, a duration indicating the maximum age of the sample value to be useful or valid. The <code><em>history</em></code> attribute now contains variable samples over time. The function <code>value()</code> extracts the most recent available value, while <code>is_available()</code> is redefined to indicate whether a sufficiently recent value is available.</p>
</div>
<div class="paragraph">
<p>Many tracked variables are quantitative, and for these, extra facilities are provided via the class <code>TRACKED_QUANTITATIVE_VARIABLE&lt;T&gt;</code>, which adds the ranges facility described earlier in <a href="#_quantitative_tracked_variables">Section 3.8.3</a>.</p>
</div>
<div class="paragraph">
<p>Variable declarations in DL syntax, as described in the language section above are in fact instantiations of the <code>STATE_VARIABLE&lt;T&gt;</code> or a descendant, potentially with constructor paramaters supplied. Consider the following declaration, shown earlier:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="kotlin"><span></span>    <span class="tok-n">systolic_blood_pressure</span><span class="tok-p">:</span> <span class="tok-n">Quantity</span>
        <span class="tok-n">currency</span> <span class="tok-p">=</span> <span class="tok-m">1</span> <span class="tok-n">min</span><span class="tok-p">,</span>
        <span class="tok-n">ranges</span><span class="tok-p">[</span><span class="tok-s">&quot;mm[Hg]&quot;</span><span class="tok-p">]</span> <span class="tok-p">=</span>
            <span class="tok-p">--------------------------------</span>
            <span class="tok-p">|</span><span class="tok-err">≥</span><span class="tok-m">180</span><span class="tok-p">|:</span>         <span class="tok-p">[</span><span class="tok-n">critical_high</span><span class="tok-p">],</span>
            <span class="tok-p">|&gt;</span><span class="tok-m">140</span><span class="tok-p">|:</span>         <span class="tok-p">[</span><span class="tok-n">very_high</span><span class="tok-p">],</span>
            <span class="tok-p">|&gt;</span><span class="tok-m">120</span><span class="tok-p">|:</span>         <span class="tok-p">[</span><span class="tok-n">high</span><span class="tok-p">],</span>
            <span class="tok-p">|&gt;</span><span class="tok-m">90</span> <span class="tok-p">..</span> <span class="tok-err">≤</span><span class="tok-m">120</span><span class="tok-p">|:</span>  <span class="tok-p">[</span><span class="tok-n">normal</span><span class="tok-p">],</span>
            <span class="tok-p">|</span><span class="tok-err">≤</span><span class="tok-m">90</span><span class="tok-p">|:</span>          <span class="tok-p">[</span><span class="tok-n">low</span><span class="tok-p">],</span>
            <span class="tok-p">|</span><span class="tok-err">≤</span><span class="tok-m">50</span><span class="tok-p">|:</span>          <span class="tok-p">[</span><span class="tok-n">critical_low</span><span class="tok-p">]</span>
            <span class="tok-p">--------------------------------</span>
        <span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If we were to rewrite this in a more standard programming language, it might look like the following object instantiation, preceded by setup code (the syntax 'Type_name (args)' is used to represent an object creation using a constructor call in each case):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="kotlin"><span></span><span class="tok-c1">// build the ranges Map</span>
<span class="tok-n">ranges</span><span class="tok-p">:</span> <span class="tok-n">Map</span> <span class="tok-p">&lt;</span><span class="tok-n">Terminology_code</span><span class="tok-p">,</span> <span class="tok-n">Interval</span><span class="tok-p">&lt;</span><span class="tok-n">Quantity</span><span class="tok-p">&gt;</span> <span class="tok-p">();</span>
<span class="tok-n">ranges</span><span class="tok-p">.</span><span class="tok-n">put</span> <span class="tok-p">(</span><span class="tok-n">Terminology_code</span><span class="tok-p">(</span><span class="tok-s">&quot;critical_high&quot;</span><span class="tok-p">),</span> <span class="tok-n">Interval</span><span class="tok-p">&lt;</span><span class="tok-n">Quantity</span><span class="tok-p">&gt;(</span><span class="tok-m">180</span> <span class="tok-n">mm</span><span class="tok-p">[</span><span class="tok-n">Hg</span><span class="tok-p">],</span> <span class="tok-n">Void</span><span class="tok-p">);</span>
    <span class="tok-p">...</span>
<span class="tok-n">ranges</span><span class="tok-p">.</span><span class="tok-n">put</span> <span class="tok-p">(</span><span class="tok-n">Terminology_code</span><span class="tok-p">(</span><span class="tok-s">&quot;critical_low&quot;</span><span class="tok-p">),</span> <span class="tok-n">Interval</span><span class="tok-p">&lt;</span><span class="tok-n">Quantity</span><span class="tok-p">&gt;(</span><span class="tok-n">Void</span><span class="tok-p">,</span> <span class="tok-m">50</span> <span class="tok-n">mm</span><span class="tok-p">[</span><span class="tok-n">Hg</span><span class="tok-p">]);</span>

<span class="tok-c1">// instantiate the tracked variable object</span>
<span class="tok-n">systolic_blood_pressure</span><span class="tok-p">:</span> <span class="tok-n">TRACKED_QUANTITATIVE_VARIABLE</span><span class="tok-p">&lt;</span><span class="tok-n">Quantity</span><span class="tok-p">&gt;</span> <span class="tok-p">(</span>
    <span class="tok-s">&quot;systolic_blood_pressure&quot;</span><span class="tok-p">,</span>   <span class="tok-c1">// name</span>
    <span class="tok-s">&quot;PT1M&quot;</span><span class="tok-p">,</span>                      <span class="tok-c1">// currency</span>
    <span class="tok-n">ranges</span>                       <span class="tok-c1">// ranges</span>
<span class="tok-p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It will be appreciated that this is substantially more complex, and also arcane to a domain specialist. In the above, the part between the parentheses in the lower declaration corresponds to a call to a constructor of type <code>TRACKED_QUANTITATIVE_VARIABLE</code> with the signature <code>(name: String, currency: Iso8601_duration, ranges: Map&lt;Terminology_code, Interval&lt;T&gt;)</code>. From a formal point of view, such an instantiation creates an instance that will remain for the life of the DLM&#8217;s execution, in other words, a <em>computed constant</em> value. It is thus a meta-instance of the BMM meta-type <code>BMM_CONSTANT</code>, as shown in the DLM model above.</p>
</div>
<div class="paragraph">
<p>Each <code>input</code> variable declaration creates an object similar to the above, which may then be used during the execution of the DLM by calls made from the functions in the <code>rules</code> section. The simplest possible 'bare' reference of the variable name alone, i.e. <code>systolic_blood_pressure</code> in the example above, makes use of the <em>default delegate</em> feature of the BMM (<code>BMM_FUNCTION</code>) to invoke the <code><em>value()</em></code> function, avoiding the need to write <code>systolic_blood_pressure.value()</code>. However, all the features defined on <code>TRACKED_VARIABLE</code> and its descendants are indeed available for use in DLM code if needed. Thus, <code>systolic_blood_pressure.in_range([high])</code> is a normal call on the <code>systolic_blood_pressure</code> instance of <code>TRACKED_QUANTITATIVE_VARIABLE&lt;Quantity&gt;</code>.</p>
</div>
<div class="paragraph tbd">
<p>TO BE CONTINUED</p>
</div>
</div>
<div class="sect3">
<h4 id="_class_descriptions_2"><a class="anchor" href="#_class_descriptions_2"></a>4.3.2. Class Descriptions</h4>
<div class="sect4">
<h5 id="_state_variable_class"><a class="anchor" href="#_state_variable_class"></a>4.3.2.1. STATE_VARIABLE Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>STATE_VARIABLE&lt;T&gt;</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Abstraction of a real-world variable that represents a quality of a subject, e.g. patient diabetic status, date of birth etc.</p>
</div>
<div class="paragraph">
<p>The generic parameter is a model type from an accessible model.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>history</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_hash_class">Hash<sup></a>&lt;<a href="/releases/BASE/latest/foundation_types.html#_string_class">String</sup></a>,<a href="#_value_snapshot_class">VALUE_SNAPSHOT</a>&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Local history of values.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>name</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_string_class" target="_blank" rel="noopener">String</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Name of variable.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>is_available</strong> (): <code><a href="/releases/BASE/latest/foundation_types.html#_boolean_class" target="_blank" rel="noopener">Boolean</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if there is a value in <code><em>history</em></code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>unavailable_reason</strong> (): <code><a href="/releases/BASE/latest/foundation_types.html#_string_class" target="_blank" rel="noopener">String</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>If <code><em>is_available</em></code> is False, potentially provide a reason.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>value</strong> (): <code>T</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Retrieve latest value, or null if none.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_value_snapshot_class"><a class="anchor" href="#_value_snapshot_class"></a>4.3.2.2. VALUE_SNAPSHOT Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>VALUE_SNAPSHOT&lt;T&gt;</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>One or more snapshot attempts of the state variable, either containing values or unavailable reason.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>value</strong>: <code>T</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Value of variable in the real world, if available; Void if not.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>effective_time</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_iso8601_date_time_class" target="_blank" rel="noopener">Iso8601_date_time</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Real-world time at which <code><em>value</em></code> was last True, if available.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sample_time</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_iso8601_date_time_class" target="_blank" rel="noopener">Iso8601_date_time</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Time at which this sample was obtained from its source (e.g. a patient record system, device, or user interaction).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>unavailable_reason</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_string_class" target="_blank" rel="noopener">String</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>is_available</strong> (): <code><a href="/releases/BASE/latest/foundation_types.html#_boolean_class" target="_blank" rel="noopener">Boolean</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if <code><em>value</em></code> is not Void.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Invariants</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p><em>Inv_available</em>: <code>is_available() implies value /= Void</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tracked_state_variable_class"><a class="anchor" href="#_tracked_state_variable_class"></a>4.3.2.3. TRACKED_STATE_VARIABLE Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TRACKED_STATE_VARIABLE&lt;T&gt;</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>A 'tracked' subject variable representing a continuant quality of a subject over time, e.g. patient systolic blood pressure, heart rate etc, whose value is sampled over time.</p>
</div>
<div class="paragraph">
<p>The generic parameter is a model type from an accessible model.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><a href="#_state_variable_class">STATE_VARIABLE</a></code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>currency</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_iso8601_duration_class" target="_blank" rel="noopener">Iso8601_duration</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>If set, maximum age of a real-world snapshot of this variable&#8217;s value to be usable or valid.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>max_history</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_iso8601_duration_class" target="_blank" rel="noopener">Iso8601_duration</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>value_at_time</strong> (<br>
a_time: <code><a href="/releases/BASE/latest/foundation_types.html#_iso8601_date_time_class" target="_blank" rel="noopener">Iso8601_date_time</a>[1]</code><br>
): <code>T</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return the value from <code><em>history</em></code> that was available at time <code><em>time</em></code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>is_available</strong> (): <code><a href="/releases/BASE/latest/foundation_types.html#_boolean_class" target="_blank" rel="noopener">Boolean</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return True if there is a member of <code><em>history</em></code> whose <code><em>time</em></code> is within the duration of <code><em>currency</em></code> of the current moment.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_tracked_quantitative_variable_class"><a class="anchor" href="#_tracked_quantitative_variable_class"></a>4.3.2.4. TRACKED_QUANTITATIVE_VARIABLE Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TRACKED_QUANTITATIVE_VARIABLE&lt;T&gt;</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>Specialised property that represents a 'tracked variable' within the DLM <code>input</code> section. A tracked variable is used to record snapshots of an external variable such as a subject blood pressure.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code><a href="#_tracked_state_variable_class">TRACKED_STATE_VARIABLE</a></code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>unit_ranges</strong>: <code><a href="/releases/BASE/latest/foundation_types.html#_hash_class">Hash<sup></a>&lt;<a href="/releases/BASE/latest/foundation_types.html#_string_class">String</sup></a>,<a href="/releases/LANG/latest/bmm.html#_el_case_table_class">EL_CASE_TABLE<sup></a>&lt;<a href="/releases/LANG/latest/bmm.html#_el_literal_class">EL_LITERAL</sup></a>&gt;&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Range definitions, represented as tables, each one exhaustively covering the value space.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>in_range</strong> (<br>
a_range: <code><a href="/releases/BASE/latest/foundation_types.html#_terminology_code_class" target="_blank" rel="noopener">Terminology_code</a>[1]</code><br>
): <code><a href="/releases/BASE/latest/foundation_types.html#_boolean_class" target="_blank" rel="noopener">Boolean</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Determine if the last read value of the variable is in the named range within the default group. Use when there is only one range group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>range</strong> (): <code><a href="/releases/BASE/latest/foundation_types.html#_terminology_code_class" target="_blank" rel="noopener">Terminology_code</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return the name of the range from the default range group within which the last read value of the variable resides. Use when there is only one range group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>range_definition</strong> (<br>
a_range: <code><a href="/releases/BASE/latest/foundation_types.html#_terminology_code_class" target="_blank" rel="noopener">Terminology_code</a>[1]</code><br>
): <code><a href="/releases/BASE/latest/foundation_types.html#_interval_class" target="_blank" rel="noopener">Interval</a>&lt;T&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Return the interval of the named range within the default range group. Use when there is only one range group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>in_group_range</strong> (<br>
range_group: <code><a href="/releases/BASE/latest/foundation_types.html#_terminology_code_class" target="_blank" rel="noopener">Terminology_code</a>[1]</code>,<br>
a_range: <code><a href="/releases/BASE/latest/foundation_types.html#_terminology_code_class" target="_blank" rel="noopener">Terminology_code</a>[1]</code><br>
): <code><a href="/releases/BASE/latest/foundation_types.html#_boolean_class" target="_blank" rel="noopener">Boolean</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Form of <code><em>in_range()</em></code> to use when there is more than one range group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>group_range</strong> (<br>
range_group: <code><a href="/releases/BASE/latest/foundation_types.html#_terminology_code_class" target="_blank" rel="noopener">Terminology_code</a>[1]</code><br>
): <code><a href="/releases/BASE/latest/foundation_types.html#_terminology_code_class" target="_blank" rel="noopener">Terminology_code</a></code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Form of <code><em>range()</em></code> to use when there is more than one range group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>group_range_definition</strong> (<br>
range_group: <code><a href="/releases/BASE/latest/foundation_types.html#_terminology_code_class" target="_blank" rel="noopener">Terminology_code</a>[1]</code>,<br>
a_range: <code><a href="/releases/BASE/latest/foundation_types.html#_terminology_code_class" target="_blank" rel="noopener">Terminology_code</a>[1]</code><br>
): <code><a href="/releases/BASE/latest/foundation_types.html#_interval_class" target="_blank" rel="noopener">Interval</a>&lt;T&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Form of <code><em>range_def()</em></code> to use when there is more than one range group.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">

</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-10-08 16:00:50 +0100
</div>
</div>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/pygments-default.css">
</body>
</html>