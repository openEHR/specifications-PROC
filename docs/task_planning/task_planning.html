<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="description" content="openEHR Task Planning Specification">
<meta name="keywords" content="task, planning, EHR, EMR, reference model, openehr">
<title>Task Planning Model Specification</title>
<link rel="stylesheet" href="/releases/BASE/latest/resources/css/openehr.css">
<link rel="stylesheet" href="/releases/BASE/latest/resources/css/pygments-murphy.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_task_planning_model_specification">Task Planning Model Specification</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_primary_author">Primary Author</a></li>
<li><a href="#_contributors">Contributors</a></li>
<li><a href="#_support">Support</a></li>
<li><a href="#_intellectual_origins">Intellectual Origins</a></li>
<li><a href="#_trademarks">Trademarks</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_related_documents">1.2. Related Documents</a></li>
<li><a href="#_status">1.3. Status</a></li>
<li><a href="#_conformance">1.4. Conformance</a></li>
</ul>
</li>
<li><a href="#_background">2. Background</a>
<ul class="sectlevel2">
<li><a href="#_survey_of_requirements">2.1. Survey of Requirements</a></li>
<li><a href="#_limitations_of_the_openehr_standard_entry_model">2.2. Limitations of the openEHR standard Entry Model</a></li>
<li><a href="#_care_pathways_and_task_planning">2.3. Care Pathways and Task Planning</a></li>
<li><a href="#_task_plans_versus_task_lists_todo_lists">2.4. Task Plans versus Task Lists (TODO Lists)</a></li>
<li><a href="#_execution_paradigm">2.5. Execution Paradigm</a></li>
<li><a href="#_relationship_to_workflow_formalisms_and_systems">2.6. Relationship to Workflow Formalisms and Systems</a></li>
</ul>
</li>
<li><a href="#_requirements">3. Requirements</a>
<ul class="sectlevel2">
<li><a href="#_planned_tasks_for_an_order">3.1. Planned Tasks for an Order</a></li>
<li><a href="#_order_sets_and_protocols">3.2. Order Sets and Protocols</a></li>
<li><a href="#_lookahead_plan">3.3. Lookahead Plan</a></li>
<li><a href="#_recurring_repeatable_tasks">3.4. Recurring / Repeatable Tasks</a></li>
<li><a href="#_checklist_sign_off">3.5. Checklist &amp; Sign-off</a></li>
<li><a href="#_teamwork_and_notifications">3.6. Teamwork and Notifications</a></li>
<li><a href="#_sub_plans">3.7. Sub-plans</a></li>
<li><a href="#_task_grouping_optionality_and_execution_basis">3.8. Task Grouping, Optionality and Execution Basis</a></li>
<li><a href="#_decision_pathways">3.9. Decision Pathways</a></li>
<li><a href="#_different_types_of_cancellation">3.10. Different types of Cancellation</a></li>
<li><a href="#_changes_and_abandonment">3.11. Changes and Abandonment</a></li>
<li><a href="#_rationalising_unrelated_task_plans">3.12. Rationalising Unrelated Task Plans</a></li>
<li><a href="#_support_process_analytics">3.13. Support Process Analytics</a></li>
<li><a href="#_support_for_costing_and_billing_information">3.14. Support for Costing and Billing Information</a></li>
</ul>
</li>
<li><a href="#_design_principles">4. Design Principles</a>
<ul class="sectlevel2">
<li><a href="#_computational_basis">4.1. Computational Basis</a></li>
<li><a href="#_computational_context">4.2. Computational Context</a></li>
<li><a href="#_conceptual_basics">4.3. Conceptual Basics</a>
<ul class="sectlevel3">
<li><a href="#_work_plan">4.3.1. Work Plan</a></li>
<li><a href="#_task_plan">4.3.2. Task Plan</a></li>
<li><a href="#_graph_structure">4.3.3. Graph Structure</a></li>
<li><a href="#_work_context">4.3.4. Work Context</a></li>
<li><a href="#_context_switching_and_forking">4.3.5. Context Switching and Forking</a></li>
<li><a href="#_principal_performer">4.3.6. Principal Performer</a></li>
<li><a href="#time_and_wait_states">4.3.7. Time and Wait States</a></li>
</ul>
</li>
<li><a href="#_levels_of_definition_and_representation">4.4. Levels of Definition and Representation</a>
<ul class="sectlevel3">
<li><a href="#_separation_of_definition_and_execution">4.4.1. Separation of Definition and Execution</a></li>
</ul>
</li>
<li><a href="#_execution_concepts">4.5. Execution Concepts</a>
<ul class="sectlevel3">
<li><a href="#_plan_execution_lifecycle">4.5.1. Plan Execution Lifecycle</a></li>
<li><a href="#_allocation">4.5.2. Allocation</a></li>
<li><a href="#_task_lifecycle">4.5.3. Task Lifecycle</a></li>
<li><a href="#_availability">4.5.4. Availability</a></li>
<li><a href="#_adaptive_modification_and_exception_handling">4.5.5. Adaptive Modification and Exception-handling</a></li>
</ul>
</li>
<li><a href="#_relationship_of_task_plans_with_existing_openehr_entry_types">4.6. Relationship of Task Plans with existing openEHR Entry Types</a></li>
<li><a href="#_order_semantics_versus_plan_semantics">4.7. Order Semantics versus Plan Semantics</a></li>
</ul>
</li>
<li><a href="#_task_planning_model_overview">5. Task Planning Model Overview</a>
<ul class="sectlevel2">
<li><a href="#_identification_and_referencing">5.1. Identification and Referencing</a></li>
<li><a href="#_specifying_time">5.2. Specifying Time</a></li>
<li><a href="#_plan_data_context">5.3. Plan Data Context</a></li>
<li><a href="#_class_descriptions">5.4. Class Descriptions</a>
<ul class="sectlevel3">
<li><a href="#_plan_data_context_class">5.4.1. PLAN_DATA_CONTEXT Class</a></li>
<li><a href="#_context_value_class">5.4.2. CONTEXT_VALUE Class</a></li>
<li><a href="#_context_variable_class">5.4.3. CONTEXT_VARIABLE Class</a></li>
<li><a href="#_event_variable_class">5.4.4. EVENT_VARIABLE Class</a></li>
<li><a href="#_continuous_event_variable_class">5.4.5. CONTINUOUS_EVENT_VARIABLE Class</a></li>
<li><a href="#_state_variable_class">5.4.6. STATE_VARIABLE Class</a></li>
<li><a href="#_context_expression_class">5.4.7. CONTEXT_EXPRESSION Class</a></li>
<li><a href="#_boolean_context_expression_class">5.4.8. BOOLEAN_CONTEXT_EXPRESSION Class</a></li>
<li><a href="#_system_call_class">5.4.9. SYSTEM_CALL Class</a></li>
<li><a href="#_task_lifecycle_enumeration">5.4.10. TASK_LIFECYCLE Enumeration</a></li>
<li><a href="#_resume_type_enumeration">5.4.11. RESUME_TYPE Enumeration</a></li>
<li><a href="#_temporal_relation_enumeration">5.4.12. TEMPORAL_RELATION Enumeration</a></li>
<li><a href="#_execution_type_enumeration">5.4.13. EXECUTION_TYPE Enumeration</a></li>
<li><a href="#_time_specifier_class">5.4.14. TIME_SPECIFIER Class</a></li>
<li><a href="#_clock_time_class">5.4.15. CLOCK_TIME Class</a></li>
<li><a href="#_calendar_time_class">5.4.16. CALENDAR_TIME Class</a></li>
<li><a href="#_customary_time_class">5.4.17. CUSTOMARY_TIME Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_definition_model">6. Definition Model</a>
<ul class="sectlevel2">
<li><a href="#_overview">6.1. Overview</a>
<ul class="sectlevel3">
<li><a href="#_task_group_structure">6.1.1. Task Group Structure</a></li>
<li><a href="#_class_descriptions_2">6.1.2. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_work_plan_class">6.1.2.1. WORK_PLAN Class</a></li>
<li><a href="#_plan_calendar_class">6.1.2.2. PLAN_CALENDAR Class</a></li>
<li><a href="#_plan_timeline_class">6.1.2.3. PLAN_TIMELINE Class</a></li>
<li><a href="#_calendar_entry_class">6.1.2.4. CALENDAR_ENTRY Class</a></li>
<li><a href="#_task_plan_class">6.1.2.5. TASK_PLAN Class</a></li>
<li><a href="#_task_participation_class">6.1.2.6. TASK_PARTICIPATION Class</a></li>
<li><a href="#_plan_item_class">6.1.2.7. PLAN_ITEM Class</a></li>
<li><a href="#_task_group_class">6.1.2.8. TASK_GROUP Class</a></li>
<li><a href="#_execution_type_enumeration_2">6.1.2.9. EXECUTION_TYPE Enumeration</a></li>
<li><a href="#_execution_rule_class">6.1.2.10. EXECUTION_RULE Class</a></li>
<li><a href="#_task_class">6.1.2.11. TASK Class</a></li>
<li><a href="#_task_repeat_class">6.1.2.12. TASK_REPEAT Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_task_actions">6.2. Task Actions</a>
<ul class="sectlevel3">
<li><a href="#_performable_actions">6.2.1. Performable Actions</a>
<ul class="sectlevel4">
<li><a href="#_sub_plans_and_re_use">6.2.1.1. Sub-plans and Re-use</a></li>
<li><a href="#_inline_defined_actions">6.2.1.2. Inline Defined Actions</a></li>
<li><a href="#_data_sets_and_application_interaction">6.2.1.3. Data-sets and Application Interaction</a></li>
</ul>
</li>
<li><a href="#_dispatchable_actions">6.2.2. Dispatchable Actions</a>
<ul class="sectlevel4">
<li><a href="#_hand_offs_and_coordinated_teamwork">6.2.2.1. Hand-offs and Coordinated Teamwork</a></li>
<li><a href="#_external_request">6.2.2.2. External Request</a></li>
<li><a href="#_system_request">6.2.2.3. System Request</a></li>
</ul>
</li>
<li><a href="#_class_descriptions_3">6.2.3. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_task_action_class">6.2.3.1. TASK_ACTION Class</a></li>
<li><a href="#_subject_precondition_class">6.2.3.2. SUBJECT_PRECONDITION Class</a></li>
<li><a href="#_dataset_spec_class">6.2.3.3. DATASET_SPEC Class</a></li>
<li><a href="#_performable_action_class">6.2.3.4. PERFORMABLE_ACTION Class</a></li>
<li><a href="#_resource_participation_class">6.2.3.5. RESOURCE_PARTICIPATION Class</a></li>
<li><a href="#_defined_action_class">6.2.3.6. DEFINED_ACTION Class</a></li>
<li><a href="#_sub_plan_class">6.2.3.7. SUB_PLAN Class</a></li>
<li><a href="#_dispatchable_action_class">6.2.3.8. DISPATCHABLE_ACTION Class</a></li>
<li><a href="#_hand_off_class">6.2.3.9. HAND_OFF Class</a></li>
<li><a href="#_external_request_class">6.2.3.10. EXTERNAL_REQUEST Class</a></li>
<li><a href="#_system_request_class">6.2.3.11. SYSTEM_REQUEST Class</a></li>
<li><a href="#_linked_plan_class">6.2.3.12. LINKED_PLAN Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_conditional_structures">6.3. Conditional Structures</a>
<ul class="sectlevel3">
<li><a href="#_class_descriptions_4">6.3.1. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_condition_group_class">6.3.1.1. CONDITION_GROUP Class</a></li>
<li><a href="#_condition_branch_class">6.3.1.2. CONDITION_BRANCH Class</a></li>
<li><a href="#_decision_group_class">6.3.1.3. DECISION_GROUP Class</a></li>
<li><a href="#_decision_branch_class">6.3.1.4. DECISION_BRANCH Class</a></li>
<li><a href="#_event_group_class">6.3.1.5. EVENT_GROUP Class</a></li>
<li><a href="#_event_branch_class">6.3.1.6. EVENT_BRANCH Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_events">6.4. Events</a>
<ul class="sectlevel3">
<li><a href="#_event_types">6.4.1. Event Types</a></li>
<li><a href="#_task_wait_state">6.4.2. Task Wait State</a></li>
<li><a href="#_event_wait_state">6.4.3. Event Wait State</a></li>
<li><a href="#_timers">6.4.4. Timers</a></li>
<li><a href="#_callbacks">6.4.5. Callbacks</a></li>
<li><a href="#_class_descriptions_5">6.4.6. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_task_wait_class">6.4.6.1. TASK_WAIT Class</a></li>
<li><a href="#_plan_event_class">6.4.6.2. PLAN_EVENT Class</a></li>
<li><a href="#_delay_event_class">6.4.6.3. DELAY_EVENT Class</a></li>
<li><a href="#_manual_notification_class">6.4.6.4. MANUAL_NOTIFICATION Class</a></li>
<li><a href="#_system_notification_class">6.4.6.5. SYSTEM_NOTIFICATION Class</a></li>
<li><a href="#_callback_notification_class">6.4.6.6. CALLBACK_NOTIFICATION Class</a></li>
<li><a href="#_state_trigger_class">6.4.6.7. STATE_TRIGGER Class</a></li>
<li><a href="#_timer_event_class">6.4.6.8. TIMER_EVENT Class</a></li>
<li><a href="#_calendar_event_class">6.4.6.9. CALENDAR_EVENT Class</a></li>
<li><a href="#_timeline_moment_class">6.4.6.10. TIMELINE_MOMENT Class</a></li>
<li><a href="#_event_wait_class">6.4.6.11. EVENT_WAIT Class</a></li>
<li><a href="#_timer_wait_class">6.4.6.12. TIMER_WAIT Class</a></li>
<li><a href="#_reminder_class">6.4.6.13. REMINDER Class</a></li>
<li><a href="#_callback_wait_class">6.4.6.14. CALLBACK_WAIT Class</a></li>
<li><a href="#_event_action_class">6.4.6.15. EVENT_ACTION Class</a></li>
<li><a href="#_resume_action_class">6.4.6.16. RESUME_ACTION Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_repetition">6.5. Repetition</a></li>
<li><a href="#_training_level">6.6. Training Level</a></li>
<li><a href="#_references_to_clinical_quality_artefacts">6.7. References to Clinical Quality Artefacts</a></li>
<li><a href="#_cost_tracking">6.8. Cost Tracking</a>
<ul class="sectlevel3">
<li><a href="#_class_descriptions_6">6.8.1. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_task_costing_class">6.8.1.1. TASK_COSTING Class</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_definition_model_patterns">7. Definition Model Patterns</a>
<ul class="sectlevel2">
<li><a href="#_timing_patterns">7.1. Timing Patterns</a></li>
<li><a href="#_callback_patterns">7.2. Callback Patterns</a></li>
</ul>
</li>
<li><a href="#_execution_model_overview">8. Execution Model Overview</a>
<ul class="sectlevel2">
<li><a href="#_phases_of_instantiation">8.1. Phases of Instantiation</a>
<ul class="sectlevel3">
<li><a href="#_materialisation">8.1.1. Materialisation</a></li>
<li><a href="#_activation">8.1.2. Activation</a></li>
<li><a href="#_termination">8.1.3. Termination</a></li>
<li><a href="#_allowed_plan_modifications">8.1.4. Allowed Plan Modifications</a></li>
</ul>
</li>
<li><a href="#_execution_semantics">8.2. Execution Semantics</a>
<ul class="sectlevel3">
<li><a href="#_performer_allocation">8.2.1. Performer Allocation</a></li>
<li><a href="#_resource_allocation">8.2.2. Resource Allocation</a></li>
<li><a href="#_task_lifecycle_2">8.2.3. Task Lifecycle</a></li>
<li><a href="#_task_availability">8.2.4. Task Availability</a></li>
<li><a href="#_task_group_lifecycle_state">8.2.5. Task Group Lifecycle State</a></li>
<li><a href="#_execution_path">8.2.6. Execution Path</a></li>
<li><a href="#_resume_semantics">8.2.7. Resume Semantics</a></li>
<li><a href="#_persistence">8.2.8. Persistence</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_materialised_model">9. Materialised Model</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">9.1. Overview</a></li>
<li><a href="#_class_descriptions_7">9.2. Class Descriptions</a>
<ul class="sectlevel3">
<li><a href="#_m_work_plan_class">9.2.1. M_WORK_PLAN Class</a></li>
<li><a href="#_m_task_plan_class">9.2.2. M_TASK_PLAN Class</a></li>
<li><a href="#_m_plan_item_class">9.2.3. M_PLAN_ITEM Class</a></li>
<li><a href="#_m_task_group_class">9.2.4. M_TASK_GROUP Class</a></li>
<li><a href="#_m_task_class">9.2.5. M_TASK Class</a></li>
<li><a href="#_m_task_action_class">9.2.6. M_TASK_ACTION Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_plan_execution_history">10. Plan Execution History</a>
<ul class="sectlevel2">
<li><a href="#_overview_3">10.1. Overview</a></li>
<li><a href="#_class_descriptions_8">10.2. Class Descriptions</a>
<ul class="sectlevel3">
<li><a href="#_task_plan_execution_history_class">10.2.1. TASK_PLAN_EXECUTION_HISTORY Class</a></li>
<li><a href="#_event_record_class">10.2.2. EVENT_RECORD Class</a></li>
<li><a href="#_task_plan_event_record_class">10.2.3. TASK_PLAN_EVENT_RECORD Class</a></li>
<li><a href="#_task_event_record_class">10.2.4. TASK_EVENT_RECORD Class</a></li>
<li><a href="#_task_notification_record_class">10.2.5. TASK_NOTIFICATION_RECORD Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_transactional_service_model">11. Transactional Service Model</a>
<ul class="sectlevel2">
<li><a href="#_overview_4">11.1. Overview</a></li>
<li><a href="#_definition_interface">11.2. Definition Interface</a></li>
<li><a href="#_execution_time_interface">11.3. Execution-time Interface</a></li>
<li><a href="#_class_descriptions_9">11.4. Class Descriptions</a>
<ul class="sectlevel3">
<li><a href="#_i_work_plan_definition_interface">11.4.1. I_WORK_PLAN_DEFINITION Interface</a></li>
<li><a href="#_i_task_plan_materialised_interface">11.4.2. I_TASK_PLAN_MATERIALISED Interface</a></li>
<li><a href="#_i_work_plan_definition_interface_2">11.4.3. I_WORK_PLAN_DEFINITION Interface</a></li>
<li><a href="#_i_task_plan_materialised_interface_2">11.4.4. I_TASK_PLAN_MATERIALISED Interface</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_relationship_with_other_openehr_ehr_artefacts">12. Relationship with other openEHR EHR Artefacts</a>
<ul class="sectlevel2">
<li><a href="#_overview_5">12.1. Overview</a></li>
<li><a href="#_execution_time_ehr_structures">12.2. Execution-time EHR Structures</a></li>
</ul>
</li>
<li><a href="#_references">References</a>
<ul class="sectlevel2">
<li><a href="#_publications">Publications</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="/releases/BASE/latest/resources/images/openehr_logo_large.png" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_task_planning_model_specification" class="sect0">Task Planning Model Specification</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="/programs/specification/">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: latest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: TRIAL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: task, planning, EHR, EMR, reference model, openehr</p></td>
</tr>
</tbody>
</table>
<div class="imageblock" style="text-align: center">
<div class="content">
<img src="diagrams/openehr_block_diagram.png" alt="openEHR components" width="60%">
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2017 - 2017 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="/">The openEHR Foundation</a> is an independent, non-profit community organisation, facilitating the sharing of health records by consumers and clinicians via open-source, standards-based implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="/releases/BASE/latest/resources/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://openehr.atlassian.net/browse/SPECPR/" class="bare">https://openehr.atlassian.net/browse/SPECPR/</a><br>
 Web: <a href="/">www.openehr.org</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record">Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>R E L E A S E&#160;&#160;&#160;&#160;&#160;1.0.0</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue"></a>1.0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://openehr.atlassian.net/browse/SPECPROC-2">SPECPROC-2</a> Fix various typos; add missed <code>BOOLEAN_CONTEXT_EXPRESSION</code>;
 Remove duplicate attribute <code>WORK_PLAN.<em>events</em></code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M Kejžar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>24 Oct 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://openehr.atlassian.net/browse/SPECPROC-1">SPECPROC-1</a> Further documentation improvements;
 Added explanations for resume semantics; added <code>RESUME_ACTION</code> class.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">17 Oct 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://openehr.atlassian.net/browse/SPECPROC-1">SPECPROC-1</a> Restructure document;
 Various refactoring of Event classes; global calendar, timeline.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12 Oct 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.8.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://openehr.atlassian.net/browse/SPECPROC-1">SPECPROC-1</a> Workshop Sep 25-28 and follow-up calls;<br>
 Significant updates to model;<br>
 Include event-based design;<br>
 Moved spec to new PROC openEHR component.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B Fabjan,<br>
 B Lah,<br>
 B Naess,<br>
 M Kejžar,<br>
 E Leonov,<br>
 V Makarov,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 Oct 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.8.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">New Task subtypes; re-design 'system request' concept; build out callback classes; remove explicit notifications from model.<br>
 Improve performer model. Add more design material. Improved Task state machine.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">25 Aug 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.8.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incorporate changes from Workshop 28/29 July. Change principal performer to Group level; add specialised Task types; add system request.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B Lah,<br>
 B Naess,<br>
 M Kejžar,<br>
 E Leonov,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">06 Jul 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incorporate review comments from Boštjan Lah.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B Lah,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20 Jun 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rework runtime model.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">07 Jun 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Incorporate review comments from Pablo Pazos.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Pazos,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">06 Jun 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.7.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Major rewrite, incorporating structure, parallelism, decision paths, and execution history.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31 May 2017</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.6.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://openehr.atlassian.net/browse/SPECRM-58">SPECRM-58</a>. Initial writing.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 B Naess,<br>
 I McNicoll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">26 Jan 2017</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements">Acknowledgements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_primary_author">Primary Author</h3>
<div class="ulist">
<ul>
<li>
<p>Thomas Beale, Ars Semantica (UK); openEHR Foundation Management Board.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_contributors">Contributors</h3>
<div class="paragraph">
<p>This specification benefited from formal and informal input from the openEHR and wider health informatics community. The openEHR Foundation would like to recognise the following people for their contributions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Borut Fabjan, Program Manager, Marand, Slovenia</p>
</li>
<li>
<p>Matija Kejžar, Marand, Slovenia</p>
</li>
<li>
<p>Bostjan Lah, Architect, Marand, Slovenia</p>
</li>
<li>
<p>Eugeny Leonov, Solit Clouds, Moscow, Russia</p>
</li>
<li>
<p>Ian McNicoll MD, FreshEHR, UK</p>
</li>
<li>
<p>Bjørn Næss, DIPS, Norway</p>
</li>
<li>
<p>Pablo Pazos Gutierrez, CaboLabs, Uruguay</p>
</li>
<li>
<p>Pekka Pesola, Engineer, Tieto, Finland</p>
</li>
<li>
<p>Vladimir V Makarov, Department of Information Technologies, City of Moscow</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_support">Support</h3>
<div class="paragraph">
<p>The work reported in this specification has been funded by the following organisations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>City of Moscow</p>
</li>
<li>
<p>Marand d.o.o., Slovenia</p>
</li>
<li>
<p>DIPS, Norway</p>
</li>
<li>
<p>Ars Semantica, UK</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_intellectual_origins">Intellectual Origins</h3>
<div class="paragraph">
<p>Many of the design ideas presented in this specification came from analysis of use cases from industry sources. In particular, the openEHR implementers Marand and DIPS provided significant detailed requirements, use cases, and design ideas.</p>
</div>
<div class="paragraph">
<p>Additionally the Activity-Based Design (ABD) project at Intermountain Healthcare (2015-), on which the primary author worked part time proved an important source of cross-fertilisation. The latter project is led by David Edwards and Alan James (chief architect), within the clinical quality program, under Dr Brent James, Chief Quality Officer at Intermountain Healthcare. ABD has a sophisticated architecture based on a custom archetype / template framework, adaptive workflow concepts, application generation and real-time speech recognition. It has pioneered a number of concepts used in the current specification, including the separation of definition, materialised and runtime levels of representation.</p>
</div>
<div class="paragraph">
<p>Lastly, a review of research literature and standards was conducted. Many of the ideas in YAWL ([<a href="#Hofstede_van_der_Aalst_2009">[Hofstede_van_der_Aalst_2009]</a>]) and its underlying research influenced this specification. The authors also reviewed various standards, including the OMG&#8217;s <a href="http://www.bpmn.org/">BPMN</a> and <a href="http://www.omg.org/spec/CMMN/1.0/">CMMN</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_trademarks">Trademarks</h3>
<div class="ulist">
<ul>
<li>
<p>'openEHR' is a trademark of the openEHR Foundation.</p>
</li>
<li>
<p>'OMG' is a trademark of the Object Management Group.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document describes the openEHR Task Planning Model, which is a formal specification of information representing Planned Tasks. It is designed as a formal extension to the openEHR EHR Information Model, and assumes the types described in that specification.</p>
</div>
<div class="paragraph">
<p>The intended audience includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standards bodies producing health informatics standards;</p>
</li>
<li>
<p>Academic groups using openEHR;</p>
</li>
<li>
<p>The open source healthcare community;</p>
</li>
<li>
<p>Solution vendors;</p>
</li>
<li>
<p>Medical informaticians and clinicians interested in health information.</p>
</li>
<li>
<p>Health data managers.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_documents"><a class="anchor" href="#_related_documents"></a>1.2. Related Documents</h3>
<div class="paragraph">
<p>Prerequisite documents for reading this document include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="/releases/BASE/latest/architecture_overview.html">openEHR Architecture Overview</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Related documents include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="/releases/RM/latest/ehr.html">openEHR EHR Information Model</a>;</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.3. Status</h3>
<div class="paragraph">
<p>This specification is in the TRIAL state. The development version of this document can be found at <a href="/releases/PROC/latest/task_planning.html">www.openehr.org/releases/PROC/latest/task_planing.html</a>.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
<div class="paragraph">
<p>Users are encouraged to comment on and/or advise on these paragraphs as well as the main content.  Feedback should be provided either on the <a href="http://lists.openehr.org/mailman/listinfo/openehr-technical_lists.openehr.org">technical mailing list</a>, or on the <a href="https://openehr.atlassian.net/issues/?filter=11106">specifications issue tracker</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conformance"><a class="anchor" href="#_conformance"></a>1.4. Conformance</h3>
<div class="paragraph">
<p>Conformance of a data or software artifact to an openEHR Reference Model specification is determined by a formal test of that artifact against the relevant openEHR Implementation Technology Specification(s) (ITSs), such as an IDL interface or an XML-schema. Since ITSs are formal, automated derivations from the Reference Model, ITS conformance indicates RM conformance.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_background"><a class="anchor" href="#_background"></a>2. Background</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_survey_of_requirements"><a class="anchor" href="#_survey_of_requirements"></a>2.1. Survey of Requirements</h3>
<div class="paragraph">
<p>This specification for a Task Planning facility for openEHR addresses requirements in a number of areas in which some form of granular planning of clinical tasks is required. The central concept is that of a <em>plan</em> (or set of plans) designed to achieve a <em>goal</em> and that relate to an <em>active biological subject</em> (normally a human or animal patient), rather than a passive object, such as a parcel or tissue sample. The requirements covered include one-off scheduled tasks (e.g. surgical procedure), long-running scheduled tasks (e.g. drug administration), recurring tasks (e.g. monitoring), and coordinated teamwork (e.g. acute stroke management). Related requiredments of individual worker task lists are discussed below.</p>
</div>
<div class="paragraph">
<p>In more sophisticated environments (generally hospitals), much task planning relates to guideline-based orders and medication administration. There are various levels at which to understand this, from care pathways (potentially covering management of a complex condition like sepsis) to specific workflows for particular elements of care within a pathway. One common conceptual entity is the so-called <em>order set</em>, which is generally understood as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a set of orders for medications and/or other therapies that are used together to achieve a particular clinical goal, e.g. the drugs for a particular chemotherapy regimen are often modelled as an order set;</p>
</li>
<li>
<p>potentially a detailed plan for administration of the items in the order set, which may be a fully planned out schedule of single administrations on particular days and times;</p>
</li>
<li>
<p>descriptive meta-data, including authors, history, evidence base, etc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In openEHR, the first item corresponds to a set of openEHR Instructions, while the second is a candidate for representation in openEHR via the Task Planning facility documented in this specification. Hence, the addition of Task Planning to openEHR provides an important element enabling the order set notion to be formalised in openEHR.</p>
</div>
<div class="paragraph">
<p>The specification addresses the lack of fine-grained task planning facilities in the basic openEHR specifications, which are limited to the Instruction and Action concepts. These provide ways of stating orders and recording actions performed after the fact, but no way of representing or sharing plans for actions before they are performed. This limitation is described in more detail below.</p>
</div>
<div class="paragraph">
<p>The approach followed here is to specify representations of task plans at various stages in the planning lifecycle, i.e.:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>design time</strong>: templates or prototypes of standard task plans are developed and published;</p>
</li>
<li>
<p><strong>runtime - planning</strong>: task plan prototypes are turned into concrete plans for specific work items for specific patients and activated;</p>
</li>
<li>
<p><strong>runtime - work execution</strong>: task plans are executed by clinical performers and the plan maintained up to date in real time;</p>
</li>
<li>
<p><strong>runtime - work completion</strong>: as each task is performed, standard clinical statements (openEHR Entries) are committed to the EHR to record what was done.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The models described here are thus designed to support both design-time modelling (via archetypes, terminology subsetting) and runtime execution with modifications and abandonment possible while the work is being performed.</p>
</div>
</div>
<div class="sect2">
<h3 id="_limitations_of_the_openehr_standard_entry_model"><a class="anchor" href="#_limitations_of_the_openehr_standard_entry_model"></a>2.2. Limitations of the openEHR standard Entry Model</h3>
<div class="paragraph">
<p>The Entry model described in the <a href="/releases/RM/latest/ehr.html">openEHR EHR IM</a> defines a way to record clinical statements representing real observations, decisions, orders and actions that have occurred, in the EHR. In this scheme, Instructions represent orders for certain kinds of Actions to be performed. Actions and Observations represent events that have subsequently occurred in the real world - a real drug administration or an actual blood sugar measurement.</p>
</div>
<div class="paragraph">
<p>There is however a common additional need to concretely plan individual Actions and sometimes Observations ahead of time, as a set of 'tasks', often known as a 'task list'. Here we will use the more general term <em>task plan</em> to mean a specification of a set of actions to be performed by actors (usually human, but potentially machine as well) providing care.</p>
</div>
<div class="paragraph">
<p>A set of planned tasks need not all relate to a single order, or indeed any order. The general picture is that a task plan corresponds to some self-standing healthcare job to be done, which may include tasks designed to fulfill multiple orders, and also tasks not defined by orders.</p>
</div>
<div class="paragraph">
<p>To meet this need, a further kind of content can be recorded in the EHR, representing task plans containing tasks. Here we understand the word 'task' to mean 'definition of a planned task', i.e. a description of something to be performed in the future.</p>
</div>
</div>
<div class="sect2">
<h3 id="_care_pathways_and_task_planning"><a class="anchor" href="#_care_pathways_and_task_planning"></a>2.3. Care Pathways and Task Planning</h3>
<div class="paragraph">
<p>In order to respond to the need to formally represent clinical Task Plans, and to close the gap between orders and reported actions in openEHR, this specification provides a model of a <em>task planning</em> facility, which is conceptually situated in a larger semantic framework that includes entities at multiple levels, i.e.:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>care pathway</em> - a structured description of care of a condition / ideal patient, typically including or referring to one or more <em>guidelines</em> that describe in detail how to deal with specific situations within the condition;</p>
</li>
<li>
<p><em>care plan</em> - a general plan for care of an actual patient, possibly using published Care Pathways and/or guidelines and taking into account individual specificities;</p>
</li>
<li>
<p><em>task plan</em> - a concrete definition of a set of fine-grained planned tasks for one or more actors to perform over time to achieve a particular goal.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These entities and their relationships can be envisaged as follows.</p>
</div>
<div id="pathway_plan_triad" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/pathway_plan_triad.svg" alt="pathway plan triad" width="60%">
</div>
<div class="title">Figure 1. The care pathway / care plan / task plan triad</div>
</div>
<div class="paragraph">
<p>The above diagram shows task plans as a concrete planning artefact that results from a care plan for a specific patient, and may be partly based on published care pathways and clinical guidelines, each of which can be thought of as a basis for task plans for an ideal patient for a given condition (e.g. pregnancy, sepsis, stroke etc). Where care pathways (or parts thereof) can be represented as formal artefacts, they can act as prototypes for task pan structures. However, a care pathway for a model patient is not the same thing as a task plan(s) for an actual patient, since each real patient has his/her own specific combination of conditions, preferences and ultimately phenotypic specificities. Thus, where task plans are based on care pathways, the latter act as prototypes whose ideal form may be modified by the specific care plan and/or as the care team deems appropriate.</p>
</div>
<div class="paragraph">
<p>This specification addresses the representation and semantics of concrete task plans. It does not address the representation of the care plan and it does not say anything directly about formal care pathway representation, although it may be surmised for the future that the formal form of a care pathway may have significant commonality with the task plan model presented here, which may provide a useful guide for future work in care pathway representation.</p>
</div>
<div class="paragraph">
<p>The task plan model does however assume that a task plan may be <em>created</em> due to a care plan of some kind, and that the care plan may in turn have been derived from one or more care pathways or guidelines; accordingly, the means to identify the plan and pathway / guideline are provided.</p>
</div>
<div class="paragraph">
<p>In the following, the term 'task' denotes the definition of an action to be performed, the report of which is normally documented in openEHR by the <code>ACTION</code> Entry subtype. However, 'task' is also understood more generally, so that it may also when performed, result in an openEHR <code>OBSERVATION</code> or other Entry subtype where appropriate. In the great majority of cases therefore, the term 'task' as it appears here equates to openEHR Actions and Observations.</p>
</div>
<div class="paragraph">
<p>For the sake of brevity, 'Action' below is intended to imply an openEHR <code>ACTION</code>, <code>OBSERVATION</code> or potentially other Entry sub-type, unless otherwise stated.</p>
</div>
</div>
<div class="sect2">
<h3 id="_task_plans_versus_task_lists_todo_lists"><a class="anchor" href="#_task_plans_versus_task_lists_todo_lists"></a>2.4. Task Plans versus Task Lists (TODO Lists)</h3>
<div class="paragraph">
<p>The specification is based around the concept of a <em>task plan</em>, which is designed to achieve a goal, and at execution time is applied to a <em>subject</em>, i.e. human or other subject of care. The plan notion is thus goal- and subject-centric.</p>
</div>
<div class="paragraph">
<p>A related concept is that of the <em>task list</em> (aka 'TODO list'), which is a logical list of tasks for a worker to perform. The task list is thus worker-centric, not subject-centric, and as such, task lists must be <em>derived</em> from task plans. Conceptually this is done by processing all extant task plans for some organisational unit (say a hospital department) and allocating particular tasks to particular actors. Allocation may happen in a just-in-time fashion, and may be modified (e.g. due to unforeseen unavailability of workers), such that a task list is essentially a dynamic personal calendar view for the short term (typically days or weeks) whereas task plans may correspond to any length of time, from a few minutes to years.</p>
</div>
<div class="paragraph">
<p>This specification does not cover the model of worker task lists or extracted calendar views, although it provides some guidance on how to generate task lists for workers.</p>
</div>
</div>
<div class="sect2">
<h3 id="_execution_paradigm"><a class="anchor" href="#_execution_paradigm"></a>2.5. Execution Paradigm</h3>
<div class="paragraph">
<p>As soon as the notion of planning is assumed, we enter some form of the workflow space, and it becomes essential to describe the intended paradigm of the human / machine execution environment. This is due to the fact that any description of planned tasks acts as a set of instructions to actors intended to perform the tasks. Since the instructions (task plans) will be represented in the IT layer and the executing actors (generally human, although they may also be devices or software applications) exist in the real world, an account of the interaction between the computing environment and the real world is required.</p>
</div>
<div class="paragraph">
<p>Although the task plan facility described in this specification is relatively simple compared to some workflow tools, we can nevertheless distinguish the following entities in the environment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>computing environment</em>:</p>
<div class="ulist">
<ul>
<li>
<p><strong>work plan definition</strong>: a reusable definition of work to be done, consisting of tasks, potentially standardised according to a guideline or protocol;</p>
</li>
<li>
<p><strong>work plan instance</strong>: a run-time instance of a task plan, potentially with local variations, created for execution by an actor or actors;</p>
</li>
</ul>
</div>
</li>
<li>
<p><em>real world</em>:</p>
<div class="ulist">
<ul>
<li>
<p><strong>performing actor</strong>, i.e. a human, machine or software application that performs tasks in the real world as part of a procedure designed to achieve a goal;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In normal environments such as healthcare, the real-world actors are not passive recipients of commands from a computer application implementing a work plan, but are instead active agents who normally work together to perform a job. Working together involves peer to peer communication, ordering of tasks and so on. A workflow application provides help by maintaining a representation of the work plan, and a representation of its progress in execution. It is immediately apparent that the application&#8217;s idea of a given work plan execution and the real world state of the same work are not identical, and in fact may be only approximately related. For example, the computable form of the work plan might only include some of the tasks and actors at work in the real world. There are in fact two workflows executing: a virtual workflow and the real world one, and there is accordingly a problem of <em>synchronisation</em> of the two.</p>
</div>
<div class="paragraph">
<p>There is also a question of communication between the workflow application and the real world actors, which we can think of as consisting of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>commands</strong>: signals from the work plan system to a real world actor to do something;</p>
</li>
<li>
<p><strong>notifications</strong>: signals to and from the work plan system and the real world actors on the status of work, e.g. 'new work item', 'item completed' etc;</p>
</li>
<li>
<p><strong>data</strong>: data collection from actors and presentation to actors from the system.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This environment can be illustrated as follows.</p>
</div>
<div id="workflow_execution_paradigm" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/workflow_execution_paradigm.svg" alt="workflow execution paradigm" width="55%">
</div>
<div class="title">Figure 2. Work plan execution paradigm</div>
</div>
</div>
<div class="sect2">
<h3 id="_relationship_to_workflow_formalisms_and_systems"><a class="anchor" href="#_relationship_to_workflow_formalisms_and_systems"></a>2.6. Relationship to Workflow Formalisms and Systems</h3>
<div class="paragraph">
<p>This specification describes a model for a 'task plan' concept that incudes support for work distribution across multiple performers, nested task plans, conditional branching, timing and various other facilities. Many of these are conceptually close to the features found in standard workflow languages such as <a href="http://www.bpmn.org/">BPMN</a> (Business Process Modelling Notation) and <a href="http://yawlfoundation.org/">YAWL</a> (Yet another Workflow Language), as well as emerging case-based standards such as <a href="http://www.omg.org/spec/CMMN/1.0/">CMMN</a> (Case Management Modelling Notation) and <a href="http://www.omg.org/spec/DMN/">DMN</a> (Decision Model and Notation). Of these, YAWL is the most comprehensive in its design and the most useful source of concepts for the current specification.</p>
</div>
<div class="paragraph">
<p>While the model described here takes ideas from these languages, there are some key differencs as well. The primary conceptual difference is that the subject (i.e. 'case') here is assumed to be a) an intentional agent (generally a human patient) that makes choices, and b) an active biological organism, which reacts to drugs and other interventions. In other words, an entity that cannot be considered a passive object (such as a package or blood sample), as is the case for most logistic workflows, for which languages such as BPMN are designed. (Note that even the patient can be a passive object in some circumstances, such as radiology.) Other departures include the use of a declarative rather than prescriptive means of defining the plan graph structure, and the formalisation of all elements of a plan and its execution.</p>
</div>
<div class="paragraph">
<p>The main consequence of this is that the design of a task plan is not taken to be a highly deterministic description whose exceptions are generally knowable in advance as they would be for a logistic system whose subjects are passive objects. Instead, tasks and groups of tightly-coupled tasks are specified in a more self-standing way, using preconditions rather than logical join and split operators.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_requirements"><a class="anchor" href="#_requirements"></a>3. Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Task planning is applicable to numerous clinical scenarios, exemplified by the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>routine simple medication administration, e.g. for post-operative pain - tasks extend across worker shifts;</p>
</li>
<li>
<p>complex drug administration e.g. multi-drug chemotherapy over multiple days;</p>
</li>
<li>
<p>physiotherapy rehabilitation sessions - recurrent therapeutic procedure, with defined end-point;</p>
</li>
<li>
<p>dialysis - recurrent therapeutic procedure;</p>
</li>
<li>
<p>diet + physical activity plan for overweight treatment - recurrent tasks, patient as a performer;</p>
</li>
<li>
<p>surgery planning - one time event;</p>
</li>
<li>
<p>acute stroke management - multiple sets of tasks coordinated across multiple performers.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Within these and many other similar clinical procedures, a number of commonly occurring generic requirements appear, as described below.</p>
</div>
<div class="sect2">
<h3 id="_planned_tasks_for_an_order"><a class="anchor" href="#_planned_tasks_for_an_order"></a>3.1. Planned Tasks for an Order</h3>
<div class="paragraph">
<p>The simplest need is to be able to post a full plan of all actions to be performed for an order, in advance of the order commencing. This would result in a series of Tasks for each planned openEHR <code>ACTION</code> at execution time.</p>
</div>
<div class="paragraph">
<p>In openEHR, an order is represented by an <code>INSTRUCTION</code> instance, which contains a directive to do something such as preform radiography or administer medication. The form of representation in the Instruction is normally <em>interpretable</em> by an agent who will convert it to separate tasks. For example, a drug order for Amoxicillin 500mg oral tablet 3 times/day x 7 days is converted by a human agent to 21 separate tasks, each consisting of taking one tablet at a certain time or day. These tasks can be represented in a task plan, each task of which which can then be performed and signed off by a staff member, e.g. a shift nurse. The task plan acts as a record of what has been done, and what is left to do.</p>
</div>
<div class="paragraph">
<p>One difficulty with posting a full plan is that in some cases, the work is effectively open-ended, i.e. it has no currently known completion date. This might be because the patient condition being treated is chronic, e.g. insulin or Salbutamol (Ventolin) treatment; or it might be that although the condition is assumed to be limited in time, no current assumption can be made about when, e.g. pain medication of a trauma patient.</p>
</div>
</div>
<div class="sect2">
<h3 id="_order_sets_and_protocols"><a class="anchor" href="#_order_sets_and_protocols"></a>3.2. Order Sets and Protocols</h3>
<div class="paragraph">
<p>A plan for a clinical intervention will typically need to encompass more than one order, in situations where drugs and other therapies are used according to a protocol or regime. For example, in multi-drug chemotherapy based on protocols like CHOP (non-Hodgkin&#8217;s lymphoma), COPP or Stanford V (Hodgkin&#8217;s lymphoma) etc, a single drug such as Cyclophosphamide is just a component. A task plan for administering chemotherapy according to a R-CHOP protocol would implicate orders for the drugs  (R)ituximab, (C)yclophosphamide, (H)ydroxydaunorubicin, (O)ncovin, and (P)rednisolone or Prednisone, and would accordingly include planned tasks for each of these drugs as they are administered according to the protocol.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Drug</th>
<th class="tableblock halign-left valign-top">Standard [R]-CHOP-14 or<br>
 [R]-CHOP-21</th>
<th class="tableblock halign-left valign-top">[R]-Maxi-CHOP</th>
<th class="tableblock halign-left valign-top">Mode</th>
<th class="tableblock halign-left valign-top">Days</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(R)ituximab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">375 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">375 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV infusion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(C)yclophosphamide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">750 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1200 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV infusion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(H)ydroxydaunorubicin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">75 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV bolus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(O)ncovin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4 mg/m² (max. 2 mg)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 mg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IV bolus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Day 1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(P)rednisone or (P)rednisolone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">40 mg/m²</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 mg</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PO qd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Days 1-5</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>(Extract from <a href="https://en.wikipedia.org/wiki/CHOP">Wikipedia</a>.)</p>
</div>
<div class="paragraph">
<p>A more general notion is of a protocol or guideline, which is a full set of actions to be performed to achieve a goal. Some of the actions will have corresponding orders, but others, such as making intermediate observations, may not. Examples can be found at sites such as the <a href="https://pathways.nice.org.uk/">UK National Institute for Care and Excellence (NICE)</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_lookahead_plan"><a class="anchor" href="#_lookahead_plan"></a>3.3. Lookahead Plan</h3>
<div class="paragraph">
<p>A more flexible version of a plan is 'lookahead' planning, i.e. posting a plan of tasks for a moving window in time, e.g. one day, a few days, a few nursing rotations etc. The idea is not to try to plan out the entire plan execution, since it can easily change or be stopped, e.g. due to change in patient or other unexpected events. In a lookahead approach, some planned tasks are executed, and more planned tasks are added. The planned timing of each set of tasks may change due to the current situation, with the effect that the overall set of tasks that unfolds in time may well be different from an attempt to plan all tasks before any are executed.</p>
</div>
<div class="paragraph">
<p>For the open-ended cases mentioned above, the only option is a lookahead plan that extends as far ahead in time as the treating physicians are prepared to go.</p>
</div>
</div>
<div class="sect2">
<h3 id="_recurring_repeatable_tasks"><a class="anchor" href="#_recurring_repeatable_tasks"></a>3.4. Recurring / Repeatable Tasks</h3>
<div class="paragraph">
<p>Many clinical plans involve repetition over time. For example, the 14-day version of the CHOP protocol (CHOP-14) involves execution of the 5 day treatment every 14 days, for 3 iterations. Other clinical plans are essentially permanently recurring for the life of the patient, e.g asthma therapy.</p>
</div>
</div>
<div class="sect2">
<h3 id="_checklist_sign_off"><a class="anchor" href="#_checklist_sign_off"></a>3.5. Checklist &amp; Sign-off</h3>
<div class="paragraph">
<p>If a task plan is created, the constituent tasks can be viewed by workers as a checklist, and subsequently signed off as having been either performed or not done over time. The utility of this is that the correspondence between the tasks actually performed (represented by <code>ACTION</code>, <code>OBSERVATION</code> etc Entries) and the planned tasks is established. If a planned Action A1 is posted with execution time T, it might actually be performed at time T', but users still want to know that it was planned Action A1 that was intentionally performed, and not some other Action in the task plan. Over the course of the order execution, a picture will emerge of planned Actions being performed and signed off, possibly with some being missed as not needed, or not done for some other reason. Additional Actions not originally posted in the plan might also be done if they are allowed by the general specification of the relevant archetypes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_teamwork_and_notifications"><a class="anchor" href="#_teamwork_and_notifications"></a>3.6. Teamwork and Notifications</h3>
<div class="paragraph">
<p>In many cases, a task plan is intended for execution by a team of specialised performers, with each performer doing their part of the work, and at various points, passing control to another team member. Management of acute stroke is an example of this. In other cases, team members are working more or less in parallel, or by communicating in real time to each other. In both situations, if the workers are not physically in the same room at the same time, notifications are needed to alert each person when to start working on the subject; similarly, callback notifications are needed to alert original workers when other work has been completed, for example, an MRI image taken and report written.</p>
</div>
</div>
<div class="sect2">
<h3 id="_sub_plans"><a class="anchor" href="#_sub_plans"></a>3.7. Sub-plans</h3>
<div class="paragraph">
<p>Plans can be described at varying levels of detail, depending on how workers are intended to work with them. One institution may describe an action such as cannulation atomically, relying on professional training and situational specifics to generate the correct concrete outcome, whereas another may require nurses to follow a guideline such as this <a href="http://emedicine.medscape.com/article/1998177-overview">Medscape Intravenous Cannulation</a> guideline. In cases where a self-standing clinical task is itself fully described in terms of steps, it is possible to represent the latter as its own task plan, and to be able to <em>refer</em> to it from another task plan. The general case is that any task that could be represented by a single item in a task plan could also be represented by a reference to a separate detailed task plan.</p>
</div>
</div>
<div class="sect2">
<h3 id="_task_grouping_optionality_and_execution_basis"><a class="anchor" href="#_task_grouping_optionality_and_execution_basis"></a>3.8. Task Grouping, Optionality and Execution Basis</h3>
<div class="paragraph">
<p>A set of tasks intended to achieve a defined goal could be performed sequentially or in parallel, and may include sub-groups of tasks that can performed together. A common situation is to have a task plan intended for sequential (i.e. ordered) execution by the agent, one of whose steps is actually a sub-group of tasks which can be executed in parallel (i.e. in any order).</p>
</div>
<div class="paragraph">
<p>It can also be assumed that some tasks in a task plan may be designated as optional, to be executed 'if needed' or on some other condition being true.</p>
</div>
<div class="paragraph">
<p>The general structure and execution semantics of a task plan therefore includes the notion of sequential or parallel execution of groups of tasks, and also optional execution of some tasks. We can consider the task plan itself as a outer group of tasks for which either sequential or parallel execution can be specified.</p>
</div>
</div>
<div class="sect2">
<h3 id="_decision_pathways"><a class="anchor" href="#_decision_pathways"></a>3.9. Decision Pathways</h3>
<div class="paragraph">
<p>Task plans derived from semi-formal care pathways or guidelines (and potentially ad hoc designed plans) may contain 'decision points', which are of the following logical form:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>decision point</strong>: a step containing a variable assignment of the form <code>$v := expression</code>;</p>
</li>
<li>
<p><strong>subordinate decision paths</strong>: groups of tasks each group of which has attached a variable test of the form <code>$v rel_op value</code>, where <code>rel_op</code> is one of <code>=</code>, <code>/=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code> or <code>&gt;=</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example of decision points is shown below, in an extract from the <a href="https://intermountainhealthcare.org/ext/Dcmnt?ncid=520500199">Intermountain Healthcare Care Process Module (CPM) for Ischemic Stroke Management</a>:</p>
</div>
<div id="decision_pathway_example" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/IHC_stroke_decision_path.png" alt="IHC stroke decision path" width="80%">
</div>
<div class="title">Figure 3. Decision pathway example (Intermountain Healthcare Acute Stroke CPM)</div>
</div>
<div class="paragraph">
<p>In this example, the node containing the text "Further CLASSIFY &#8230;&#8203;" corresponds to a decision point that can be represented as <code>$symptom_onset_time := t</code>, where <code>t</code> is a time entered by a user. The subsequent nodes in the chart can be understood as paths based respectively on the tests <code>$symptom_onset_time &lt; 4.5h</code> and <code>4.5h &lt; $symptom_onset_time &lt; 6h</code>.</p>
</div>
<div class="paragraph">
<p>The ability to include decision pathways enables conditional sections of care pathways to be directly represented within a task plan.</p>
</div>
</div>
<div class="sect2">
<h3 id="_different_types_of_cancellation"><a class="anchor" href="#_different_types_of_cancellation"></a>3.10. Different types of Cancellation</h3>
<div class="paragraph">
<p>Tasks in a plan can be cancelled before being attempted for two types of reasons. One case is when the performer or the system realises the task can&#8217;t be performed (perhaps for lack of resources), and it is cancelled from the plan ahead of time. The other case is when the performer or system realises that the task isn&#8217;t needed, and can be cancelled as unnecessary, or already done by an external agent (e.g. an examination done at a night clinic).</p>
</div>
<div class="paragraph">
<p>In the first, case, the cancellation can be understood as a 'failed' task, whereas in the second, it is equivalent to a successful task. These two flavours of cancellation should be understood by the system so that plan success or failure can be reliably determiined.</p>
</div>
</div>
<div class="sect2">
<h3 id="_changes_and_abandonment"><a class="anchor" href="#_changes_and_abandonment"></a>3.11. Changes and Abandonment</h3>
<div class="paragraph">
<p>Inevitably, some task plans will have to be changed or abandoned partway through due to unexpected changes in the patient situation. The question here is: what should be done with the remaining planned tasks that will not be performed? Should they be marked as 'won&#8217;t do' (with some reason) and committed to the EHR, or should they be deleted prior to being committed to the EHR?</p>
</div>
<div class="paragraph">
<p>It is assumed that the answer will differ according to circumstance and local preference, in other words, that planned tasks that are created are not necessarily written into the EHR, but may initially exist in a separate 'planned tasks' buffer, and are only committed when each task is either performed or explicitly marked as not done, or else included in a list of not-done Actions to be committed to the EHR at a point of plan abandonment.</p>
</div>
<div class="paragraph">
<p>The following kinds of abandonment of tasks should be supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cancellation of an entire task plan that has been posted to the EHR or a 'planning buffer' if one exists;</p>
</li>
<li>
<p>cancellation of a particular task on a list ahead of time, with a reason;</p>
</li>
<li>
<p>marking a task as 'did not perform' after the planned time has passed, with a reason.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_rationalising_unrelated_task_plans"><a class="anchor" href="#_rationalising_unrelated_task_plans"></a>3.12. Rationalising Unrelated Task Plans</h3>
<div class="paragraph">
<p>It is assumed that at any moment there could be multiple task plans extant for <em>different problems and timelines</em> for the same subject of care, e.g. chemotherapy, hypertension, ante-natal care. If naively created, these could clash in time and potentially in terms of other resources. There should therefore be support for being able to efficiently locate all existing task plans and scan their times, states and resources. This aids avoiding clashes and also finding opportunities for rationalising and bundling tasks e.g. grouping multiple tasks into a single visit, taking bloods require by two protocols at the same sitting etc.</p>
</div>
<div class="paragraph">
<p>It should be possible to process multiple task plans as part of interfacing with or constructing a 'patient diary', i.e. rationalised list of all work to be done involving the patient.</p>
</div>
</div>
<div class="sect2">
<h3 id="_support_process_analytics"><a class="anchor" href="#_support_process_analytics"></a>3.13. Support Process Analytics</h3>
<div class="paragraph">
<p>As tasks are performed and signed off on the list of posted planned tasks, there will generally be differences between Actions actually performed and the tasks on the list. Differences may include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>time of execution - this will almost always be different, even if only by seconds;</p>
</li>
<li>
<p>performer - a task intended to be performed by a specific type of actor (say a nurse) might be performed by another (say the consultant);</p>
</li>
<li>
<p>any other modifiable detail of the order, e.g. medication dose in bedside care situations.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These differences are obtainable from the EHR since both planned tasks and performed Actions will appear, providing a data resource for analysing business process, order compliance, reasons for deviation and so on.</p>
</div>
</div>
<div class="sect2">
<h3 id="_support_for_costing_and_billing_information"><a class="anchor" href="#_support_for_costing_and_billing_information"></a>3.14. Support for Costing and Billing Information</h3>
<div class="paragraph">
<p>It should be possible to record internal costing data against task plans as a whole, and also individual tasks. Additionally, it should be possible to attach external billing information to tasks and task plans. Costing information might be attached to each task, such as consumption of inventory items, time and other resources. Billing information is typically more coarse-grained and reported using nationally agreed code systems, e.g. ICD10 or similar.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design_principles"><a class="anchor" href="#_design_principles"></a>4. Design Principles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sections describe the design key ideas used in the Task Planning model defined in this specification.</p>
</div>
<div class="sect2">
<h3 id="_computational_basis"><a class="anchor" href="#_computational_basis"></a>4.1. Computational Basis</h3>
<div class="paragraph">
<p>A basic choice in the architecture presented here is that it is executable in the sense of all elements used in creating Plan definitions have an objective computational meaning and can be executed according to defined semantics. The intention is that developing task plans is a kind of high level programming, performed using dedicated tools, and whose resulting artefacts are executable. This does not of course mean that the resulting system performs the work (although it may indeed perform some particular Tasks). Instead, it means that the resulting executable artefacts and application(s) when executed in a real world work environment that includes human and other actors, will convert disparate workers with weak communication and coordination into an efficient, integrated, whole.</p>
</div>
<div class="paragraph">
<p>This follows the YAWL (<a href="#Hofstede_van_der_Aalst_2009">[Hofstede_van_der_Aalst_2009]</a>) rather than BPMN approach, such that no Plan defined according to this specification has ambiguous meaning.</p>
</div>
</div>
<div class="sect2">
<h3 id="_computational_context"><a class="anchor" href="#_computational_context"></a>4.2. Computational Context</h3>
<div class="paragraph">
<p>This specification describes the models and semantics for task plans and their execution by a notional openEHR Task Planning execution engine ('TP engine'). This is assumed to operate in a server computing environment in which other systems exist with which the TP engine communicates. A key system is the openEHR EHR system, via which openEHR EHRs are accessible to the TP Engine.</p>
</div>
<div class="paragraph">
<p>Outside of the environment exist other organisations with which TP engine communicates by generic means (ultimately, email, phone calls, etc), mediated by an appropriate communications / notification system within the environment.</p>
</div>
<div class="paragraph">
<p>Users who act as performers of tasks are connected to the engine via applications that communicate to the TP engine via the API of the TP Engine. These applications may be dedicated to Task Planning or a combined openEHR application context containing Task Planning components or forms. Users who act as plan designers are connected to a task planning designer system via a dedicated designer application.</p>
</div>
<div class="paragraph">
<p>The overall context is shown below.</p>
</div>
<div id="computational_environment" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/computational_environment.svg" alt="computational environment" width="80%">
</div>
<div class="title">Figure 4. Computational Environment</div>
</div>
<div class="paragraph">
<p>One of the major differences between the openEHR Task Planning architecture compared to other workflow architectures is that it can rely on shared access to persistent patient EHRs as the location in which context data can be read (e.g. patient variables) and in which records of performed tasks are ultimately stored, in the form of openEHR Compositions containing Entries, in the usual way.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conceptual_basics"><a class="anchor" href="#_conceptual_basics"></a>4.3. Conceptual Basics</h3>
<div class="sect3">
<h4 id="_work_plan"><a class="anchor" href="#_work_plan"></a>4.3.1. Work Plan</h4>
<div class="paragraph">
<p>The top-level formal concept defined is the <em>Work Plan</em>, which consists of one or more <em>Task Plans</em>. The Work Plan is a definition of work to be performed by one or more workers in order to achieve a defined goal with respect to a subject of care. Goals are often defined by published guidelines or care pathways, and the overall structure of work defined within a Work Plan and its constituent Task Plans may well be structured according to such publications.</p>
</div>
<div class="paragraph">
<p>Within a Work Plan, each included Task Plan is a definition of work to be performed in a single work <em>context</em>, by a 'principal performer' and possibly other participants. Multiple Task Plans occur for two reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>distinct performers working in different contexts, across which managed <em>handoffs</em> are required;</p>
</li>
<li>
<p><em>sub-plans</em> subordinate to a parent Task Plan, to be performed by the same worker.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sub-plans occur to allow re-use of Plans for smaller pieces of work and also to provide a means of controlling the detail level of work differently for performers of different experience levels.</p>
</div>
<div class="paragraph">
<p>The entirety of the Work Plan definition is assumed to be executable within a single computational context, in which methods of notification and worker communication are available, enabling the state of progress of the work defined in the Plan to be fully represented. A Work Plan will often be limited to a single enterprise, but this need not be the case, as long as all of its Task Plans communicate within the same Plan execution context.</p>
</div>
<div class="paragraph">
<p>More typically, some jobs required by a Work Plan are performed in another organisational context entirely, and from the point of view of the original Work Plan, the second organisation is seen as a 'black box' to which a request can be made and a result might be returned. A common example is a hospital clinical workflow that at some point requires a laboratory result, which is processed by an external organisation. These situations are handled by an 'external request' Task type.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_plan"><a class="anchor" href="#_task_plan"></a>4.3.2. Task Plan</h4>
<div class="paragraph">
<p>The actual definition of work to be done, i.e. Tasks, occurs within each Task Plan. The most basic structuring notion required is that of a sequential list of Tasks, enabling the representation of the set of steps in a typical linear workflow such as making tea or cleaning a wound.</p>
</div>
<div class="paragraph">
<p>However, in the real world, almost every job can be sub-divided into smaller pieces of work in a fractal nature. This simple fact requires that the general structure of Tasks is actually a hierarchy, within which sequential Task lists occur commonly (and will be the top-level structure in simple cases). The formal construct provided for this is the Task Group, which may contain Tasks and more Task Groups.</p>
</div>
<div class="paragraph">
<p>With hierarchy and sequential execution semantics, a great many types of work can be represented. However, some sets of Tasks can be performed without regard to order - i.e. in parallel. The model defined here therefore includes an execution type indicator at the Task Group level, so that manner of performing the work items within a Task Group - with or without regard to order - can be indicated. In purely sequential Task Plans, there is only one <em>execution path</em>. Parallel execution enables the possibility of multiple execution paths during a Plan execution.</p>
</div>
<div class="paragraph">
<p>The power of the Task Group / Task structure can be significantly augmented in another dimension with the addition of conditions, to create <em>conditional structures</em>. These can be used to represent a variety of logical choice structures, equivalent to the following programming concepts:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>if/elseif/else</strong>: a standard multi-branch logic chain with any condition on each branch, evaluated in order;</p>
</li>
<li>
<p><strong>switch</strong>: a standard multi-way logic structure based on a single condition and branches for multiple value sub-ranges;</p>
</li>
<li>
<p><strong>rule-set</strong>: a typical chained event-driven rule structure whereby each branch is defined to fire on reception of a specific kind of event.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The leaf level constituents of a Task Plan are Tasks of various kinds, including inline-defined Tasks; requests to other contexts within the same Work Plan; requests to external contexts and requests to IT systems and services.</p>
</div>
<div class="paragraph">
<p>The Task concept defined in this specification is relatively straightforward in the abstract: it corresponds to a separately performable <em>item of work</em> for a <em>performer</em> to execute. A Task within a Plan has a lifecycle whose states indicate whether it is planned, available, complete etc.</p>
</div>
<div class="paragraph">
<p>In business terms, a Task typically corresponds to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>an explicit level of clinical responsibility, e.g. nurse administration of a drug, single observation of patient vital sign etc;</p>
</li>
<li>
<p>an explicit level of re-imbursement / billing;</p>
</li>
<li>
<p>granularity of check-list and protocol single items, designed to be signed off as performed;</p>
</li>
<li>
<p>a particular planned time of execution.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We can summarise the above-described structure in reverse:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Task</strong>: a separately performable unit of planned work at any level of granularity; may be defined inline or</p>
</li>
<li>
<p><strong>Task Group</strong>: a group of Tasks and/or more Task Groups within a Task Plan that are to be executed on the same basis, e.g. sequential, parallel.</p>
</li>
<li>
<p><strong>conditional Group types</strong>: special kinds of Task Group that enable conditional logic structures to be represented in a Plan.</p>
</li>
<li>
<p><strong>Task Plan</strong>: a logical set of Tasks for a single performer context to achieve a defined result within a larger plan.</p>
</li>
<li>
<p><strong>Work Plan</strong>: top-level structure containing related Task Plans needed to implement an intended outcome for a subject of care.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_graph_structure"><a class="anchor" href="#_graph_structure"></a>4.3.3. Graph Structure</h4>
<div class="paragraph">
<p>The Task Group construct replaces the node references found in traditional workflow formalisms such as BPMN, and defines the static graph structure of the 'normal flow' of a Task Plan <em>by implication</em>. Only exceptions to the normal flow are represented with explicit node references.</p>
</div>
<div class="paragraph">
<p>This provides significantly more power than an explicit graph structure for the normal flow, since Task Groups can have <em>rules</em> attached to them indicating which members should be executed and when, rather than relying on explicit links. The sequential / parallel indicator is one such simple rule. Additional rules could be added, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>at least N members must complete for group to complete</p>
</li>
<li>
<p>exit group on first succeeding task</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These more sophisticated rules are represented in a generic way, with the Task Plan engine assumed to implement the underlying mechanics.</p>
</div>
</div>
<div class="sect3">
<h4 id="_work_context"><a class="anchor" href="#_work_context"></a>4.3.4. Work Context</h4>
<div class="paragraph">
<p>A fundamental concept in this specification is that of <em>work context</em>, which is the factor that distinguishes one Task Plan from another, i.e. one Plan corresponds to Tasks to be performed in a single work context. Work context is defined as a single, <em>contiguous cognitive flow</em> in the real world (i.e. not in the computational representation, which must always be considered an approximation updated in snapshot fashion) in which work can be performed <em>seamlessly</em> by one or more performers on a single subject. Concretely, this means that the flow of cognitive activity is unbroken during the work. This may extend over time and even distinct physical spaces, such as in the case of tele-consultations. Normally a single cognitive flow corresponds to a single actor, usually a person, but this is not always the case. More than one person may be involved in performing work on the same subject, but essentially working as one, and relying on real-time verbal or other communication to achieve the effect of a <em>single mind</em>.</p>
</div>
<div class="paragraph">
<p>Continuous knowledge of the work, and continuous real-time communication with oneself ('train of thought') or directly among multiple performers is what characterises a given context. A different context is one with different cognitive actors, and with which communications is performed by notifications at certain time checkpoints, typically just the beginning and end.</p>
</div>
<div class="paragraph">
<p>Since parallelism is possible within a single Plan, a performer may be working on more than one thing at once, within the same context. In other words, a work context (and a Task Plan in execution) may contain multiple execution paths at a point in time.</p>
</div>
</div>
<div class="sect3">
<h4 id="_context_switching_and_forking"><a class="anchor" href="#_context_switching_and_forking"></a>4.3.5. Context Switching and Forking</h4>
<div class="paragraph">
<p>If work has to be stopped within one context and passed to a different work context, a <em>context switch</em> is required, and the first worker or team will wait for a response. If the context switch is within the same Work Plan, is termed a <em>handoff</em>, which entails switching Task Plans. A context change is also required to request work from an external environment. A second kind of change of control is a <em>context fork</em>, whereby the current performer signals to another context to start doing some work, but continues doing his own work.</p>
</div>
<div class="paragraph">
<p>A context switch is commonly known as 'block and wait' or 'synchronous processing', while the context fork is known as 'asynchronous' or 'parallel' processing.</p>
</div>
<div class="paragraph">
<p>Work context is clearly maintained during a 'working session' during which the work is done by one or more performers. But if the work extends over hours or days, as in the case of chemotherapy, worker shifts will end and the work will be taken up by new workers, or perhaps the same workers on the next day. The Task Planning model does not consider this kind of <em>handoff</em> to be a context switch, since it is assumed that the Task Planning runtime system maintains all relevant context information, available for use by new workers. All that is required to maintain the context is for de-allocation and re-allocation of the work to performers.</p>
</div>
<div class="paragraph">
<p>The following diagram shows the taxonomy of task types.</p>
</div>
<div id="task_taxonomy" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_taxonomy.svg" alt="task taxonomy" width="50%">
</div>
<div class="title">Figure 5. Task Taxonomy</div>
</div>
</div>
<div class="sect3">
<h4 id="_principal_performer"><a class="anchor" href="#_principal_performer"></a>4.3.6. Principal Performer</h4>
<div class="paragraph">
<p>Following the definition of context above, a Task Plan is defined to have a <em>principle performer</em>, that is to say, a single logical executing actor. This is often a single person (or a device or possibly a software service), but might equally be a group of personnel, e.g. ward nurses, who execute the steps of a Task Plan during and across shift boundaries (wound dressing, turning patients, IV maintenance etc). In these cases the separate individuals constitute a 'single mind' as described above, with respect to the subject of care and the work, and their communication is not directly represented within the Task Plan.</p>
</div>
<div class="paragraph">
<p>In addition to the principal performer, other participations can be specified for any contained Task in a Plan. This allows the Plan to indicate where specific members working in a single context should be responsible for specific individual Tasks. However it is assumed that the principal performer is <em>responsible</em> for all actions, and is also the notifier of action completions and cancellations.</p>
</div>
<div class="paragraph">
<p>The principal performer and other participants are specified in the Plan in terms of professional roles, and optionally a specific agent. This might in some cases be the patient.</p>
</div>
<div class="paragraph">
<p>Where an overall work plan requires separate actors who do not operate within the same work context, e.g. the various specialists and other professionals who perform different tasks with respect to an acute stroke patient, separate Task Plans each with their own principal performers are required. In this situation, coordination between the various actors is achieved by context switching and notification.</p>
</div>
<div class="paragraph">
<p>During the execution of a Task Plan, at any given time, a particular physical actor must be <em>assigned</em> as the principal performer, in order for the Plan to proceed. This assignment will change over time for long-running Plans, due to shift changes, out of hours contacts, worker vacations and so on. In this model, worker changes are handled by runtime <em>allocation</em> and are not treated as context switches. The allocation concept is described in more detail below.</p>
</div>
</div>
<div class="sect3">
<h4 id="time_and_wait_states"><a class="anchor" href="#time_and_wait_states"></a>4.3.7. Time and Wait States</h4>
<div class="paragraph">
<p>Many tasks in the real world can only be performed when certain events occur or conditions become true. This model treats such conditions as wait states, based on events or time.</p>
</div>
<div class="paragraph">
<p>Time is understood in three possible ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>as a <em>relative offset</em> from the start of the Plan timeline, when it is activated;</p>
</li>
<li>
<p>as an <em>absolute time</em> as marked on a calendar;</p>
</li>
<li>
<p>as the <em>time of an event</em>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first two are converted to events by the execution system internal clock reaching markers on the timeline or calendar. For event-based times, the kinds of events recognised include the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>timer event</em>: an event caused by a timer that expires;</p>
</li>
<li>
<p><em>state trigger</em>: a condition based on one or more watched variables available from the computation environment, including subject variables (sex, vital signs, etc) and variables relating to clinical processes, e.g. 'time since emergency admission'.</p>
</li>
<li>
<p><em>task transition</em>: an event generated by the state transition of a Task during execution so far, e.g. the previous Task completing;</p>
</li>
<li>
<p><em>callback notification</em>: an event generated by a notification received on completion of a Task dispatched to a different Plan or an external system;</p>
</li>
<li>
<p><em>system notification</em>: an external event is notified to the system by a user, e.g. receipt of a phone call.</p>
</li>
<li>
<p><em>manual notification</em>: an external event is signalled manually to the system by a user, e.g. receipt of a phone call.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Tasks can be defined to wait on either one or more events.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_levels_of_definition_and_representation"><a class="anchor" href="#_levels_of_definition_and_representation"></a>4.4. Levels of Definition and Representation</h3>
<div class="paragraph">
<p>Task Plans are defined, refined and used in various phases in time. A number of related technical representations are used, each appropriate to its phase.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 18.1818%;">
<col style="width: 27.2727%;">
<col style="width: 54.5455%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Phase</th>
<th class="tableblock halign-left valign-top">Representation</th>
<th class="tableblock halign-left valign-top">Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Design time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Definition model</strong><br>
                          (archetypes and templates<br>
                          of definition classes)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">At the <em>model</em> level, a Work Plan and its constituent Task Plans are represented in the form of openEHR
                                                      templated archetype(s) based on the Task Planning definition model of this specification.
</p><p class="tableblock">                                                      Multiple layers of modelling may be used to represent a range of Plan Templates from the more
                                                      general to the specific, and then templated to define a <em>near subject-specific Plan</em>. For example
                                                      a general model may be built to represent a 'chemotherapy' Plan; a specalised form of this may
                                                      represent R-CHOP protocols; an even more specialised one may represent a particular institution&#8217;s
                                                      form of this protocol.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clinical time -<br>
 planning</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Instantiated definition</strong><br>
                         (instances of definition<br>
                          classes)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When a Work Plan model is <em>used</em>, it is created as instances of the Task Planning definition
                                                      model (i.e. in the technical class/instance sense), and the result is understood as a <em>concrete</em> definition
                                                      of the Task Plan to be used in a specific situation for a specific subject (i.e. patient).
</p><p class="tableblock">                                                      When the instantiation is performed, the model-user may provide values for particular parts of the model,
                                                      such as medication dosages, that correspond to the particular patient. They may also make other limited adjustments that are compatible with the archetypes and template.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clinical time -<br>
 plan execution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Materialised definition</strong><br>
                        (instances of<br>
                         materialised classes,<br>
                         persisted over sessions)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Close to Plan execution time, a Work Plan definition will be 'materialised', i.e. instantiated into a form that                                can be used for execution and tracking of the Plan. At the point of materialisation, the definition model must
                                                      be published and persisted, guaranteeing the its availability as the reference model for its materialised expressions. It may be materialised any number of times, corresponding to the distinct number of instances of use required. Each materialisation
</p><p class="tableblock">                                                      In the materialised form, repeatable sections of the definition are 'unfolded' into literal sections, for as many repetitions as required by the relevant performer(s). Accordingly, parts of the materialised expression of a Plan may have an N:1 relationship with the original definition form.
</p><p class="tableblock">                                                      Unreachable decision paths may be removed, and where possible decision nodes, simplifying the materialised form
                                                      compared to the definition form.
</p><p class="tableblock">                                                      The materialised form has its own class model containing additional data items to enable run-time tracking of the Plan as it is performed. During execution time, various kinds of deletions and modifications to the materialised representation are possible, corresponding to changes in plan that respond to unexpected events.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clinical time -<br>
 task execution</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Runtime instantiation</strong><br>
                        (instances of<br>
                         materialised classes,<br>
                         during session)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Since a Plan execution may run over many hours, days or longer, the materialised expression will in general                                     correspond to something larger than the literal in-memory instantiation of (parts of) the Plan required during                                 any given user-application the session during which some or all of the Task Plan might be performed. The part                                   of the plan currently being displayed, performed, tracked etc, is known here as the 'run-time instantiation',                                   and consists of a subset of the total materialised form instances.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In this scheme, archetype- and template-based modelling is used as much as possible in order to create layers of re-usable models that are progressively more specialised, until close-to-patient models are achieved, typically as templates. This enables the power of the archetype modelling formalism, including specialisation and composition to be used freely, in a similar manner to an object-oriented programming environment.</p>
</div>
<div class="sect3">
<h4 id="_separation_of_definition_and_execution"><a class="anchor" href="#_separation_of_definition_and_execution"></a>4.4.1. Separation of Definition and Execution</h4>
<div class="paragraph">
<p>According to the above, the concrete definition of a Work Plan is constructed in the 'planning phase' of clinical time, to define work <em>to be done</em> in the near future, by the planner and/or others. As the work is performed, the results are documented with openEHR Entries, such as Actions and Observations. During the execution of the plan there is usually a need to track the progress of the work in terms of Task completions, cancellations, failures, abandonment and so on.</p>
</div>
<div class="paragraph">
<p>As per the above table, the model defined in this specification separates the definition of Work Plans from their executions. This is achieved via <code>definition</code> and <code>materialised</code> parts of the model, corresponding to the concrete definition and materialised phases described above. Instances of the former are used to represent the definition of a plan, and would accordingly be used by a tools designed for that purpose. Similarly, run-time execution tools would be built using the <code>materialised</code> part of the model, as well as the <code>definition</code> part, since the latter is referred to by the former.</p>
</div>
<div class="paragraph">
<p>It is the materialised expression of a Plan that is used to record all Plan-related actions by Task performers. This state may be persisted for plans whose execution takes place over more than a user-application session.</p>
</div>
<div class="paragraph">
<p>The history of actions on the Plan can be understood as a set of <em>transactions</em> over time, and the model provides a third <code>history</code> part that can be used to efficiently represent this history, allowing it to be permanently recorded.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_execution_concepts"><a class="anchor" href="#_execution_concepts"></a>4.5. Execution Concepts</h3>
<div class="sect3">
<h4 id="_plan_execution_lifecycle"><a class="anchor" href="#_plan_execution_lifecycle"></a>4.5.1. Plan Execution Lifecycle</h4>
<div class="paragraph">
<p>A Work Plan definition can be executed by being materialised. The model recognises three states in the execution phase, as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>materialised</code> state: after creation of the materialised Plan, the Plan may be modified by its user(s), and pre-allocations done of performers.</p>
</li>
<li>
<p><code>activated</code> state: the materialised Plan is <em>activated</em> when the users want to proceed. Connections must be established between the Plan execution context and various channels or APIs via which performer allocation and communication can be achieved. Activation establishes the zero point of the execution clock, and will cause performer allocations and generate various kinds of notifications as time moves forward. During the work, Tasks become <em>available</em> as earlier Tasks are completed or cancelled. When a Task is available to be done, the performer has various options, including doing the work, cancelling the Task as not needed, completing the Task, aborting it, and abandoning the entire Plan.</p>
</li>
<li>
<p><code>terminated</code> state: A Plan terminates when a path taken through the materialised Task graph terminates, either due to finishing, or due to abandonment at an intermediate Task. The Plan as a whole returns a termination status of success or fail, which may be used to control behaviour if it is part of a chain in which a context switch follows termination.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_allocation"><a class="anchor" href="#_allocation"></a>4.5.2. Allocation</h4>
<div class="paragraph">
<p>Since a Task in a Task Plan being executed at runtime represents the Plan execution system&#8217;s knowledge of some work being performed in the real world, a way to connect the Plan as it is in the system (e.g. as shown on a UI application, or via notifications such as instant messaging) to the real-world actors performing it is needed. Following YAWL, the architecture described here treats <em>allocation</em> of work to a performer as a formal activity during Plan execution.</p>
</div>
<div class="paragraph">
<p>Conceptually, worker allocation is understood in the following way. Firstly, it is assumed that Tasks can be allocated to two types of worker resource:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>individuals, specified in the Plan definition in terms of role and/or function within <em>principal performer</em> and <em>other participations</em> e.g. 'cardiologist';</p>
</li>
<li>
<p>a worker <em>pool</em>, i.e. group of equivalent workers, e.g. nurses on a particular ward; here, any one of the workers can perform a given Task, and the workers may swap over time.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Secondly, at runtime, the actual worker will be resolved at execution time as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the Plan or Task is <em>assigned</em> to a real individual or worker pool;</p>
</li>
<li>
<p>an appropriate worker <em>claims</em> a Plan (if Plans are posted somewhere, awaiting workers) or <em>accepts</em> the Task (if Plan invitations are sent to individuals).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It remains the business of the organisation and also the Task Planning engine to resolve how these choices are made.</p>
</div>
<div class="paragraph">
<p>As per YAWL, more sophisticated implementations of Task Planning may offer numerous allocation strategies, such as first-available, quickest-to-complete, least-frequently-used and so on.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_lifecycle"><a class="anchor" href="#_task_lifecycle"></a>4.5.3. Task Lifecycle</h4>
<div class="paragraph">
<p>Every Task in a Plan has a lifecycle described by a state machine. The states represent the state of a real world item of work, <em>as known by the Plan execution system</em>; setting them is entirely reliant on the system receiving input from performers. The successful execution path is through the states <code>planned</code> &#8658; <code>available</code> &#8658; <code>completed</code>, with other terminal states <code>cancelled</code> and <code>aborted</code> available for cases where a Task is cancelled and aborted respectively. Here, <code>cancelled</code> means 'not needed', i.e. the principal performer determined Task could be cancelled before or during execution, without compromising the Plan. Conversely, the <code>aborted</code> state indicates that the performer cannot do or complete the Task, or the rest of the Plan. Thus, <code>aborted</code> for a Task means abandonment of the current Plan.</p>
</div>
<div class="paragraph">
<p>From the viewpoint of Plan execution, the final state of a Task execution determines whether the Plan remaints in the <code>active</code> state, or whether it enters the <code>terminated</code> state. If the Task terminates with <code>completed</code> or <code>cancelled</code> state, it is considered to have <em>succeeded</em>, and the Plan remains <code>active</code>. If the Task is <code>aborted</code>, it is considered as <em>failed</em>, and the Plan terminates with a failure status.</p>
</div>
<div class="paragraph">
<p>A special transition <code><em>override</em></code> is used to force a Task to into the <code>available</code> state; this represents a performer explicitly overriding preconditions or subject preconditions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_availability"><a class="anchor" href="#_availability"></a>4.5.4. Availability</h4>
<div class="paragraph">
<p>A Task becomes <em>available</em> to perform when three kinds of condition are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Execution control flow reaches the Task;</p>
</li>
<li>
<p>External precondition, if any, is met;</p>
</li>
<li>
<p>Subject preconditions if any, are met.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Control flow reaches a Task in a Plan when either preceding Tasks have been performed (local control flow) or a previously dispatched external Task completes, whose restart location in the current Plan is the current Task.</p>
</div>
<div class="paragraph">
<p>External preconditions (described above) are met when a point in clock time is reached or an event notification is received.</p>
</div>
<div class="paragraph">
<p>If the control flow and external preconditions are met, a Task will still not be available until any subject-related preconditions are satisfied. These are conditions that may be specified to ensure the Task is only performed if it is clinically appropriate and safe to do so, such as 'systolic blood pressure &lt; 160 mmHg'.</p>
</div>
<div class="paragraph">
<p>Since the Task Plan cannot presume to have perfect knowledge of the real world situation, the performer is always allowed to override the external and subject pre-conditions, due to better knowledge. In such cases, the control flow requirement still holds - since this can already be 'overridden' by the performing cancelling preceding Tasks where appropriate.</p>
</div>
<div class="paragraph">
<p>When a Task does become available for execution, nothing will happen until a performer is allocated to do it. When an available worker is allocated, the Task may be commenced, and further life-cycle states can be reached, i.e. <code>completed</code>, <code>aborted</code> etc.</p>
</div>
<div class="paragraph">
<p>The following diagram illustrates these concepts.</p>
</div>
<div id="task_availability" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_availability.svg" alt="task availability" width="60%">
</div>
<div class="title">Figure 6. Task Availability</div>
</div>
</div>
<div class="sect3">
<h4 id="_adaptive_modification_and_exception_handling"><a class="anchor" href="#_adaptive_modification_and_exception_handling"></a>4.5.5. Adaptive Modification and Exception-handling</h4>
<div class="paragraph">
<p>One of the major challenges for any workflow system is that of being able to handle unplanned exceptions at runtime and adapt. The Task Planning model makes a key assumption that simplifies deviations at runtime, which is that the human (or other) performer always knows best. This means that Tasks posted to be done by the system are always advisory, and their details (such as time) are advisory. Accordingly, the model provides the following support for execution-time adaption:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>logical deletion</em>: Tasks can be skipped by two types of cancellation in the lifecycle: <code>cancelled</code> (not needed) and <code>aborted</code> (abandon plan); if <code>cancelled</code> is used, this has the benign effect of skipping past a Task;</p>
</li>
<li>
<p><em>logical addition</em>: work items that are not represented as Tasks in a Task Plan can always be done, such as making extra patient observations or performing unplanned patient actions (e.g. refit a catheter, change a dressing); in openEHR they will always be recorded in the normal manner via Observation and Action Entries;</p>
</li>
<li>
<p><em>overrides</em>: various aspects of a Plan definition can be overridden at runtime, such as Task execution time and subject preconditions (such as BP &lt; 160 mm[Hg]). Override is represented in the system as an alternative lifecycle transition that puts a Task into the <code>available</code> state even if not all conditions have been met for availability.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_relationship_of_task_plans_with_existing_openehr_entry_types"><a class="anchor" href="#_relationship_of_task_plans_with_existing_openehr_entry_types"></a>4.6. Relationship of Task Plans with existing openEHR Entry Types</h3>
<div class="paragraph">
<p>Within the phases of clinical planning and execution time described above, the Task Plan is not the only information artefact that may be created. The existing openEHR model <code>ENTRY</code> types provide the standard way to represent orders, via <code>INSTRUCTION</code>, and order-related performed activities, via <code>ACTION</code>. In addition, the usual <code>OBSERVATION</code>, <code>EVALUATION</code> and <code>ADMIN_ENTRY</code> types are used to record observations, diagnoses, and administrative events as they occur in clinical time. In abstract terms, Instructions may be understood as formal statements of 'what is to be done', and the other types, as records of 'what was done'. However, Instructions are most suited to concise representations of orderable actions, particularly medication administration, but not for general purpose detailed plans of events. The addition of Task Plans provides a way to specify such plans more flexibly, and in a step-by-step manner.</p>
</div>
<div class="paragraph">
<p>Both Instructions and Plans may be fully or partially defined by care pathways and/or guidelines, equally, they may be ad hoc developed in the 'old school medicine' sense. The following figure illustrates the relationships among care pathways, the existing openEHR Entry types and Task Plans.</p>
</div>
<div id="planning_artefact_relationships" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/planning_artefacts.svg" alt="planning artefacts" width="60%">
</div>
<div class="title">Figure 7. openEHR Planning Artefact Relationships</div>
</div>
<div class="paragraph">
<p>In simple cases, a Task Plan may just be the list of Tasks to fulfill one order, i.e. a single <code>INSTRUCTION</code> prescribing a course of antibiotics. The general case however is that the Task Plan corresponds to a clinical goal which implicates multiple orders, such as the CHOP chemotherapy mentioned above.</p>
</div>
<div class="paragraph">
<p>Consequently, <em>not every Task in a Task Plan is associated with an order</em>, illustrated by the yellow Task objects in the above figure. While a typical case is that a Task corresponds to an openEHR <code>ACTION</code> that has not yet been recorded (and which normally has a driving <code>INSTRUCTION</code>), it may also correspond to an <code>ACTION</code> that has no <code>INSTRUCTION</code> or indeed an <code>OBSERVATION</code> or possibly an <code>EVALUATION</code> (perhaps some kind of check during a procedure). Indeed, there is also no reason why a Task Plan cannot consist of Tasks that define administrative work and would be documented with openEHR <code>ADMIN_ENTRYs</code>.</p>
</div>
<div class="paragraph">
<p>We can infer from the above that the main driver of a Task Plan isn&#8217;t in general an order, but a care plan or guideline that usually includes orders, or else plain old ad hoc planning.</p>
</div>
<div class="paragraph">
<p>A high-level view of how clinical work generates openEHR information can be visualised conceptually with a modified version of the <a href="/releases/RM/latest/ehr.html#_information_ontology">Clinical Investigator process diagram</a> as follows:</p>
</div>
<div id="clinical_process_planning" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/clinical_process_planning.svg" alt="clinical process planning" width="70%">
</div>
<div class="title">Figure 8. Clinical Investigator Process with Planning</div>
</div>
<div class="paragraph">
<p>According to this scheme, <code>TASK_PLAN</code> and <code>TASK</code> are new types of information that can be committed to the EHR.</p>
</div>
</div>
<div class="sect2">
<h3 id="_order_semantics_versus_plan_semantics"><a class="anchor" href="#_order_semantics_versus_plan_semantics"></a>4.7. Order Semantics versus Plan Semantics</h3>
<div class="paragraph">
<p>Despite the above explanation, the difference between Instructions (as defined in openEHR) and Task Plans may not be completely clear. However, there is a key difference, which is the semantic level at which the two are expressed. A typical order, represented in an openEHR <code>INSTRUCTION</code> has an <em>algorithmic</em> form, such as  "Amoxicillin 3 times a day, orally, for 7 days". Although healthcare professionals do not typically think about it, this expression is in fact a small program that is mentally <em>interpreted</em> to produce resultant actions such as giving one tablet at 9:15 am, one at lunch and so on.</p>
</div>
<div class="paragraph">
<p>We can think of a Task Plan for ordered actions as the interpreted form of the original order statement(s), that is to say, a completely 'unfolded' list of single Tasks in time such as 'give 1 Amoxycillin oral tab at lunch'. This is a form suitable for displaying on work lists, checking off and ensuring no mistakes are made. When a Task is performed, it will still give rise to the appropriate openEHR Entry recording the details, such as 'gave 1 Amoxycillin tab at 13:37'.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_task_planning_model_overview"><a class="anchor" href="#_task_planning_model_overview"></a>5. Task Planning Model Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following UML diagram shows the <code>rm.task_planning</code> package in overview form, showing the constituent packages, <code>definition</code>, <code>materialised</code>, and <code>history</code>. The first of these packages contains the class model for the <em>definition model</em> expression of a Work Plan, i.e. the workflow structure intentionally designed to achive a goal.</p>
</div>
<div class="paragraph">
<p>The <code>materialised</code> package contains the class model of the amterialised form of the definition, which is created prior to its use in execution. The materialised model is presented in outline only, as a way of indicating some of the general features of the materialised form, and is not intended to be normative. (At some point in the future, a skeleton materialised model may be declared normative, based on implementation experience).</p>
</div>
<div class="paragraph">
<p>The <code>history</code> package contains the model of audit events that have occurred to each Task Plan in a Work Plan during execution.</p>
</div>
<div id="proc_task_planning_overview" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/PROC-task_planning-overview.svg" alt="PROC task planning overview">
</div>
<div class="title">Figure 9. rm.task_planning package overview</div>
</div>
<div class="paragraph">
<p>The following instance diagram illustrates the relationships among these models for one Task Plan. On the left is a Task Plan definition, consisting of a Task Group and various Defined Actions. Each of these Tasks may have a prototype Entry attached, which represents the intended data of an Action, Observation or other Entry that the Task defines.</p>
</div>
<div class="paragraph">
<p>In the centre is a materialised Task Plan, which is an execution-time structure used to maintain state for an executing Plan. This structure allows the representation of all state to do with Plan execution, including instances of variables, timing information and so on. The materialised structure is not owned by the definition structure, but rather is created at run time, and points back to its definition via various references. The right hand side of the diagram shows a part of the materialised structure that is currently instantiated within a user-application session.</p>
</div>
<div class="paragraph">
<p>At the lower right is a Task Plan Execution History, which is a record of all events that were made during the execution of the original Task Plan.</p>
</div>
<div id="task_planning_overview" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_planning_overview.svg" alt="task planning overview" width="65%">
</div>
<div class="title">Figure 10. Task planning overview</div>
</div>
<div class="sect2">
<h3 id="_identification_and_referencing"><a class="anchor" href="#_identification_and_referencing"></a>5.1. Identification and Referencing</h3>
<div class="paragraph">
<p>With a Task Plan, various elements need to be referenceable at runtime. Tasks and Task Groups are identified via the <code><em>uid</em></code> attribute inherited from <code>LOCATABLE</code> via <code>PLAN_ITEM</code>, and which is populated with a Guid. References to a Task or Task Group are thus achieved with <code>UID_BASED_ID</code> instances carrying a Guid.</p>
</div>
</div>
<div class="sect2">
<h3 id="_specifying_time"><a class="anchor" href="#_specifying_time"></a>5.2. Specifying Time</h3>
<div class="paragraph">
<p>Generic classes for specifying time formally and in customary form such as 'afternoon' are provided for use in the main model. These are shown bottom right of the above UML diagram: <code>TIME_SPECIFIER</code> and descendants.</p>
</div>
</div>
<div class="sect2">
<h3 id="_plan_data_context"><a class="anchor" href="#_plan_data_context"></a>5.3. Plan Data Context</h3>
<div class="paragraph">
<p>A Task Plan may contain logical <em>variable references</em> and <em>expressions</em>, which are used in various ways within the Plan structure. These are globally collated and tracked at runtime at the Work Plan level, i.e. in common to all Task Plans. To facilitate their definition and computable use, they are fully typed. The following UML diagram illustrates.</p>
</div>
<div id="proc_task_planning_context" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/PROC-task_planning.definition-context.svg" alt="PROC task planning.definition context">
</div>
<div class="title">Figure 11. Task planning - context values</div>
</div>
<div class="paragraph">
<p>An instance of <code>PLAN_DATA_CONTEXT</code> represents the full set of tracked variables and expressions used in a Work Plan, which are either  atomic <em>variables</em> or <em>expressions</em> that reference such variables, respectively represented by the classes <code>CONTEXT_VARIABLE&lt;T&gt;</code> and <code>CONTEXT_EXPRESSION&lt;T&gt;</code>. These classes and the abstract parent are generic, with the parameter being the formal type of variable or expression.</p>
</div>
<div class="paragraph">
<p>Variables are typically related to subject state, such as patient vital signs, key demographic characteristics and so on, or the clinical care process, such as the 'time since stroke event', while expressions are used to represent logical expressions such as <code>systolic_bp - diastolic_bp</code>, where <code>systolic_bp</code> and <code>diastolic_bp</code> are defined as single variables. The syntax of expressions is defined by the <a href="/releases/BASE/latest/expression.html">openEHR Expression language</a>.</p>
</div>
<div class="paragraph">
<p>Each context variable has a symbolic name (<code>CONTEXT_VARIABLE.<em>name</em></code>), a type from within the openEHR type system (<code>EXPR_TYPE_DEF</code>), and a <em>populating_request</em>, which defines how to populate the variable with a System Request, typically an EHR query or similar.</p>
</div>
<div class="paragraph">
<p>There are two types of variables - 'event' and 'state', which distinguish the update basis. An Event variable is 'watched' by some technical means, and its value is updated whenever it changes. The <code>CONTINUOUS_EVENT_VARIABLE</code> specialised type can be used for managing updates of continuous valued variables (i.e. real values) such that changes below a certain threshold, say 2% do not register.</p>
</div>
</div>
<div class="sect2">
<h3 id="_class_descriptions"><a class="anchor" href="#_class_descriptions"></a>5.4. Class Descriptions</h3>
<div class="sect3">
<h4 id="_plan_data_context_class"><a class="anchor" href="#_plan_data_context_class"></a>5.4.1. PLAN_DATA_CONTEXT Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>PLAN_DATA_CONTEXT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Container for all variable definitions used in the Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>variables</strong>: <code>List&lt;CONTEXT_VARIABLE&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of all variables tracked by this Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>expressions</strong>: <code>List&lt;CONTEXT_EXPRESSION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of all expressions used in the Plan, based on tracked variables.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_context_value_class"><a class="anchor" href="#_context_value_class"></a>5.4.2. CONTEXT_VALUE Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>CONTEXT_VALUE (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Any kind of value used in the Plan definition. Typed by the formal type of the value, i.e. Boolean, Integer etc. The types are represented by <code>EXPR_TYPE_DEF</code> descendants.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>type</strong>: <code>T</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Type of this variable.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_context_variable_class"><a class="anchor" href="#_context_variable_class"></a>5.4.3. CONTEXT_VARIABLE Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>CONTEXT_VARIABLE (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Any kind of symbolic variable that can be used within Expressions in the Task Plan, including in pre-conditions and decision pathways.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>CONTEXT_VALUE</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>name</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Name of variable, as used in precondition and decision expressions.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>populating_request</strong>: <code>SYSTEM_CALL</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional specification of a system request that would populate a context variable.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_event_variable_class"><a class="anchor" href="#_event_variable_class"></a>5.4.4. EVENT_VARIABLE Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EVENT_VARIABLE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Variable whose value is required to be the latest; ideally, updating would be implemented by listener model.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>CONTEXT_VARIABLE</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_continuous_event_variable_class"><a class="anchor" href="#_continuous_event_variable_class"></a>5.4.5. CONTINUOUS_EVENT_VARIABLE Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CONTINUOUS_EVENT_VARIABLE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Dynamically updated variable of any continuous type whose value may change by arbitrarily small amounts. The <code><em>update_variation</em></code> attribute may be used to control updating frequency.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EVENT_VARIABLE</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>update_variation</strong>: <code>Real</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Minimum percentage variation from current value to be considered a change that should cause an update.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_state_variable_class"><a class="anchor" href="#_state_variable_class"></a>5.4.6. STATE_VARIABLE Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>STATE_VARIABLE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Variable that is updated by polling, and is regarded as correct as long as the last update occurred at or more recently than the required currency.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>CONTEXT_VARIABLE</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>required_currency</strong>: <code>Duration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Required currency of data in target system (e.g. EHR) to be considered valid in the context of this Task.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_context_expression_class"><a class="anchor" href="#_context_expression_class"></a>5.4.7. CONTEXT_EXPRESSION Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CONTEXT_EXPRESSION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>An expression that references one or more context variables. At run time, Context Expressions are updated when changes to their dependent variables are detected.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>CONTEXT_VALUE</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>expression</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Expression, in openEHR Expression syntax.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_boolean_context_expression_class"><a class="anchor" href="#_boolean_context_expression_class"></a>5.4.8. BOOLEAN_CONTEXT_EXPRESSION Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>BOOLEAN_CONTEXT_EXPRESSION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Boolean-valued form of <code>CONTEXT_EXPRESSION</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>CONTEXT_EXPRESSION</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_system_call_class"><a class="anchor" href="#_system_call_class"></a>5.4.9. SYSTEM_CALL Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>SYSTEM_CALL</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Definition of a request to make to a system (i.e. information system or device) via its API, that reads or writes information specific to the Task to which it is attached in an actual Plan.</p>
</div>
<div class="paragraph">
<p>This could include OS calls, e.g. to launch an application for a certain user.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>system_id</strong>: <code>UID_BASED_ID</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of target system, typically a domain name.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>call_name</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Name of call in API.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>parameters</strong>: <code>Hash&lt;String, String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Call parameters.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_lifecycle_enumeration"><a class="anchor" href="#_task_lifecycle_enumeration"></a>5.4.10. TASK_LIFECYCLE Enumeration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_LIFECYCLE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration representing possible lifecycle states for a Task lifecycle transition, for example, "not needed".</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">planned</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task is planned for the future.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">available</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task is available for execution by performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">cancelled</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task was cancelled without commencing.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">abandoned</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task was aborted after commencement, i.e. ended prematurely without meeting normal conditions of completion.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">completed</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task was completed in the intended way.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">suspended</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task is waiting for completion of a handoff or external request.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">underway</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task has been commenced.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">resumed</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task has been resumed from <code>suspend</code> state.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_resume_type_enumeration"><a class="anchor" href="#_resume_type_enumeration"></a>5.4.11. RESUME_TYPE Enumeration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RESUME_TYPE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration of types of resume behaviour after a callback.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">resume_specified</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Resume at a specified Task in the same thread of control.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">retry_current_group</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Retry Tasks starting at the top of the current Group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">new_thread</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Recommence as a new thread of execution at <code><em>restart_location</em></code>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_temporal_relation_enumeration"><a class="anchor" href="#_temporal_relation_enumeration"></a>5.4.12. TEMPORAL_RELATION Enumeration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TEMPORAL_RELATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration of relative temporal relations.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">before</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Before a reference event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">with</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>At the same time as a reference event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">after</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>After a reference event.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_execution_type_enumeration"><a class="anchor" href="#_execution_type_enumeration"></a>5.4.13. EXECUTION_TYPE Enumeration</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXECUTION_TYPE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration specifying types of execution for a set of Tasks.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">sequential</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Items execute in order, one after the other.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">parallel</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Items may be executed in parallel, with no regard to order in the representation.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_time_specifier_class"><a class="anchor" href="#_time_specifier_class"></a>5.4.14. TIME_SPECIFIER Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>TIME_SPECIFIER (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent of types used to specify a point in time.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_clock_time_class"><a class="anchor" href="#_clock_time_class"></a>5.4.15. CLOCK_TIME Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CLOCK_TIME</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A point in time within a day.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>TIME_SPECIFIER</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>time</strong>: <code>Time</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Time expressed as a clock time within a day.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_calendar_time_class"><a class="anchor" href="#_calendar_time_class"></a>5.4.16. CALENDAR_TIME Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CALENDAR_TIME</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>An absolute point in time., i.e. date + time, locatable on a calendar.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>TIME_SPECIFIER</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>time</strong>: <code>Date_time</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Time expressed as an absolute date/time.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_customary_time_class"><a class="anchor" href="#_customary_time_class"></a>5.4.17. CUSTOMARY_TIME Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CUSTOMARY_TIME</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Time specified in some customary way, such as 'morning', 'afternoon', etc, that must be interpreted to determine an equivalent format time.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>TIME_SPECIFIER</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>time</strong>: <code>DV_CODED_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A coded term expressing a customary time in natural language.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_definition_model"><a class="anchor" href="#_definition_model"></a>6. Definition Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview"><a class="anchor" href="#_overview"></a>6.1. Overview</h3>
<div class="paragraph">
<p>The following figure shows the key classes in the <code>proc.task_planning.definition</code> package.</p>
</div>
<div id="proc_definition_structure" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/PROC-task_planning.definition-structure.svg" alt="PROC task planning.definition structure">
</div>
<div class="title">Figure 12. proc.task_planning.definition model overview</div>
</div>
<div class="paragraph">
<p>The remaining classes are shown in various specialised views below.</p>
</div>
<div class="paragraph">
<p>The top-level structure for defining plans is a <code>WORK_PLAN</code>, which includes one or more related <code>TASK_PLANs</code> making up a logical goal-oriented plan. Inclusion is achieved via UID references to Task Plans (<code>WORK_PLAN.<em>plans</em></code> and <code>WORK_PLAN.<em>top_level_plans</em></code>) rather than physical containment. This relationship allows related Task Plans to be grouped, which occurs for two reasons described earlier: re-use of Task Plans as <em>sub-plans</em> of other Task Plans, and team-based Plans, featuring <em>hand-offs</em> between Task Plans. For a Work Plan, two distinct lists of Task Plans are maintained: <code><em>plans</em></code>, which references all Task Plans, and <code><em>top_level_plans</em></code>, which is a list of those Task Plans that act as the start points for activity for the various actors. Non-top-level plans are those used as sub-plans.</p>
</div>
<div class="paragraph">
<p>A Work Plan has a number of global attributes, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>context</em></code>: a data context for the Plan as a whole, which enables external variables (such as patient data items) to be tracked and updated;</p>
</li>
<li>
<p><code><em>calendar</em></code>: a global calendar for the Plan, into which entries may be added representing fixed events such as appointments, holidays etc;</p>
</li>
<li>
<p><code><em>timeline</em></code>: the global timeline for the Plan (and hence the subject) into which planned Tasks are fixed, with times specified as offsets from the zero point;</p>
</li>
<li>
<p><code><em>event_wait_states</em></code>: a reference list of all Event wait instances defined in the Plan.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both <code>WORK_PLAN</code> and <code>TASK_PLAN</code> are descendants of <code>CONTENT_ITEM</code>, which makes them a type of content that may occur in a <code>COMPOSITION</code>. Compositions used for this purpose have their <code><em>category</em></code> attribute set to the openEHR coded term <code>|Work Plan|</code>. This enables Work Plans to be committed to the openEHR EHR.</p>
</div>
<div class="paragraph">
<p>As can be seen, the <code><em>definition</em></code> of a <code>TASK_PLAN</code> is a <code>TASK_GROUP</code>, which has as its <code><em>members</em></code> any number of <code>PLAN_ITEMs</code>, which resolve to either <code>TASK_GROUP</code> (and some specialisations described below), or <code>TASK</code>.</p>
</div>
<div class="paragraph">
<p><code>PLAN_ITEM</code> has a mandatory <code><em>description</em></code> attribute, which represents a natural language specification of the work of the Task. It also has two optional attributes that control the generic behaviour of Tasks and Groups: <code><em>wait_spec</em></code> and <code><em>repeat_spec</em></code>. The first enables a wait state (described above in the section <a href="#time_and_wait_states">Time and Wait States</a>) to be applied to a Task or Group, which is triggered by time-related Events (clock time, reaching a point in a calendar) or other kinds of Events (external notifications etc). This allows the timing of a Task to be specified.</p>
</div>
<div class="paragraph">
<p>The second attribute, <code><em>repeat_spec</em></code>, enables a Task or Group to be marked as repeating. This is not primarily intended to replace the use of individual Task instances over time, such as repeated medication administrations, but rather to be used to indicate if larger sections (typicaly a Group) of planned Tasks are repeatable. Where repeats are specified, they will be unrolled into literal copies in the materialised expression of the Plan.</p>
</div>
<div class="sect3">
<h4 id="_task_group_structure"><a class="anchor" href="#_task_group_structure"></a>6.1.1. Task Group Structure</h4>
<div class="paragraph">
<p>The set of Tasks in a Task Plan is represented within a containment structure created using instances of the <code>TASK_GROUP</code> type, which has three key attributes. Execution of a Group is controlled by the <code><em>execution_type</em></code> and <code><em>execution_rules</em></code> attributes, which express sequential or parallel processing, and optionally other execution rules. It also has a <code><em>training_level</em></code> attribute which enables different visibility of Sub-Plans to users with different experience levels. This is described more fully below.</p>
</div>
<div class="paragraph tbd">
<p>TBD: other execution rules.</p>
</div>
<div class="paragraph">
<p>The following illustrates a simple Task Plan structure including nested Task Groups.</p>
</div>
<div id="task_grouping" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_grouping.svg" alt="task grouping" width="25%">
</div>
<div class="title">Figure 13. Task grouping</div>
</div>
<div class="paragraph">
<p>The combination of the Task Group / Task hierachical pattern, which implicitly defines the graph structure of the 'normal flow' of a Task Plan, and the generic control attributes enable a significant amount of execution-time Plan processing to be implemented independently of any Task semantics.</p>
</div>
</div>
<div class="sect3">
<h4 id="_class_descriptions_2"><a class="anchor" href="#_class_descriptions_2"></a>6.1.2. Class Descriptions</h4>
<div class="sect4">
<h5 id="_work_plan_class"><a class="anchor" href="#_work_plan_class"></a>6.1.2.1. WORK_PLAN Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>WORK_PLAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Top-level object of any logical work plan. References one or more <code>TASK_PLANs</code> that described the work, typically of each performer, although a single <code>TASK_PLAN</code> may also have multiple performers.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>AUTHORED_RESOURCE</code>, <code>CONTENT_ITEM</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>care_pathway</strong>: <code>DV_IDENTIFIER</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of care pathway etc, on which this Work Plan is based, if such exists. A 'care pathway' is understood here as a published standard for performing care for a major condition or presenting complaint, e.g. sepsis, MI etc.</p>
</div>
<div class="paragraph">
<p>It is currently assumed that there is no reliable machine identifier system for care pathways. A <code>DV_IDENTIFIER</code> allows things like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>issuer = "NICE"</code>;</p>
</li>
<li>
<p><code>id = "https://pathways.nice.org.uk/pathways/sepsis"</code>;</p>
</li>
<li>
<p><code>type = "NICE Sepsis care pathway"</code>.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>plans</strong>: <code>List&lt;UID_BASED_ID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The set of all Task Plans use in this Work Plan. In general, only some of these are top-level Plans.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>care_plan</strong>: <code>LOCATABLE_REF</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Care plan in EHR from which this Work Plan is derived, if any.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>order_list</strong>: <code>List&lt;LOCATABLE_REF&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference list of orders in this Work Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>calendar</strong>: <code>PLAN_CALENDAR</code></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>timeline</strong>: <code>PLAN_TIMELINE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Global timeline of Work Plan, on which Tasks with planned times can be listed.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>context</strong>: <code>PLAN_DATA_CONTEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Global Work Plan data context.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>event_wait_states</strong>: <code>List&lt;EVENT_WAIT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference list of all defined Event Listeners.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>top_level_plans</strong>: <code>List&lt;UID_BASED_ID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The set of top-level Plans that correspond to the performers and work pathways of this Work Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Human-understandable description of the Task Plan, which may be specific to the work items and patient.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_plan_calendar_class"><a class="anchor" href="#_plan_calendar_class"></a>6.1.2.2. PLAN_CALENDAR Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>PLAN_CALENDAR</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Work Plan global calendar in which all absolute-time Calendar Events are recorded.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>entries</strong>: <code>List&lt;CALENDAR_ENTRY&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Entries in calendar.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_plan_timeline_class"><a class="anchor" href="#_plan_timeline_class"></a>6.1.2.3. PLAN_TIMELINE Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>PLAN_TIMELINE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>List of Plan Items that have a wait_condition containing an <code>AGENDA_MOMENT</code>, whose times will be converted at Plan activation to fixed times on an execution calendar.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>planned_items</strong>: <code>List&lt;PLAN_ITEM&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of Plan Items that have a wait_condition containing a <code>TIMELINE_MOMENT</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>timers</strong>: <code>List&lt;TIMER_WAIT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference list of all defined Timers.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_calendar_entry_class"><a class="anchor" href="#_calendar_entry_class"></a>6.1.2.4. CALENDAR_ENTRY Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CALENDAR_ENTRY</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A single calendar entry.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_task_plan_class"><a class="anchor" href="#_task_plan_class"></a>6.1.2.5. TASK_PLAN Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PLAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Logical list of Tasks in a structure defining order and conditions of execution of items of work intended to achieve a goal. A Task Plan consists of a top-level <code>TASK_GROUP</code> containing <code>PLAN_ITEMs</code>, which are either atomic TASKs, more <code>TASK_GROUPs</code> or conditional Groups.</p>
</div>
<div class="paragraph">
<p>A Task Plan specifies a <code><em>principal_performer</em></code>, representing a kind of actor who can perform the Tasks, and bounding <code><em>start_time</em></code> and <code><em>completion_time</em></code> information.</p>
</div>
<div class="paragraph">
<p>It has an associated <code><em>execution_history</em></code> that can be used to record work events in time.</p>
</div>
<div class="paragraph">
<p>The attributes <code><em>care_plan</em></code> and <code><em>guideline_id</em></code> provide a way of associating a Task Plan with an operational care plan, and also a published guideline or protocol on which the Task Plan may be based.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>CONTENT_ITEM</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Human-understandable description of the Task Plan, which may be specific to the work items and patient.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>subject</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional indicator of subject of Task, which is normally the subject of the EHR. If this is not the case, this attribute states who the Task is to be performed on.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>guideline</strong>: <code>DV_IDENTIFIER</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of guideline on which this Task Plan is based, if such exists. A 'guideline' is understood here as a published standard for performing a detailed Task.</p>
</div>
<div class="paragraph">
<p>It is currently assumed that there is no reliable machine identifier system for guidelines. A <code>DV_IDENTIFIER</code> allows things like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>issuer = "NICE"</code>;</p>
</li>
<li>
<p><code>id = "https://www.nice.org.uk/guidance/cg180"</code>;</p>
</li>
<li>
<p><code>type = "NHS guideline for Atrial fibrillation: management"</code>.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>TASK_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The Tasks for the main part of this Task Plan; this section of the plan may be repeatable.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>execution_history</strong>: <code>TASK_PLAN_EXECUTION_HISTORY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>History of execution events for an execution of this Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>best_practice_ref</strong>: <code>DV_URI</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A URI (typically a local URL) that points to the document form of any governing guideline or other best practice publication in use in the current institution. This link provides a way for a clinician to cross-check the Task Plan design and functioning against the definitive document that acts as the source of its semantics.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>expiry_time</strong>: <code>IDuration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Maximal date/time by which this Task Plan should be considered obsolete. If not set, the Task Plan would normally be inferred to be obsolete after a discharge from acute care, but in primary or social care situations, no value may be assumed to indicate that the Tasks are still to be performed, depending on the times specified in the <code><em>execution_time</em></code> attribute of <code>TASKs</code> in the Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>due_time</strong>: <code>IDuration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Due date/time expressed as an offset, to be converted to a real date/time at activation.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>order_set_type</strong>: <code>DV_IDENTIFIER</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional identifier for an order set, which is understood as a <em>type</em> of order set, e.g. 'R-CHOP-14'.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>order_set_id</strong>: <code>DV_IDENTIFIER</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of instance of an order set on which this Task Plan is based, if there is one.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>indications</strong>: <code>List&lt;DV_TEXT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Clinical applicability of this Task item to subject of work, e.g. 'pregnancy', 'lymphoma' etc. May be derived from a governing guideline. May be displayed as a safety precaution to human performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>principal_performer</strong>: <code>TASK_PARTICIPATION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Specification of principle performer of this Task Plan as a Participation, in terms of role and optionally function, mode and specific performer as appropriate.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_task_participation_class"><a class="anchor" href="#_task_participation_class"></a>6.1.2.6. TASK_PARTICIPATION Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PARTICIPATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Class defining a participation in Task(s), minimally in terms of function. Optionally, the role and mode may also be specified. The performer attribute enables a specific actor to be specified.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>function</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The function of the Party in this participation (note that a given party might participate in more than one way in a particular activity). This attribute should be coded.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>role</strong>: <code>List&lt;DV_TEXT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Organisational role, i.e. the professional type of participant in the activity. Preferably coded.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mode</strong>: <code>DV_CODED_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional field for recording the 'mode' of the performer / activity interaction, e.g. present, by telephone, by email etc.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>performer</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The id and possibly demographic system link of the party participating in the activity.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>optionality</strong>: <code>VALIDITY_KIND</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Condition for participation in the Plan item.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_plan_item_class"><a class="anchor" href="#_plan_item_class"></a>6.1.2.7. PLAN_ITEM Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>PLAN_ITEM (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Parent type of structural Task types that may appear within a Task Plan structure.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>LOCATABLE</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Human-readable form of the task directive.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>repeat_spec</strong>: <code>TASK_REPEAT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional specification of repetitions.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_details</strong>: <code>ITEM_STRUCTURE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Archetypable structure for recording non hard-modelled information.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>wait_spec</strong>: <code>TASK_WAIT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional wait specification for a Task. If not set, the Task is immediately available once execution reaches it. If set, the Task becomes available when an Event linked to the <code><em>wait_spec</em></code> occurs.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_task_group_class"><a class="anchor" href="#_task_group_class"></a>6.1.2.8. TASK_GROUP Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Grouping structure that defines the graph structure of a Task Plan, replacing node-to-node references.</p>
</div>
<div class="paragraph">
<p>This allows Task Group to define the execution basis for a collection of Tasks, which may include more Task groups.</p>
</div>
<div class="paragraph">
<p>The <code><em>execution_type</em></code> attribute defines the mode of execution. If not set, sequential execution is assumed.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>PLAN_ITEM</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>members</strong>: <code>List&lt;PLAN_ITEM&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set of Tasks to perform. Execution order is defined by the <code><em>execution_type</em></code> setting, either sequential or parallel (no order).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>execution_type</strong>: <code>EXECUTION_TYPE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Basis for executing the Task items contained in this Task Group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>training_level</strong>: <code>Integer</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>An integer value representing the training level for which this Task Plan is designed. A high value corresponds to a lower level of expertise. The default value is zero.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>execution_rules</strong>: <code>List&lt;EXECUTION_RULE&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Other rules that may control execution over and above the basic sequential / parallel scheme, e.g.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>at least N members must complete for group to complete;</p>
</li>
<li>
<p>exit group on first succeeding task.</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_execution_type_enumeration_2"><a class="anchor" href="#_execution_type_enumeration_2"></a>6.1.2.9. EXECUTION_TYPE Enumeration</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Enumeration</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXECUTION_TYPE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Enumeration specifying types of execution for a set of Tasks.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">sequential</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Items execute in order, one after the other.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock">parallel</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Items may be executed in parallel, with no regard to order in the representation.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_execution_rule_class"><a class="anchor" href="#_execution_rule_class"></a>6.1.2.10. EXECUTION_RULE Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXECUTION_RULE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Rule controlling execution in addition to basic sequential / parallel setting.</p>
</div>
<div class="paragraph">
<p>TODO: define detail.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_task_class"><a class="anchor" href="#_task_class"></a>6.1.2.11. TASK Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Atomic Task that is typed according to the kind of <code>TASK_ACTION</code> it includes. A <code>TASK</code> has a lifecycle that can be progressed in the plan execution, i.e. in the Materialised form.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>PLAN_ITEM</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>action</strong>: <code>TA</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task Action definition.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_task_repeat_class"><a class="anchor" href="#_task_repeat_class"></a>6.1.2.12. TASK_REPEAT Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_REPEAT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Definition of repetition for a Task Item. The repeats attribute provides a constraint on a number of times. If not set, any number of repeats is allowed. The terminate_condition attribute defines when repetition should cease in terms of a condition, typically a subject-related variable.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>repeats</strong>: <code>Interval&lt;Integer&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Range of repetitions. If the lower limit is greater than zero, at least one repeat is required. A range such as 0..3 means up to 3 repeats possible, but not required.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>terminate_condition</strong>: <code>PLAN_EVENT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>States a condition for when repetition should stop.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_task_actions"><a class="anchor" href="#_task_actions"></a>6.2. Task Actions</h3>
<div class="paragraph">
<p>The specific definition of the work of Tasks is provided by <code>TASK.<em>action</em></code>, of type <code>TASK_ACTION</code> and its subtypes. Two abstract sub-types distinguish the two basic flavours of Task Action, namely <em>dispatchable</em>, meaning 'sent elsewhere for processing', and <em>performable</em>, meaning 'defined and performed within the current Plan'. The following UML diagram shows <code>TASK_ACTION</code> and its subtypes in detail.</p>
</div>
<div id="rm_definition_actions" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/PROC-task_planning.definition-actions.svg" alt="PROC task planning.definition actions">
</div>
<div class="title">Figure 14. proc.task_planning.definition model - Task Actions</div>
</div>
<div class="paragraph">
<p><code>TASK_ACTION</code> includes three attributes that apply to all subtypes. The first is <code><em>subject_preconditions</em></code>, which enables subject-related preconditions to be expressed, i.e. conditions referencing variables relating to the subject such as vital signs. These preconditions can be understood as conditions for safe processing, and should either be satisfied before proceeding, or else overridden by a competent performer who understands the implications.</p>
</div>
<div class="paragraph">
<p>A subject precondition is formally represented as a <code>BOOLEAN_CONTEXT_EXPRESSION</code>, whose <code><em>expression</em></code> value is a string in <a href="/releases/BASE/latest/expression.html">openEHR Expression Language</a> syntax.</p>
</div>
<div class="paragraph">
<p>Pre-conditions are evaluated at the point at which the Task to which they are attached becomes available during execution. If any pre-condition evaluates to False, the Task is in theory unable to be performed. A clinical professional may override at execution time, since it may always be the case that particular circumstances obviate the need for a particular pre-condition that normally applies.</p>
</div>
<div class="paragraph tbd">
<p>TBD: subject precondition could potentially move to <code>PERFORMABLE_ACTION</code>.</p>
</div>
<div class="paragraph">
<p>The second generally applicable attribute is <code><em>costing_data</em></code>, since cost information may clearly be relevant to any Plan item. Costing is dealt with in detail below.</p>
</div>
<div class="paragraph">
<p>The third attribute is <code><em>review_dataset</em></code> which provides the ability to specify a data set or form to display when entering a Task, to aid the performer.</p>
</div>
<div class="paragraph">
<p>In a similar manner, a small number of attributes apply to Dispatchable Actions and Performable Actions. The former class has two attributes to do with managing context change and callback. The <code><em>wait</em></code> flag indicates whether the current Task waits (i.e. blocks) while the dispatched work is performed, or whether it continues on asynchronously. The first constitutes a context switch, the second a context fork. The <code><em>callback</em></code> attribute attaches a special kind of Event-wait that is triggered on receipt of a callback. How callbacks function in detail is described below.</p>
</div>
<div class="paragraph">
<p>Performable Actions have three attributes. The <code><em>other_participations</em></code> and <code><em>resources</em></code> attributes allow other performers and passive resources to be defined for an Action. Both are subject to an allocation process at execution time, similar to that of the <code><em>principal_performer</em></code>. Finally, the <code><em>capture_dataset</em></code> allows a dataset or form to be specified, for which data must be obtained during the Task execution.</p>
</div>
<div class="paragraph">
<p>The subtypes of <code>TASK_ACTION</code> consist of the following (reading from the right hand side):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DEFINED_ACTION</code>: an inline-defined Task to be performed by the principal performer of the Group (see below for details);</p>
</li>
<li>
<p><code>SUB_PLAN</code>: a kind of Task that stands for another Task Plan (identified by the inherited <code>LINKED_PLAN.<em>target</em></code> attribute) to be performed by the current performer - usually a fine-grained set of steps designed to achieve the result of this Task.</p>
</li>
<li>
<p><code>SYSTEM_REQUEST</code>: a kind of Task that consists of a request to a computational system, such as a data retrieval or procedure call, on behalf of the current performer;</p>
</li>
<li>
<p><code>EXTERNAL_REQUEST</code>: a Task type that consists of a request to an external organisational entity that is outside the current Work Plan and its execution environment, on behalf of the current performer;</p>
</li>
<li>
<p><code>HAND_OFF</code>: a kind of Task that hands off to another Task Plan in the same Work Plan, having a different performer (identified via the <code><em>target</em></code> attribute inherited from <code>LINKED_PLAN</code>);</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sections provide more detail on some of these model features.</p>
</div>
<div class="sect3">
<h4 id="_performable_actions"><a class="anchor" href="#_performable_actions"></a>6.2.1. Performable Actions</h4>
<div class="sect4">
<h5 id="_sub_plans_and_re_use"><a class="anchor" href="#_sub_plans_and_re_use"></a>6.2.1.1. Sub-plans and Re-use</h5>
<div class="paragraph">
<p>As described above, multiple Task Plans may be used to define a single logical plan of work. This occurs for two main reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>re-use</em>: Task Plans that can be used on their own, e.g. 'set up IV drip', are combined within a larger plan;</p>
</li>
<li>
<p><em>level of granularity</em>: a Task Plan can contain Tasks that can be represented as finer-grained Task Plans, which may potentially be used or passed over depending on the level of experience, known here as <em>training level</em> of the performer.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following instance diagram illustrates.</p>
</div>
<div id="task_linking" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_linking.svg" alt="task linking" width="70%">
</div>
<div class="title">Figure 15. Task Plan linking</div>
</div>
<div class="paragraph">
<p>This shows a Plan for dialysis with a single performer, 'dialysis nurse', and several sub-plans, each referred to by an instance of the <code>SUB_PLAN</code> class. Since a Sub-plan is a kind of Task, it has a <em>description</em> and could be performed and signed off as if it were a normal inline <code>DEFINED_ACTION</code> by an experienced performer (training level high), or it might be entered into by a performer such as a trainee nurse. The <code>PLAN_ITME.<em>training_level</em></code> attribute can be used to set the experience level of sub-plans if required; implementing this behaviour at execution time would rely in the Plan execution engine using these settings.</p>
</div>
</div>
<div class="sect4">
<h5 id="_inline_defined_actions"><a class="anchor" href="#_inline_defined_actions"></a>6.2.1.2. Inline Defined Actions</h5>
<div class="paragraph">
<p>Tasks whose definitions are stated within a Task Plan are modelled using the <code>DEFINED_ACTION</code> type. A detailed specification of the work to be done in a Defined Action  may be stated via optional atttribute <code><em>prototype</em></code> of type <code>ENTRY</code>, which enables the details of a Task to be specified in terms of a descendant of the <code>ENTRY</code> class. This is typically an <code>ACTION</code> instance but could be an <code>OBSERVATION</code>, <code>ADMIN_ENTRY</code> or other descendant. The following view of the UML illustrates.</p>
</div>
<div id="proc_task_planning_definition_defined_task" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/PROC-task_planning.definition-defined_task.svg" alt="PROC task planning.definition defined task">
</div>
<div class="title">Figure 16. proc.task_planning.definition - Definition Task</div>
</div>
<div class="paragraph">
<p>The attribute is called 'prototype' because the target Entry instance is understood as a partially populated, prototype 'planning time' partial copy of an Entry that will be created when the Task is actually performed. For example, a Task Plan for administering medication at 8 hourly intervals over a number of days could consist of a number of <code>DEFINED_ACTIONs</code>, each having a protoype of an <code>ACTION</code> instance based on the <code>openEHR-EHR-ACTION.medication.v1</code> archetype or a templated version thereof. Each such instance would contain the structured description of the medication administration and time, and when the administration was actually performed, an <code>ACTION</code> instance would be created from the prototype, modified to reflect any divergence from the planned form of the Task, and committed to the EHR in the normal way.</p>
</div>
<div class="paragraph">
<p>The following illustrates Task definitions using prototypes.</p>
</div>
<div id="task_definition" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_definition.svg" alt="task definition" width="45%">
</div>
<div class="title">Figure 17. Task definition</div>
</div>
<div class="paragraph">
<p>Assuming that the Task Plan is archetyped in the same way as Entries and other elements of the EHR, this scheme supports various modes of design-time specification. The <code><em>prototype</em></code> attribute in a <code>TASK_PLAN</code> archetype will usually be represented by an archetype slot or external reference, which specifies identifiers of permitted archetypes (or templates) of the target type, i.e. <code>ACTION</code> or other Entry. This can be used in various ways, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="/releases/AM/latest/ADL2.html#_external_references">external reference</a>: specifies a fixed archetype identifier which will be substituted in the templated form of the Task Plan. This has the effect of creating <code>ACTION</code> or other prototype instances in the <code>TASK_PLAN</code> structure;</p>
</li>
<li>
<p><a href="/releases/AM/latest/ADL2.html#_archetype_slots">archetype slot</a>: specified using a slot constraint that is satisfied by one or more archetypes that may be specified by a template, or left open until runtime.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the latter case, the slot may be filled in the Task Plan template with an <code>ACTION</code> or other Entry archetype, allowing the Tasks to be fully specified inline as in the external reference case. Alternatively, it may be left unresolved, which would allow the workflow application to choose the exact Task definition archetype at runtime.</p>
</div>
<div class="paragraph">
<p>One reason to allow a Task to contain a <code><em>prototype</em></code> reference that remains unresolved until runtime is if the Task represents the act of making an observation, for example, taking a blood pressure. In such cases, no prototype at all may be needed, and the Task <code><em>description</em></code> attribute (inherited from <code>PLAN_ITEM</code>) may be sufficient information for the performer. On the other hand, a prototype <code>OBSERVATION</code> could be specified in the <code>TASK_PLAN</code> template, which defines a particular form of the observation, e.g. a blood pressure which only records mean arterial pressure and cuff size.</p>
</div>
<div class="paragraph">
<p>To allow further flexibility, The multiplicity of the <code><em>prototype</em></code> attribute is unlimited, to allow for the possibility of one Task being prototyped by more than one Entry instance, e.g. an <code>ACTION</code> and an <code>OBSERVATION</code>, two <code>ADMIN_ENTRY</code> instances and so on.</p>
</div>
</div>
<div class="sect4">
<h5 id="_data_sets_and_application_interaction"><a class="anchor" href="#_data_sets_and_application_interaction"></a>6.2.1.3. Data-sets and Application Interaction</h5>
<div class="paragraph">
<p>Within the definition of a Defined Action, one or more data-sets may be specified for review and / or capture purposes (<code>DEFINED_ACTION.<em>review_dataset</em></code> and <code><em>capture_dataset</em></code>). A 'data-set' in openEHR is a template, normally displayed as a form within an application. Either a template or form identifier (or both) maybe be used to specify a data-set. A review data-set is specified to signal to the Task Plan runtime system to request the display of data at the start of the Task, in order to provide data needed by the user for the Task and potentially following Tasks. A capture data-set is specified when the purpose of the Task is to record data.</p>
</div>
<div class="paragraph tbd">
<p>TBD: a single attribute may be sufficient.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dispatchable_actions"><a class="anchor" href="#_dispatchable_actions"></a>6.2.2. Dispatchable Actions</h4>
<div class="paragraph">
<p>The type <code>DISPATCHABLE_ACTION</code> is the abstract parent of various Action subtypes that represent work requested to be done by some other agent, i.e. external to the current Task Plan. The general execution scheme for such Actions is as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>dispatch</em> the work request to a target actor or service;</p>
</li>
<li>
<p><em>block or continue</em>, according to the <code><em>wait</em></code> flag, which determines switch or fork behaviour; and</p>
</li>
<li>
<p>process any <em>callback notification</em>, specified via the <code><em>callback</em></code> attribute.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sub-sections described the various subtypes of <code>DISPATCHABLE_ACTION</code>, while callbacks are described in detail further down.</p>
</div>
<div class="sect4">
<h5 id="_hand_offs_and_coordinated_teamwork"><a class="anchor" href="#_hand_offs_and_coordinated_teamwork"></a>6.2.2.1. Hand-offs and Coordinated Teamwork</h5>
<div class="paragraph">
<p>Work Plans may be designed to contain multiple Task Plans, each corresponding to a team worker. In the execution of such a Work Plan, the performer of any Task Plan may at some point need to hand off to another performer, i.e. one of the other Task Plans in the same Work Plan. As described above, the original worker may wait or continue, and in both cases, receipt of a callback notification from the other Task Plan may cause a change in the execution path of the first Plan.</p>
</div>
<div class="paragraph">
<p>The following illustrates, using the example of an acute stroke management care process.</p>
</div>
<div id="task_coordination" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/task_coordination.svg" alt="task coordination" width="80%">
</div>
<div class="title">Figure 18. Task coordination</div>
</div>
<div class="paragraph">
<p>In this Work Plan, three Task Plans are used to perform (parts of) the clinical work coordinated for managing an acute stroke, as per a Care Pathway. There are two Hand-offs, the first synchronous (<code><em>wait</em></code> = <code>True</code>; callback wait resumes at the next Task) and the second an asynchronous fork (<code><em>wait</em></code> = <code>False</code>).</p>
</div>
</div>
<div class="sect4">
<h5 id="_external_request"><a class="anchor" href="#_external_request"></a>6.2.2.2. External Request</h5>
<div class="paragraph">
<p>The Task sub-type <code>EXTERNAL_REQUEST</code> represents a request by the current performer to an external entity completely outside of the current Work Plan computation context to perform some work on behalf of the performer. This is normally an organisation of which routine requests can be made (e.g. pathology laboratory). The request is defined in terms of an organisation identifier, a request identifier (i.e. a name or type of job) and a list of other details, represented by the standard archetypable <code>ITEM_STRUCTURE</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_system_request"><a class="anchor" href="#_system_request"></a>6.2.2.3. System Request</h5>
<div class="paragraph">
<p>In a similar way to External Request, the <code>SYSTEM_REQUEST</code> Task sub-type represents a request to a <em>system</em> with a computational interface on behalf of the performer, such as a logging facility or a decision support system. The request is defined in terms of a <code>SYSTEM_CALL</code> instance.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_class_descriptions_3"><a class="anchor" href="#_class_descriptions_3"></a>6.2.3. Class Descriptions</h4>
<div class="sect4">
<h5 id="_task_action_class"><a class="anchor" href="#_task_action_class"></a>6.2.3.1. TASK_ACTION Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>TASK_ACTION (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent of Task Action types, which define the specifics of the work of a Task. All Task Actions may have subject preconditions (i.e. preconditions on the state of the subject) that must be met or overridden before proceeding; costing information; and one or more review data sets to display in the application environment.</p>
</div>
<div class="paragraph">
<p>Performable Actions have further properties.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>LOCATABLE</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>review_dataset</strong>: <code>List&lt;DATASET_SPEC&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional data-set to review prior to / as part of performing Task. This implies a data retrieval from the EHR or other system, which may be specified using a <code>SYSTEM_REQUEST</code> attached to this Task.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>instruction_activity</strong>: <code>LOCATABLE_REF</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional reference back to the <code>ACTIVITY</code> of an <code>INSTRUCTION</code> that generated this <code>TASK</code>.</p>
</div>
<div class="paragraph">
<p>TODO: may be movable to <code>PERFORMABLE_ACTION</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>subject_preconditions</strong>: <code>List&lt;SUBJECT_PRECONDITION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Condition which must be met for the Task Action to be available to perform in a runtime execution context.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>costing_data</strong>: <code>TASK_COSTING</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Costing data related to this Task item.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_subject_precondition_class"><a class="anchor" href="#_subject_precondition_class"></a>6.2.3.2. SUBJECT_PRECONDITION Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>SUBJECT_PRECONDITION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Clinical preconditions expressing when the Task is safely executable with respect to the principal performer and subject.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Textual representation of preconditions for this Task to be performed, according to governing protocol. May be displayed as a safety check for human performer.</p>
</div>
<div class="paragraph">
<p>Evaluated when encountered.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>expression</strong>: <code>BOOLEAN_CONTEXT_EXPRESSION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>A Boolean expression that can be evaluated at runtime to determine availability.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_dataset_spec_class"><a class="anchor" href="#_dataset_spec_class"></a>6.2.3.3. DATASET_SPEC Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DATASET_SPEC</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Specification of a related data-set and/or form to use with a Task, usually by means of display and/or data entry screens in an application being used by the principal performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>form_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Form identifier.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>template_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Template identifier in String form of an <code>ARCHETYPE_HRID</code>. If used with no <code><em>form_id</em></code>, the Execution engine needs to determine how to find a form based on the template identifier.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_details</strong>: <code>ITEM_STRUCTURE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Other data-set related details.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_performable_action_class"><a class="anchor" href="#_performable_action_class"></a>6.2.3.4. PERFORMABLE_ACTION Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>PERFORMABLE_ACTION (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Represents an action that can be performed by the principal performer during the Plan execution. This is either inline defined or via reference to a sub-plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>TASK_ACTION</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>resources</strong>: <code>List&lt;RESOURCE_PARTICIPATION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Descriptions of resources required for the Task, if required to be processed at runtime as pre-conditions to Task execution.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_participations</strong>: <code>List&lt;TASK_PARTICIPATION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of participations for task item.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>capture_dataset</strong>: <code>List&lt;DATASET_SPEC&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Associated data-set template and/or form via which data to be captured during this Task will actually be entered.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_resource_participation_class"><a class="anchor" href="#_resource_participation_class"></a>6.2.3.5. RESOURCE_PARTICIPATION Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RESOURCE_PARTICIPATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Description of a resource with optional external system reference.</p>
</div>
<div class="paragraph">
<p>TODO: explain external_ref.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>resource_type</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Text or coded description of resource.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>external_ref</strong>: <code>OBJECT_REF</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to resource, e.g. in scheduling or other system.</p>
</div>
<div class="paragraph">
<p>TODO: may need to be a more powerful reference like a <code>SYSTEM_CALL</code>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_defined_action_class"><a class="anchor" href="#_defined_action_class"></a>6.2.3.6. DEFINED_ACTION Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DEFINED_ACTION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task sub-type that represents concretely defined work items. The definition of the work of the Task is expressed in terms of archetype of an <code>ENTRY</code> (usually an <code>ACTION</code>) that will be used to record the Task&#8217;s execution.</p>
</div>
<div class="paragraph">
<p>The <code><em>entry_instance</em></code> attribute can be used to record a forward reference to an <code>ACTION</code> or other <code>ENTRY</code> when it has been recorded.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>PERFORMABLE_ACTION</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>prototype</strong>: <code>List&lt;ENTRY&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Prototype instance of one or more Entries that express the specific work of the Task. Normally one Entry would be used, typically an <code>ACTION</code>, but more than one may sometimes make sense, e.g. an <code>ACTION</code> and an <code>OBSERVATION</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>optionality</strong>: <code>VALIDITY_KIND</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Informal indication of whether Task is considered optional or not from the point of view of any guideline. If not set, the Task is treated as mandatory.</p>
</div>
<div class="paragraph">
<p>This attribute is not used computationally.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_sub_plan_class"><a class="anchor" href="#_sub_plan_class"></a>6.2.3.7. SUB_PLAN Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>SUB_PLAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A Task referencing another Plan within the same Work Plan, to be executed by the current performer. Execution continues on from the previous Task.</p>
</div>
<div class="paragraph">
<p>For an experienced performer, the referenced Plan, which is usually more detailed may not be needed.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>LINKED_PLAN</code>, <code>PERFORMABLE_ACTION</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_dispatchable_action_class"><a class="anchor" href="#_dispatchable_action_class"></a>6.2.3.8. DISPATCHABLE_ACTION Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>DISPATCHABLE_ACTION (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Type of Task Action that is performed by another performer, system or organisation. All such Task Actions are 'dispatchable' in the sense that they consist of notifying a request to another principal_performer, or an exterior system or service of some kind, and potentially receiving a callback notification when the requested work is complete.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>TASK_ACTION</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>wait</strong>: <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Flag indicating whether to wait or continue in the current Plan after the dispatch notification has been achieved. Wait = True corresponds to a context switch (block and wait) while wait = False indicates a context fork.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>callback</strong>: <code>CALLBACK_WAIT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional callback notification handler.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_hand_off_class"><a class="anchor" href="#_hand_off_class"></a>6.2.3.9. HAND_OFF Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>HAND_OFF</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A kind of Task representing a hand-off to a different performer in the current Work Plan.</p>
</div>
<div class="paragraph">
<p>Tasks of the linked Plan become available to that performer, who is also alerted to start work.</p>
</div>
<div class="paragraph">
<p>A hand-off usually involves waiting with later notification (callback), or continuation. Waiting would typically mean the Plan execution engine places this Plan on a wait list, enabling the performer to proceed with work on other subjects.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>LINKED_PLAN</code>, <code>DISPATCHABLE_ACTION</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_external_request_class"><a class="anchor" href="#_external_request_class"></a>6.2.3.10. EXTERNAL_REQUEST Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EXTERNAL_REQUEST</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task type for representing a request to an external organisational service or actor not within the current Work Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>DISPATCHABLE_ACTION</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>organisation</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of organisation to which the request or order is addressed.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>request_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Request identifier for this type request. May be used in callback notification. Other runtime instance-level identifiers may be needed as well.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_details</strong>: <code>ITEM_STRUCTURE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Request details.</p>
</div>
<div class="paragraph">
<p>TODO: more details needed.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_system_request_class"><a class="anchor" href="#_system_request_class"></a>6.2.3.11. SYSTEM_REQUEST Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>SYSTEM_REQUEST</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Request to an external computational system or service.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>DISPATCHABLE_ACTION</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>system_call</strong>: <code>SYSTEM_CALL</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Definition of call to make.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_linked_plan_class"><a class="anchor" href="#_linked_plan_class"></a>6.2.3.12. LINKED_PLAN Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>LINKED_PLAN (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task type that represents a dispatch to another Task Plan to be executed by another performer in a Plan Group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>target</strong>: <code>UID_BASED_ID</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>UID of target <code>TASK_PLAN</code> object.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conditional_structures"><a class="anchor" href="#_conditional_structures"></a>6.3. Conditional Structures</h3>
<div class="paragraph">
<p>More advanced applications of Task Plans include three common conditional structures, which may be considered as specific patterns based on the core classes. They are expressed in terms of descendants of <code>TASK_GROUP</code> and are illustrated in the following UML model.</p>
</div>
<div id="proc_task_planning_definition_decision" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/PROC-task_planning.definition-decision.svg" alt="PROC task planning.definition decision">
</div>
<div class="title">Figure 19. proc.task_planning package definition model (decision view)</div>
</div>
<div class="paragraph">
<p>The first pattern is a structure in which a set of Task Groups are treated as separate branches from a common point in the Plan. Each branch is entered conditionally according to the Boolean expression included on the branch. The classes <code>CONDITION_GROUP</code> and <code>CONDITION_BRANCH</code> provide this structure, which is  equivalent to an if/then/else structure in a programming language. Semantically, the branches are evaluated in order, in the matter of an if/then/else structure, and the final member may be a catch-all branch that matches if nothing else does. Accordingly, the <code><em>execution_type</em></code> is constrained to <code>sequential</code>.</p>
</div>
<div class="paragraph">
<p>The following diagram shows a typical condition structure.</p>
</div>
<div id="condition_structure" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/condition_structure.svg" alt="condition structure" width="40%">
</div>
<div class="title">Figure 20. Condition structure</div>
</div>
<div class="paragraph">
<p>The second structure corresponds to a decision point in a workflow at which some expression is evaluated, and each outgoing branch corresponds to a sub-set of the expression&#8217;s value range (<code><em>value_constraint</em></code> attribute). The classes <code>DECISION_GROUP</code> and <code>DECISION_BRANCH</code> provide this structure, which is  equivalent to a switch statement in a programming language. The branch sub-ranges should ideally be individually mutually exclusive, and collectively they should cover the entire value range of the expression. However, as with the Condition Group, the branches are processed in order stated in the definition (<code><em>execution_type</em></code> is constrained to <code>sequential</code>), which enables overlapping value constraints on the branches, and also a final catch-all 'else' branch, if needed. The latter would have an open value constraint of the correct type.</p>
</div>
<div class="paragraph">
<p>The following diagram shows a typical decision structure.</p>
</div>
<div id="decision_structure" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/decision_structure.svg" alt="decision structure" width="40%">
</div>
<div class="title">Figure 21. Decision structure</div>
</div>
<div class="paragraph">
<p>The third structure is a wait state at which multiple branches correspond to the receipt of different events. Taken together, the events constitute a set of logical alternatives at the relevant point in the Plan. This structure is modelled using the classes <code>EVENT_GROUP</code> and <code>EVENT_BRANCH</code>, and is equivalent to a when / then / else  rules structure in a rule-based programming environment.</p>
</div>
<div id="event_structure" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/event_structure.svg" alt="event structure" width="85%">
</div>
<div class="title">Figure 22. Event structure</div>
</div>
<div class="sect3">
<h4 id="_class_descriptions_4"><a class="anchor" href="#_class_descriptions_4"></a>6.3.1. Class Descriptions</h4>
<div class="sect4">
<h5 id="_condition_group_class"><a class="anchor" href="#_condition_group_class"></a>6.3.1.1. CONDITION_GROUP Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CONDITION_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Special kind of Task Group whose members are all <code>CONDITION_BRANCH</code> instances, each of which represents a conditional expression based on context variables. Member branches are evaluated in order, which enables overlapping conditions as well as a final 'match-any' branch with a test expression of <code>True</code> to be used if needed.</p>
</div>
<div class="paragraph">
<p>This structure is the equivalent of a programming if/then/else statement.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>TASK_GROUP</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>members</strong>: <code>List&lt;CONDITION_BRANCH&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set of Tasks to perform. Execution order is defined by the <code><em>execution_type</em></code> setting, either sequential or parallel (no order).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Invariants</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p><strong><em>Inv_no_wait_condition</em></strong>: <code>wait_spec = Void</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p><strong><em>Inv_seq_execution</em></strong>: <code>execution_type = EXECUTION_TYPE.sequential</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_condition_branch_class"><a class="anchor" href="#_condition_branch_class"></a>6.3.1.2. CONDITION_BRANCH Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CONDITION_BRANCH</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A specialised kind of <code>TASK_GROUP</code> representing a branch in a Condition Group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>TASK_GROUP</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>test</strong>: <code>BOOLEAN_CONTEXT_EXPRESSION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Boolean-valued test expression which if True indicates that this Branch is to be followed during execution.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Invariants</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p><strong><em>Inv_no_wait_condition</em></strong>: <code>wait_spec = Void</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_decision_group_class"><a class="anchor" href="#_decision_group_class"></a>6.3.1.3. DECISION_GROUP Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DECISION_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Special kind of Task Group whose members are all <code>DECISION_BRANCH</code> instances, each of which represents a distinct value sub-range, and which represent together the total possible range of values of the test expression.</p>
</div>
<div class="paragraph">
<p>This structure is the equivalent of a programming switch statement. It is processed in order, and for situations that need it, the last branch may represent an 'any value', corresponding to a final 'else' at the end of the switch.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>TASK_GROUP</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>test</strong>: <code>CONTEXT_EXPRESSION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Test expression that generates a value of any type whose sub-ranges may be assigned to the various output branches, in the manner of a switch statement.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>members</strong>: <code>List&lt;DECISION_BRANCH&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set of branches in this Decision Group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Invariants</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p><strong><em>Inv_no_wait_condition</em></strong>: <code>wait_spec = Void</code></p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p><strong><em>Inv_seq_execution</em></strong>: <code>execution_type = EXECUTION_TYPE.sequential</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_decision_branch_class"><a class="anchor" href="#_decision_branch_class"></a>6.3.1.4. DECISION_BRANCH Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DECISION_BRANCH</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A specialised kind of <code>TASK_GROUP</code> representing a branch in a Decision Group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>TASK_GROUP</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>value_constraint</strong>: <code>Any</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Constraint on result value of the owning Decision Group <code><em>test</em></code> expression, for this branch.</p>
</div>
<div class="paragraph">
<p>TODO: consider use of <code>C_PRIMITIVE_OBJECT</code> from AOM as constrainer type.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Invariants</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p><strong><em>Inv_no_wait_condition</em></strong>: <code>wait_spec = Void</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_event_group_class"><a class="anchor" href="#_event_group_class"></a>6.3.1.5. EVENT_GROUP Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EVENT_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Special kind of Task Group whose members are <code>EVENT_BRANCH</code> instances each representing a mutually exclusive Event Wait, the first of which occurs determines the execution path.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>TASK_GROUP</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>timeout</strong>: <code>TIMER_WAIT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Timer to start on entry into Event Group. If no events are received within this time, a branch with a Timer Expiry event type can be entered. If no such branch is defined, the Timer Expiry may be used to display a message to the performer.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>members</strong>: <code>List&lt;EVENT_BRANCH&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set of branches in this Event Group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Invariants</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p><strong><em>Inv_parallel</em></strong>: <code>execution_type = EXECUTION_TYPE.parallel</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_event_branch_class"><a class="anchor" href="#_event_branch_class"></a>6.3.1.6. EVENT_BRANCH Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EVENT_BRANCH</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>A specialised kind of <code>TASK_GROUP</code> representing a branch in an Event Group.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>TASK_GROUP</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Invariants</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p><strong><em>Wait_spec_not_void</em></strong>: <code>wait_spec /= Void</code></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_events"><a class="anchor" href="#_events"></a>6.4. Events</h3>
<div class="sect3">
<h4 id="_event_types"><a class="anchor" href="#_event_types"></a>6.4.1. Event Types</h4>
<div class="paragraph">
<p>Work plans inevitably interact with events in the external world, as well being driven by time. In this model, points in time are modelled in terms of Events that represent the <em>reaching</em> of certain points in time or an entry in a calendar, as time passes. Consequently, specifying a time for a Task to be performed and waiting for certain Events before it can be performed are both specified in the latter form. The relevant part of the model, shown below, consists of various types of Events, and additionally, various types of <em>wait states</em> that may be used to intercept them.</p>
</div>
<div id="proc_task_planning_definition_event" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/PROC-task_planning.definition-event.svg" alt="PROC task planning.definition event">
</div>
<div class="title">Figure 23. proc.task_planning model - Events</div>
</div>
<div class="paragraph">
<p>In the above, the descendants of <code>PLAN_EVENT</code> represent various kinds of events, which roughly divide into <em>deterministic events</em>, i.e. known, system-endogenous events, and <em>non-deterministic events</em>, i.e. events from the outside world whose receipt is not guaranteed.</p>
</div>
<div class="paragraph">
<p>The event types are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TIMER_EVENT</code>: represents the expiry of a Timer that was launched at some earlier time;</p>
</li>
<li>
<p><code>TIMELINE_MOMENT</code>: represents a time-point within the global Plan timeline that is specified <em>relative</em> to the Plan&#8217;s start time, and converted to absolute time at activation; this type expresses to what is normally understood as 'clock time' or 'diary' time in the sense of a modern calendar or diary tool, and is how time can be specified directly for Tasks;</p>
</li>
<li>
<p><code>CALENDAR_EVENT</code>: represents an event in the global Plan calendar, which is specified in absolute time.</p>
</li>
<li>
<p><code>TASK_TRANSITION</code>: an event corresponding to a lifecycle transition of a Task, such as being cancelled or done;</p>
</li>
<li>
<p><code>CALLBACK_NOTIFICATION</code>: a callback notification connected to a dispatch call for a Dispatchable Task (Hand-off, External Request, System Request);</p>
</li>
<li>
<p><code>STATE_TRIGGER</code>: an event generated by a change in a tracked variable, or an expression based on tracked variables, e.g. a value reaching a threshold;</p>
</li>
<li>
<p><code>MANUAL_NOTIFICATION</code>: an event that is manually notified to the Plan execution engine by a user;</p>
</li>
<li>
<p><code>SYSTEM_NOTIFICATION</code>: an event that is notified to the Plan execution engine by a system or service;</p>
</li>
<li>
<p><code>DELAY_EVENT</code>: a special kind of event is used to represent any other event with an added delay.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Instances of all of these types, on their own only identify the type and source of an event. Events can be waited on in two ways.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_wait_state"><a class="anchor" href="#_task_wait_state"></a>6.4.2. Task Wait State</h4>
<div class="paragraph">
<p>The first way is via the <code>TASK_WAIT</code> attachable to any Plan Item, via the <code><em>wait_spec</em></code> attribute, which refers to an instance of <code>TASK_WAIT</code>. The <code>TASK_WAIT</code> class models a wait state, and defines how to specify the details of when a Task should start with respect to any of the Event types described above. Its <code><em>events</em></code> attribute enables more than multiple Events to be used as a trigger, with an assumed logical OR relation among the Events. This enables the specification of triggers such as 'at 8pm on day 1, or when oxygen saturation drops below 90% (whichever comes first)'. The <code><em>event_relation</em></code> attribute allows the Task to be specified as commencing <code>before</code>, <code>with</code> or <code>after</code> the trigger event (such as a meal). The <code><em>start_window</em></code> attribute allows for a delay from the trigger moment, and  <code><em>timeout</em></code>, if set, will cause a Timer to be started in cases where Event receipt is not certain. These Timers are just special cases of the <code>EVENT_WAIT</code> type, described below.</p>
</div>
<div class="paragraph">
<p>The combined structure of a <code>TASK_WAIT</code> and one or more <code>PLAN_EVENT</code> descendants provides a way to specify <em>when</em> a Task may be commenced, either in terms of time-related events, or non-deterministic events, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>clock time</em>: the Task is to be executed at a specific clock time represented by an instance of <code>TIMELINE_MOMENT</code>; within a Task definition, this must be specified as a relative duration with respect to the origin clock time of the Task Plan, which is only known in absolute terms at execution time;</p>
</li>
<li>
<p><em>event-linked time</em>: the Task is to be executed at a time related to a real world event, such as a meal or sleeping; in this case, an instance of <code>CALENDAR_EVENT</code> is used; the <code>TASK_WAIT</code> attributes indicate the specifics such as '1 hour before', 'with meal' etc;</p>
</li>
<li>
<p><em>notification-linked time</em>: the Task is to be executed at a time related to a notification, either from a system (specified with <code>SYSTEM_NOTIFICATION</code>) or manually notified (<code>MANUAL_NOTIFICATION</code>);</p>
</li>
<li>
<p><em>task-linked time</em>: the Task is to be executed at a time related to the timing of another Task lifecycle transition, such as completion of the previous Task; this is represented by an instance of <code>TASK_TRANSITION</code> whose <code><em>transition</em></code> indicates the required lifecycle transition;</p>
</li>
<li>
<p><em>state-linked time</em>: the Task is to be executed at a time related to the state of the subject, as specified by an instance of <code>STATE_TRIGGER</code>. This uses a Boolean-valued <code><em>expression</em></code> attribute to state a condition which when true indicates that a Task time-to-execute has been reached.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>TIMELINE_MOMENT</code> type allows a point in time relative to the start of the Plan to be specified, in terms of an offset and a fixed component, both optional. The offset part, if specified, establishes a point relative to the Plan zero point (converted to absolute form at activation), while the fixed part enables fixed points in time such as a particular hour of day or customary time such as 'afternoon' to be specified. A combination of the two such as <code>+1d, 01:30:00</code> can thus be used to state a time like '1:30 PM on day one of the plan'.</p>
</div>
</div>
<div class="sect3">
<h4 id="_event_wait_state"><a class="anchor" href="#_event_wait_state"></a>6.4.3. Event Wait State</h4>
<div class="paragraph">
<p>The second way to intercept events and subsequently perform actions is via an instance of <code>EVENT_WAIT&lt;T&gt;</code>, which is a generic class from which concrete types may be constructed based on the type of Event to be listened for. Types such as <code>EVENT_WAIT&lt;MANUAL_EVENT&gt;</code> may thus be constructed. The <code>EVENT_WAIT&lt;T&gt;</code> class has a <code><em>success_action</em></code> attribute of type <code>EVENT_ACTION</code>, which enables any of the following actions to occur on receipt of an event:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>making system calls, if the <code><em>system_call</em></code> attribute is set, e.g. to cause a notification to be sent or write to a system logger;</p>
</li>
<li>
<p>displaying a message to the user, specified in the <code><em>message</em></code> attribute.</p>
</li>
<li>
<p>optionally indicates where execution should resume in the plan, for example at an earlier Task, via the <code><em>resume_action</em></code> attribute, whose value is aninstance of <code>RESUME_ACTION</code>, defining the <code><em>resume_type</em></code> and <code><em>resume_location</em></code> attributes.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The latter attributes are normally only for use with callbacks and are described in detail below.</p>
</div>
<div class="paragraph">
<p>For non-deterministic Events, the <code>EVENT_WAIT.<em>timeout</em></code> attribute may be set to point to a <code>TIMER_WAIT</code>, which enables timeout actions to be specified.</p>
</div>
</div>
<div class="sect3">
<h4 id="_timers"><a class="anchor" href="#_timers"></a>6.4.4. Timers</h4>
<div class="paragraph">
<p>The class <code>TIMER_WAIT</code> is based on the generic type <code>EVENT_WAIT&lt;TIMER_EVENT&gt;</code>, and provides a way to specify a Timer (the <code>TIMER_EVENT</code> instance) and listen for it (the <code>TIMER_WAIT</code>). Timeouts can be used on the <code>TASK_WAIT</code> wait state as well as any <code>EVENT_WAIT</code> wait state, including <code>CALLBACK_WAIT</code>. A <code>TIMER_WAIT</code> creates a separate Event wait state that listens for a Timer event launched some duration after activation, and may result in specific actions, specified via the inherited <code>EVENT_WAIT.<em>success_action</em></code> attribute.</p>
</div>
<div class="paragraph">
<p>A specialised timer class <code>REMINDER</code> can be specified if needed, that consists of a <code>TIMER_WAIT</code> designed to generate a user notification.</p>
</div>
</div>
<div class="sect3">
<h4 id="_callbacks"><a class="anchor" href="#_callbacks"></a>6.4.5. Callbacks</h4>
<div class="paragraph">
<p>A specialisation of <code>EVENT_WAIT&lt;CALLBACK_NOTIFICATION&gt;</code> is <code>CALLBACK_WAIT</code>, used to handle notifications of dispatched Tasks that complete, as well as timeouts if no response is received. This class adds one attribute:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>fail_action</em></code>: enables a different <code>EVENT_ACTION</code> to be specified on receipt of a callback with a 'fail' status;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A Callback Wait can thus have three distinct Event responders: <code><em>success_action</em></code>, <code><em>fail_action</em></code> and <code><em>timeout</em></code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_class_descriptions_5"><a class="anchor" href="#_class_descriptions_5"></a>6.4.6. Class Descriptions</h4>
<div class="sect4">
<h5 id="_task_wait_class"><a class="anchor" href="#_task_wait_class"></a>6.4.6.1. TASK_WAIT Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_WAIT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Object representing time of an Task to be performed in terms of a related event. The <code><em>delay</em></code> attribute may be used to delay the start time by some amount. The <code><em>start_window</em></code> is used to add an 'acceptable delay' time within which the Task should be start with respect to the intended start time. The <code><em>timeout</em></code> attribute can be used for non-deterministic Events.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>clock time: event = <code>TIMELINE_MOMENT</code>, <code>CALENDAR_EVENT</code>;</p>
</li>
<li>
<p>notification-based: event =  or <code>MANUAL_EVENT</code>, <code>SYSTEM_NOTIFICATION</code>;</p>
</li>
<li>
<p>task-linked: event = <code>TASK_TRANSITION</code>, e.g. 1hr after previous Task done;</p>
</li>
<li>
<p>state-linked: event = <code>STATE_TRIGGER</code>, e.g. 'when systolic BP &gt; 165';</p>
</li>
<li>
<p>any event with added delay: <code>DELAY_EVENT</code>.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>events</strong>: <code>List&lt;PLAN_EVENT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Event that defines the intended point in time.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>event_relation</strong>: <code>TEMPORAL_RELATION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Temporal relation to the event of the point or period in time being defined by this Timing Spec.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>start_window</strong>: <code>REMINDER</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Time window after an initial time during which the action should start. Allows for approximate times to be used operationally.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>timeout</strong>: <code>TIMER_WAIT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Timeout handler to use if no other Event is received within a certain time.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_plan_event_class"><a class="anchor" href="#_plan_event_class"></a>6.4.6.2. PLAN_EVENT Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>PLAN_EVENT (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Entity representing an Event generated during system execution. Descendants define details of each kind of Event known in the system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>LOCATABLE</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>other_details</strong>: <code>ITEM_STRUCTURE</code></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_delay_event_class"><a class="anchor" href="#_delay_event_class"></a>6.4.6.3. DELAY_EVENT Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DELAY_EVENT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Event generated at a time delay after another Event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>PLAN_EVENT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>source</strong>: <code>UID_BASED_ID</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to source Event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>delay</strong>: <code>IDuration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Length of the delay.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_manual_notification_class"><a class="anchor" href="#_manual_notification_class"></a>6.4.6.4. MANUAL_NOTIFICATION Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>MANUAL_NOTIFICATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Event type representing the manual notification of a real-world event to the system, such as arrival of a test result, manually taken vital sign value over a threshold.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>PLAN_EVENT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Natural language or processable description of the event. Needs to be sufficiently detailed to distinguish it from other similar events.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_system_notification_class"><a class="anchor" href="#_system_notification_class"></a>6.4.6.5. SYSTEM_NOTIFICATION Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>SYSTEM_NOTIFICATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Event type representing a notification from a system of some event, represented by notification type and reference identifier.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>PLAN_EVENT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>system_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of system that will generate notification.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>notification_type</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Type of notification, i.e. among types generated by the source system.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>reference_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference identifier, typically a request identifier from a previous request.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_callback_notification_class"><a class="anchor" href="#_callback_notification_class"></a>6.4.6.6. CALLBACK_NOTIFICATION Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CALLBACK_NOTIFICATION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Event generated on receipt of notification of completion of a Dispatchable Task.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>PLAN_EVENT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>task_id</strong>: <code>UID_BASED_ID</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of originating Task.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>request_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of original request, may be matchable with <code>EXTERNAL_REQUEST.<em>request_id</em></code>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_state_trigger_class"><a class="anchor" href="#_state_trigger_class"></a>6.4.6.7. STATE_TRIGGER Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>STATE_TRIGGER</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Type of event representing an expression referring to one or more tracked variables, reaching a value or passing a threshold value.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>PLAN_EVENT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>expression</strong>: <code>BOOLEAN_CONTEXT_EXPRESSION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Boolean-returning expression that mentions one or more tracked variables, e.g. <code>heart_rate &gt; 120 bpm</code>. Evaluation controlled by Plan variable context.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_timer_event_class"><a class="anchor" href="#_timer_event_class"></a>6.4.6.8. TIMER_EVENT Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TIMER_EVENT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Timer expiry event generated by Task Plan engine.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>PLAN_EVENT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>duration</strong>: <code>IDuration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Delay from activation time to receive the event notification.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>purpose</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional explanatory purpose of Timer.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_calendar_event_class"><a class="anchor" href="#_calendar_event_class"></a>6.4.6.9. CALENDAR_EVENT Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CALENDAR_EVENT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Specifies an event generated during execution when the Plan clock reaches a corresponding entry in the global calendar.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>PLAN_EVENT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>entry_id</strong>: <code>UID_BASED_ID</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of entry within global Plan calendar.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>time</strong>: <code>IDate_time</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Time of entry in calendar.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_timeline_moment_class"><a class="anchor" href="#_timeline_moment_class"></a>6.4.6.10. TIMELINE_MOMENT Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TIMELINE_MOMENT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Specifies a time event generated during execution when the Plan clock reaches a specific time defined in the global Plan Timeline.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>PLAN_EVENT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>timeline_offset</strong>: <code>IDuration</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Variable part of time specification, expressed as an offset from the zero time point of the Task Plan. Converted to absolute time at activation.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fixed_time</strong>: <code>TIME_SPECIFIER</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Fixed time specification, to be added to variable time when the latter is converted to absolute time at activation. Used to expressed fixed hours in the day, when the day is movable.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_event_wait_class"><a class="anchor" href="#_event_wait_class"></a>6.4.6.11. EVENT_WAIT Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EVENT_WAIT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Wait state for any kind of Event, with a success Action and an optional separate timeout Event Wait state.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>event</strong>: <code>P</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Descriptor for event on which this wait state is based.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>success_action</strong>: <code>EVENT_ACTION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Action to perform if any listened-for event returns a success result.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>timeout</strong>: <code>TIMER_WAIT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Timeout handler to use if no other Event is received within a certain time.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_timer_wait_class"><a class="anchor" href="#_timer_wait_class"></a>6.4.6.12. TIMER_WAIT Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TIMER_WAIT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Event listener for a Timer event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EVENT_WAIT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>event</strong>: <code>TIMER_EVENT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Redefined from <code>EVENT_WAIT</code>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_reminder_class"><a class="anchor" href="#_reminder_class"></a>6.4.6.13. REMINDER Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>REMINDER</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Specialised Timer configured to generate a reminder or alert to performer or other user.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>TIMER_WAIT</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_callback_wait_class"><a class="anchor" href="#_callback_wait_class"></a>6.4.6.14. CALLBACK_WAIT Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>CALLBACK_WAIT</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Specialised descendant of <code>EVENT_ACTION &lt;CALL_BACK_NOTIFICATION&gt;</code> that adds a fail action. Used for representing post-callback actions.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EVENT_WAIT</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>fail_action</strong>: <code>EVENT_ACTION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Action to perform if any listened-for event returns a fail result.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>event</strong>: <code>CALLBACK_NOTIFICATION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Callback notification on which this Callback wait state is based.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_event_action_class"><a class="anchor" href="#_event_action_class"></a>6.4.6.15. EVENT_ACTION Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>EVENT_ACTION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Action(s) to perform on receipt of an event with a particular status. If <code><em>resume_action</em></code> is set, it dictates where execution resumes; if not, the default is to resume at the next Task in normal execution flow.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>system_call</strong>: <code>List&lt;SYSTEM_CALL&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>System call to perform on receipt of event</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>message</strong>: <code>DV_TEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional message to display to original Task context (i.e. application, form etc) if timer expires.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>resume_action</strong>: <code>RESUME_ACTION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional resume action, used when the intention is to resume in a different location than the default (i.e. next available Task).</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_resume_action_class"><a class="anchor" href="#_resume_action_class"></a>6.4.6.16. RESUME_ACTION Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>RESUME_ACTION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Type representing an execution jump to a new location in the current Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>resume_type</strong>: <code>RESUME_TYPE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Procedure to execute when completion notification received, for example, to display a form, notify performer etc.</p>
</div>
<div class="paragraph">
<p>TODO: determine details.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>resume_location</strong>: <code>UID_BASED_ID</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to a resume Task in the current Plan, at which to restart when the request / handoff has completed.</p>
</div>
<div class="paragraph">
<p>If not set, the following Task is assumed. It set, is typically an earlier Task, in situations where the current Task(s) are no longer needed once the external action has been completed.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_repetition"><a class="anchor" href="#_repetition"></a>6.5. Repetition</h3>
<div class="paragraph">
<p>Repetition may be specified in the model via the attribute <code>PLAN_ITEM.<em>repeat_spec</em></code>. This is intended to be used to designate sub-sections in a Plan as being repeatable rather than single Tasks, since the main point of a Task Plan is precisely to define individual Tasks in time for execution and sign-off.</p>
</div>
</div>
<div class="sect2">
<h3 id="_training_level"><a class="anchor" href="#_training_level"></a>6.6. Training Level</h3>
<div class="paragraph">
<p>One challenge with creating Task Plan definitions is the level of detail to use, with respect to the variable level of skill of different performers. For a senior nurse, a briefer version of the Plan would be preferable with actions such as 'set up IV with catheter' being a single atom, whereas a trainee may need to see a more detailed set of sub-tasks.</p>
</div>
<div class="paragraph">
<p>To enable a single Plan to be used in both ways, the concept of 'training level' is included in the model, on the <code>TASK_GROUP</code> class. This enables any Group of Tasks to be marked as having a specific training level, where a higher number corresponds to less experience. At execution time, the training level of the allocated performer can be obtained, and then used in comparison to the training level indicated on each Group (including the top-level Group of the whole Plan). If the user training level is higher, then the Group may be shown only as a single step (using its <code><em>description</em></code>, inherited from <code>PLAN_ITEM</code>); otherwise it may be shown as the set of sub-steps. This provides a simple way for the same Plan to be presented in different forms matching different performer experience levels.</p>
</div>
<div class="paragraph">
<p>The default value of <code><em>training_level</em></code> is 0.</p>
</div>
</div>
<div class="sect2">
<h3 id="_references_to_clinical_quality_artefacts"><a class="anchor" href="#_references_to_clinical_quality_artefacts"></a>6.7. References to Clinical Quality Artefacts</h3>
<div class="paragraph">
<p>The classes <code>WORK_PLAN</code> and <code>TASK_PLAN</code> may contain various references to externally defined clinical quality artefacts that they are based on or relate to, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In <code>WORK_PLAN</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code><em>care_plan</em></code>: a reference to an underpinning Care Plan from elsewhere in the EHR, if any exists;</p>
</li>
<li>
<p><code><em>care_pathway</em></code>: references to a care pathway from which this Task Plan was derived, if any;</p>
</li>
</ul>
</div>
</li>
<li>
<p>In <code>TASK_PLAN</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code><em>guideline</em></code>: reference to a published guideline from which this particular Task Plan was derived, if any;</p>
</li>
<li>
<p><code><em>best_practice_ref</em></code>: reference to an institutional document that defines the best practice on which this Task Plan is based, if any;</p>
</li>
<li>
<p><code><em>order_set</em></code>: the identifier of an Order Set which this Task Plan uses, if any;</p>
</li>
<li>
<p><code><em>workflow_id</em></code>: an identifier shared among orders (<code>INSTRUCTIONs</code> and <code>ACTIONs</code>) from the Order Set instance used in this Task Plan, if any.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_cost_tracking"><a class="anchor" href="#_cost_tracking"></a>6.8. Cost Tracking</h3>
<div class="paragraph tbd">
<p>TBD: describe cost tracking.</p>
</div>
<div class="sect3">
<h4 id="_class_descriptions_6"><a class="anchor" href="#_class_descriptions_6"></a>6.8.1. Class Descriptions</h4>
<div class="sect4">
<h5 id="_task_costing_class"><a class="anchor" href="#_task_costing_class"></a>6.8.1.1. TASK_COSTING Class</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_COSTING</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Costing information for a Task.</p>
</div>
<div class="paragraph tbd">
<p>TODO: to be developed.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_definition_model_patterns"><a class="anchor" href="#_definition_model_patterns"></a>7. Definition Model Patterns</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes typical workflow patterns in terms of the Definition Model described above.</p>
</div>
<div class="sect2">
<h3 id="_timing_patterns"><a class="anchor" href="#_timing_patterns"></a>7.1. Timing Patterns</h3>
<div class="paragraph">
<p>The following diagram shows the definition structures corresponding to four typical wait states, where a Task is waiting on a timing or other Event.</p>
</div>
<div id="timing_patterns_1" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/uc_task_timing_1.svg" alt="uc task timing 1" width="85%">
</div>
<div class="title">Figure 24. Timing Patterns</div>
</div>
</div>
<div class="sect2">
<h3 id="_callback_patterns"><a class="anchor" href="#_callback_patterns"></a>7.2. Callback Patterns</h3>
<div class="paragraph">
<p>The following diagram shows the defnition structure for a dispatchable Task Action with a callback.</p>
</div>
<div id="timing_callback_pattern_1" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/uc_task_callback_1.svg" alt="uc task callback 1">
</div>
<div class="title">Figure 25. Timing Patterns</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_execution_model_overview"><a class="anchor" href="#_execution_model_overview"></a>8. Execution Model Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the execution time semantics that correspond to the materialised and runtime forms of the Task Planning model.</p>
</div>
<div class="sect2">
<h3 id="_phases_of_instantiation"><a class="anchor" href="#_phases_of_instantiation"></a>8.1. Phases of Instantiation</h3>
<div class="paragraph">
<p>As described in the earlier section <a href="#_execution_concepts">Execution Concepts</a>, Work Plan execution traverses three states: <code>materialised</code>, <code>activated</code> and <code>terminated</code>. These are described in the following sub-sections.</p>
</div>
<div class="sect3">
<h4 id="_materialisation"><a class="anchor" href="#_materialisation"></a>8.1.1. Materialisation</h4>
<div class="paragraph">
<p>When a Work Plan is to be executed, it will be <em>materialised</em>, which concretely means instantiating and usually persisting it (this might be avoided for very short run Plans). Some user input may be required, e.g. number of repetitions of repeatable sections. Conditional branches whose conditions or events will never be met can also be removed during materialisation. The materialised representation consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A copy of the definition form of the Plan;</p>
</li>
<li>
<p>An instance of the Plan using Materialised model instances, i.e. the <code>M_XXX</code> classes shown below, representing the concrete executable Tasks, each with a reference back to a definition Task.</p>
</li>
<li>
<p>For Plans with repeatable sections, the Materialised model contains these sections 'unrolled' into as many instances as required by the Plan activator. In terms of the materialised model described below, some <code>M_TASK_GROUP</code> instances will have their <code><em>members</em></code> containing additional <code>M_XX</code> instances. Thus, more than one <code>M_TASK</code> may point to the same generating <code>TASK</code> from the definition.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The structure created will thus mirror the structure of the original definition, with extra copies for repeatable sections and potentially 'dead branches' removed.</p>
</div>
<div class="paragraph">
<p>At materialisation time, an instance of <code>EXECUTION_HISTORY</code> is also created, proving a root point to accumulate Plan execution event records.</p>
</div>
<div class="paragraph">
<p>Advance allocations of Tasks to concrete participants may be made in this phase.</p>
</div>
</div>
<div class="sect3">
<h4 id="_activation"><a class="anchor" href="#_activation"></a>8.1.2. Activation</h4>
<div class="paragraph">
<p>A materialised Work Plan is <em>activated</em> when it is ready to be used. Activation starts the timeline clock for the Work Plan; accordingly, execution times in the constituent Task Plans are converted to absolute clock times, or a form that can be related to clock time, e.g. via the use of the materialised Work Plan timeline and calendar.</p>
</div>
<div class="paragraph">
<p>As part of activation, the <em>runtime window</em> must be determined. This is a moving window corresponding to the section of a materialised Plan that will be actively executing at any moment. The size of the window would typically be at least a working shift (e.g. 8-12 hours), but would more typically be the number of days typically used in the organisation for lookahead planning. The part of Task Plans within a Work Plan that are inside the runtime window are in active execution, while other parts (both prior and after the window) are not currently executing but are typically available for visualisation.</p>
</div>
<div class="paragraph">
<p>When the runtime window is known, allocations for the window can be managed, as <a href="#_allocation">described below</a>. To enable allocation to take place, a communication channel must be established with each potential worker or worker pool. This may consist of any technical means, including email, instant messager, a ward screen application and so on. Allocations may be filled in a 'just in time' fashion where the technical means exists to enable it (e.g. push communications from the server).</p>
</div>
<div class="paragraph">
<p>Execution starts by commencing the Work Plan&#8217;s top-level Task Plans, and putting them into their initial wait states.</p>
</div>
<div class="paragraph">
<p>For each Task Plan, execution of the Plan section within the runtime window consists approximately of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tasks being displayed within a separate or shared application for each performer, along with lifecycle state of each Task;</p>
</li>
<li>
<p>Tasks become <em>available</em> as earlier Tasks are completed or cancelled. When a Task is available to be done, the performer has various options, including doing the work, cancelling the Task as not needed, completing the Task, or aborting it, which abandons the entire Plan;</p>
</li>
<li>
<p>performers interact with the visual representation to transition the lifecycle state appropriately;</p>
</li>
<li>
<p>as the work proceeds, event records are generated and added to the execution history.</p>
</li>
<li>
<p>the Plan remains in the <code>active</code> state until abandoned or completed.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_termination"><a class="anchor" href="#_termination"></a>8.1.3. Termination</h4>
<div class="paragraph">
<p>A Task Plan <em>terminates</em> when the execution path taken through the materialised Group/Task graph completes, either due to finishing, or due to abandonment at an intermediate Task.</p>
</div>
<div class="paragraph">
<p>The Task Plan as a whole returns a termination status of success or fail, which may be used to control behaviour if it is part of a hand-off chain in which a context switch follows termination of one Task Plan.</p>
</div>
<div class="paragraph">
<p>A Work Plan terminates when all member Task Plans have terminated in the above fashion.</p>
</div>
<div class="paragraph">
<p>An event record is added to the execution history for each Task Plan termination, and for the final Work Plan termination.</p>
</div>
</div>
<div class="sect3">
<h4 id="_allowed_plan_modifications"><a class="anchor" href="#_allowed_plan_modifications"></a>8.1.4. Allowed Plan Modifications</h4>
<div class="paragraph">
<p>After materialisation but prior to activation, changes may be made to any part of the materialised plan, corresponding to adjusting repeated sections and removing or adding back in condition branches according to relevancy with respect to newly evaluated subject variables (e.g. discovering that the patient is pregnant may require certain Decision Branches to be added back in).</p>
</div>
<div class="paragraph">
<p>Once activation has occurred, changes of the same type may still occur, but only <em>ahead of the runtime window</em>, since the parts of the Plan within the window, or already executed can&#8217;t safely or sensibly be altered.</p>
</div>
<div class="paragraph">
<p>If other kinds of changes are needed, this is generally a sign that the Plan design contains issues, and that the current version if already in use will be abandoned in favour of a newer version.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_execution_semantics"><a class="anchor" href="#_execution_semantics"></a>8.2. Execution Semantics</h3>
<div class="sect3">
<h4 id="_performer_allocation"><a class="anchor" href="#_performer_allocation"></a>8.2.1. Performer Allocation</h4>
<div class="paragraph">
<p>Before a materialised Task Plan can be executed, at least the <code><em>principal_performer</em></code> must be allocated, and depending on how long-running the Plan is, and where the current execution point is, some actors designated by <code>PERFORMABLE_ACTION.<em>other_participations</em></code> for Tasks within the current runtime window (<a href="#_activation">see above</a>) need to be allocated as well.</p>
</div>
<div class="paragraph">
<p>The allocation process consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>assignment</em> of a Plan or Task to a real actor or worker pool;</p>
</li>
<li>
<p>a <em>claim</em> by an individual to accept the request.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Assigning <em>communicates</em> a request to potential worker(s) (e.g. via application screens, personal messages, scheduling systems etc), one of which accepts the request and thereby becomes the allocated worker. This is done by user(s) authenticating to the Plan execution engine via an application and signing up for specific roles and functions within the Plan. Not all performers are needed at any time, only those implicated in some defined part of the Plan to be executed, e.g. for the current day within a multi-day Plan.</p>
</div>
<div class="paragraph">
<p>At various moments during the execution of a Plan, a performer may leave and be replaced by another performer, e.g. due to worker shift changeover. This requires a de-allocation of the leaving performer from the Plan and the allocation of a new actor.</p>
</div>
</div>
<div class="sect3">
<h4 id="_resource_allocation"><a class="anchor" href="#_resource_allocation"></a>8.2.2. Resource Allocation</h4>
<div class="paragraph tbd">
<p>TBD</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_lifecycle_2"><a class="anchor" href="#_task_lifecycle_2"></a>8.2.3. Task Lifecycle</h4>
<div class="paragraph">
<p>At runtime, it is the Tasks in a Plan that can be directly 'performed'. Accordingly, it is the Task that has a lifecycle attached to it, containing states and transitions reflecting possible actions by the performer. The lifecycle does not appear in the definition model <code>TASK</code> class as a data attribute since it is a runtime variable for a Task; hence it appears in the materialised model, <a href="#_materialised_model">described below</a>.</p>
</div>
<div class="paragraph">
<p>During execution, each Task is represented by an instance of the materialised form of the Task. Each Task in the executing Plan has a lifecycle consisting of various states it may pass through in time (recorded in <code>M_TASK.<em>lifecycle_state</em></code> in the materialised model below). The lifecycle is only has to take account of the states a Task itself can pass through; states of an order (i.e. prescription, lab request) with which the Task may be associated will be visible in the documentation of the Task execution, i.e. separate openEHR <code>ACTION</code> or other Entry objects. The Task lifecycle states are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>initial</code>: initial pseudo-state, not used in operation;</p>
</li>
<li>
<p><code>planned</code>: defined, but not yet available for execution;</p>
</li>
<li>
<p><code>available</code>: available for execution, due to previous Tasks having been performed, preconditions being met, and if there is a time specification on the Task, the current time being at or later than the stated time;</p>
</li>
<li>
<p><code>cancelled</code> (T): cancelled prior or during execution as not needed for success of the Plan;</p>
</li>
<li>
<p><code>completed</code> (T): performed to completion;</p>
</li>
<li>
<p><code>abandoned</code> (T): execution was stopped before or after commencement due to completion being impossible.;</p>
</li>
<li>
<p><code>underway</code>: indicates that a Task execution has been commenced;</p>
</li>
<li>
<p><code>suspended</code>: indicates that a Task execution has been suspended.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the above, the terminal states are marked with '(T)'. The state machine is shown below.</p>
</div>
<div id="task_state_machine" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/PROC-TaskStateMachine.svg" alt="PROC TaskStateMachine" width="80%">
</div>
<div class="title">Figure 26. Task lifecycle state machine</div>
</div>
<div class="paragraph">
<p>A key feature of the state model is that the terminal states determine whether the Plan execution continues or not: if the <code>abandoned</code> state is entered, it does not.</p>
</div>
<div class="paragraph">
<p>The state machine is primarily designed to allow a stateless view of the actual execution state of a Task. That is to say, the standard pathway is <code>available</code> &#8658; <code>completed</code> or <code>abandoned</code> or <code>cancelled</code>, which enables a user to indicate the outcome of executing a Task, but not interim states during execution. The pathways through the states <code>underway</code> and <code>suspended</code> are provided to represent in-execution states if needed, typically for longer-running atomic Tasks.</p>
</div>
<div class="paragraph">
<p>It may be that one or more Tasks do not evaluate to <code>available</code> at runtime when the principal performer wants to treat them as being available. This may happen if the performer wants to execute a Task earlier than scheduled, or decides that an unmet precondition or wait condition does not matter (for example, they may know that it is met, but the Task Plan application may not yet know). Accordingly, a user override can be used, represented by the <code><em>override</em></code> transition from <code>planned</code> &#8658; <code>available</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_availability"><a class="anchor" href="#_task_availability"></a>8.2.4. Task Availability</h4>
<div class="paragraph">
<p>Following the design principle <a href="#_allocation">described earlier</a>, the execution engine executing a Task Plan can determine the <em>availability</em> (i.e., when the transition <code>planned</code> &#8658; <code>available</code> may occur) for any Task or Task Group as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>control-flow</strong>: preceding Tasks / Groups within the current Task Group reach a terminal lifecycle state;</p>
</li>
<li>
<p><strong>wait state</strong>: any Task or Group wait state has been exited due to the arrival of the relevant events, including timeline-related events;</p>
</li>
<li>
<p><strong>subject preconditions</strong>: subject preconditions attached to the current Task Action are satisfied.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A Task is considered according to this logic even if performer and/or resources have not been allocated.</p>
</div>
<div class="paragraph">
<p>The workflow application may provide an override capability so that a Task can be performed before it is determined to be available. This would enable a user to perform the Task anyway, causing the lifecycle transition '<em>override</em>` from <code>planned</code> to <code>available</code>. A corresponding <code>TASK_EVENT_RECORD</code> is created recording the use of the override</p>
</div>
</div>
<div class="sect3">
<h4 id="_task_group_lifecycle_state"><a class="anchor" href="#_task_group_lifecycle_state"></a>8.2.5. Task Group Lifecycle State</h4>
<div class="paragraph">
<p>Since a Task Plan is a hierarchical structure consisting of one or more Task Groups, a way of rolling up Task state is needed. Once a Task Group has become <code>available</code> and been entered, i.e. any wait state or timing (<code>PLAN_ITEM.<em>wait_spec</em></code>) has been satisfied, a way of computing its <em>effective lifecycle state</em> is required, so that the Task Group can be considered as a unit within its parent for the purpose of determining cntrol flow.</p>
</div>
<div class="paragraph">
<p>The following algorithm is used to compute the effective lifecycle state of a Materialised Task Group from the set of states of its members (which may recusively may other Materialised Task Groups).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><span class="tok-c1">//</span>
<span class="tok-c1">// Infer the state of a collection whose members have states in sourceStates.</span>
<span class="tok-c1">// The order of if/else evaluation determines the correct result.</span>
<span class="tok-c1">//</span>
<span class="tok-n">TaskState</span> <span class="tok-nf">inferredState</span> <span class="tok-o">(</span><span class="tok-n">Set</span><span class="tok-o">&lt;</span><span class="tok-n">TaskState</span><span class="tok-o">&gt;</span> <span class="tok-n">sourceStates</span><span class="tok-o">)</span> <span class="tok-o">{</span>

    <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Abandoned</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Abandoned</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Available</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Available</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Planned</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Planned</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Suspended</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Suspended</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Underway</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Underway</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Completed</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Completed</span><span class="tok-o">;</span>
    <span class="tok-k">else</span> <span class="tok-k">if</span> <span class="tok-o">(</span><span class="tok-n">sourceStates</span><span class="tok-o">.</span><span class="tok-na">contains</span><span class="tok-o">(</span><span class="tok-n">Cancelled</span><span class="tok-o">))</span>
        <span class="tok-k">return</span> <span class="tok-n">Cancelled</span><span class="tok-o">;</span>
    <span class="tok-k">else</span>
        <span class="tok-k">return</span> <span class="tok-n">Initial</span><span class="tok-o">;</span>
<span class="tok-o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Because a (materialised) Task Group is also the top-level structure of the runtime Task Plan, the inferred state of a Task Plan as a whole is also provided by this algorithm applied to the top Group.</p>
</div>
</div>
<div class="sect3">
<h4 id="_execution_path"><a class="anchor" href="#_execution_path"></a>8.2.6. Execution Path</h4>
<div class="paragraph">
<p>One of the consequences of Tasks being transitioned to terminal lifecycle states such as <code>completed</code>, <code>cancelled</code>, etc within the hierarchical Task Group structure is that an effective lifecycle state has to be computed for Task Group objects at runtime as well, as shown above. Essentially it computes the effective state for a Task Group at runtime as a terminal state if there are only Tasks in terminal states. In other words, completing, cancelling or abandoning all Tasks within a Group causes completion of the Group, and this applies when it is in parallel or seqential execution mode.</p>
</div>
<div class="paragraph">
<p>If a Task Group has more complex execution rules (<code>TASK_GROUP.<em>execution_rules</em></code>) such as 'exit on first Task to complete', then its completion state will be affected by this, and will be calculable according to the particular rules defined. Such rules can be understood as a short-hand for cancelling Tasks that are not needed, so that the effective Group lifecycle state can still be computed in the standard way.</p>
</div>
<div class="paragraph">
<p>Completing a Group will ripple back up the Task Group hierarchy to the point where the completed Group is not the final outstanding Task or Group in the parent.</p>
</div>
<div class="paragraph">
<p>This model results in an execution path during normal processing that is effectively a traversal of the acyclic graph represented by the Task Group containment structure.</p>
</div>
<div class="paragraph">
<p>It also determines as a side effect how logical execution path 'jumps' due to the use of <code>EVENT_ACTION.<em>resume_action</em></code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_resume_semantics"><a class="anchor" href="#_resume_semantics"></a>8.2.7. Resume Semantics</h4>
<div class="paragraph">
<p>The <code><em>resume_type</em></code> and <code><em>resume_location</em></code> attributes of the <code>RESUME_ACTION</code> class constitute the possibility of an uncontrolled jump or 'goto' within the Task execution structure. If allowed without limitation, it is likely to lead to undecidable situations in Plan execution, and unreliable execution histories. For example, if the execution history shows that some Task Y was performed, then it would normally be assumed that the preceding Task X had also been performed (even if cancelled), and by extension that any wait state such as an Event Branch had been satisifed by the relevant event being received. If however, a jump to Task Y from some Task A on a completely separate path were allowed, no such inference can be made, without appropriate processing rules regarding such jumps.</p>
</div>
<div class="paragraph">
<p>To create workable rules, the notion of the <em>execution path</em> described above has to be used, i.e. the path traversed so far throught the Group / Task graph to the current point. Because the graph has no cycles, a <em>most recent common location</em> for the execution path actually taken and the designated resume location can always be found. This location may be somewhere back in the current path, including at the start (no real common point), or the current Task (resume location is ahead, not behind).</p>
</div>
<div class="paragraph">
<p>Making the execution valid according to the Plan while allowing an arbitrary resumption point requires finding a <em>valid path</em> from the most recent common location to the resume location. This can be done if the intermediate steps from the most recent common point and the resume point can be shown to be traversable. There are three situations that can occur at each node along this path:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>normal Tasks with no <code><em>wait_spec</em></code> (i.e. planned or event-based timing): these may be automatically cancelled, meaning 'not done, not needed';</p>
</li>
<li>
<p>normal Tasks with a <code><em>wait_spec</em></code>: these can be traversed if the relevant time or other events are known to have already been received;</p>
</li>
<li>
<p>conditional Group structures: these can be traversed if the relevant conditions and/or events are known to be true, or to have already been received, respectively.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Whether the intermediate logical conditions or event wait states (including timeline events) up to the resume location are satisfiable can in general only be known at execution time. This means that at design time, no general rule can be used to limit the choice of a resume location. However, the intermediate wait states and conditions can be determined easily enough and shown in a tool to the designer, enabling at least a guess as to viability.</p>
</div>
<div class="paragraph">
<p>What actually happens at execution time depends on where the resume location is, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>forward resume</strong>: the resume location is ahead of the current point on the execution path; getting there just requires the above algorithm of cancellation with condition and event checks;</p>
</li>
<li>
<p><strong>alternate path</strong>: the resume location is on an alternate branch with respect to the current execution path; this may be treated as for the forward resume case;</p>
</li>
<li>
<p><strong>current path</strong>: the resume location is earlier on the current path.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The last possibility implies the need to <em>retry</em> Tasks already performed, which must be in either the <code>cancelled</code> or <code>completed</code> state. Assuming that the intention of the resume location is to perform (again) the Task or Group at that location, the latter must be put back into the <code>available</code> state. This is enabled by the special transitions <code><em>retry</em></code> from <code>cancelled</code> to <code>available</code> and <code><em>redo</em></code> from or <code>completed</code> to <code>available</code>.</p>
</div>
<div class="paragraph">
<p>This doesn&#8217;t address what should happen at execution time when conditions or wait states at intermediate nodes from the most recent common point to the resume point cannot be met. The simplest approach is that they are manually overridden, as may already be done in normal path processing. This has the effect that such overrides are  at least recorded in the execution history.</p>
</div>
</div>
<div class="sect3">
<h4 id="_persistence"><a class="anchor" href="#_persistence"></a>8.2.8. Persistence</h4>
<div class="paragraph">
<p>The run-time instance structure may need to be persisted to enable a partial execution of a long-running Task Plan to be recorded and picked up when later tasks become ready. In theory, this could be within the EHR, but it is recommended that either a specific EHR area be used for this, or that run-time state persistence be implemented outside the EHR proper.</p>
</div>
<div class="paragraph tbd">
<p>issue-runtime-persistence: if within the EHR, we could create a new 'pointer' on the EHR object that points to 'task runtime state' data or similar. Is this a useful thing to do?</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_materialised_model"><a class="anchor" href="#_materialised_model"></a>9. Materialised Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>9.1. Overview</h3>
<div class="paragraph">
<p>The <a href="#proc_task_planning_overview">Model overview figure</a> shows a package <code>proc.task_planning.materialised</code>. This is a partial specification of classes that could be instantiated at Task Plan execution time to track Plan execution, and is provided as a guide to implementing a materialised form for runtime use. A minimal materialised model is described here, as a means of indicating some of the general issues that will be encountered in representation of the runtime form of a Plan definition. <strong>It should not be considered either normative or complete</strong>. The model is shown below.</p>
</div>
<div id="proc_task_planning_materialised" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/PROC-task_planning.materialised.svg" alt="PROC task planning.materialised">
</div>
<div class="title">Figure 27. proc.task_planning.materialised package</div>
</div>
</div>
<div class="sect2">
<h3 id="_class_descriptions_7"><a class="anchor" href="#_class_descriptions_7"></a>9.2. Class Descriptions</h3>
<div class="sect3">
<h4 id="_m_work_plan_class"><a class="anchor" href="#_m_work_plan_class"></a>9.2.1. M_WORK_PLAN Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_WORK_PLAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Materialised form of <code>WORK_PLAN</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>plans</strong>: <code>List&lt;M_TASK_PLAN&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Member Plans.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>owner</strong>: <code>WORK_PLAN</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Owning Work Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>timeline</strong>: <code>M_TIMELINE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Materialised global timeline.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>calendar</strong>: <code>M_CALENDAR</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Materialised global calendar.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>context</strong>: <code>M_PLAN_DATA_CONTEXT</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Materialised global context.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_task_plan_class"><a class="anchor" href="#_m_task_plan_class"></a>9.2.2. M_TASK_PLAN Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_TASK_PLAN</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Root object of a materialised Task Plan structure, used in execution.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>start_time</strong>: <code>Date_time</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Nominal start time for the Task Plan as a whole. The timings of individual Tasks may be specified as offsets from this time, via <code>PLANNED_TIME.<em>relative_offset</em></code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>M_TASK_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Root of run-time Task Plan Task structure.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>owner</strong>: <code>TASK_PLAN</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Owning Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>pending_callbacks</strong>: <code>List&lt;M_CALLBACK&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference list of all wait conditions in the Task Plan, and current status.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>principal_performer</strong>: <code>M_PERFORMER_ALLOCATION</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Run-time principal performer - a person or other agent.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong> (): <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Lifecycle state of Task Plan, derived as a copy of the <code><em>lifecycle_state()</em></code> of the definition <code>TASK_GROUP</code>.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_plan_item_class"><a class="anchor" href="#_m_plan_item_class"></a>9.2.3. M_PLAN_ITEM Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>M_PLAN_ITEM (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent of materialised run-time types that correspond to design time <code>PLAN_ITEM</code> instances.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>PLAN_ITEM</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Corresponding item from Task Plan definition. Redefined in descendants to the definition type corresponding to each runtime (RT_XXX) type.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_task_group_class"><a class="anchor" href="#_m_task_group_class"></a>9.2.4. M_TASK_GROUP Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_TASK_GROUP</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Materialised form of <code>TASK_GROUP</code> from a Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>M_PLAN_ITEM</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>members</strong>: <code>List&lt;M_PLAN_ITEM&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Member run-time items in group, mimicking structure of the corresponding definition group instance.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>TASK_GROUP</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to corresponding TASK_GROUP instance in Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong> (): <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Effective lifecycle state, computed from the states of members of the group.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_task_class"><a class="anchor" href="#_m_task_class"></a>9.2.5. M_TASK Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_TASK</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Materialised form of <code>TASK</code> type and its descendants from a Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>M_PLAN_ITEM</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Current lifecycle state of this Task at run-time.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>events</strong>: <code>List&lt;TASK_EVENT_RECORD&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of references to run-time events that have occurred on this Task.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>preconditions</strong>: <code>List&lt;ASSERTION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Run-time form of preconditions on corresponding TASK in Task Plan definition.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1<br>
(redefined)</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>TASK</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Reference to corresponding TASK instance in Task Plan definition.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_m_task_action_class"><a class="anchor" href="#_m_task_action_class"></a>9.2.6. M_TASK_ACTION Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>M_TASK_ACTION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Materialised form of <code>TASK_ACTION</code> type.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definition</strong>: <code>TASK_ACTION</code></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_plan_execution_history"><a class="anchor" href="#_plan_execution_history"></a>10. Plan Execution History</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_3"><a class="anchor" href="#_overview_3"></a>10.1. Overview</h3>
<div class="paragraph">
<p>The history of execution events from a Work Plan execution is represented in the runtime instances of classes defined in the <code>proc.task_planning.history</code> package, of which <code>EXECUTION_HISTORY</code> is the root.</p>
</div>
<div id="proc_task_planning_history" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/PROC-task_planning.history.svg" alt="PROC task planning.history">
</div>
<div class="title">Figure 28. proc.task_planning.history package</div>
</div>
<div class="paragraph">
<p>As shown above, two types of execution event are defined:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TASK_EVENT_RECORD</code>: type representing a change to one consitutent Task. Thus, if the performer cancels a particular Task within the list, a <code>TASK_EVENT_RECORD</code> will be added to the history, including Task id, time, and reason; notifications can also be recorded on such events;</p>
</li>
<li>
<p><code>TASK_PLAN_EVENT_RECORD_</code>: type representing any kind of execution event not linked to a specific Task, for example 'plan abandonment', 'new principal performer'.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first type may also include forward references to EHR Entries that were committed as a result of a Task being performed. This facilitates logical indexing of planned and performed work items.</p>
</div>
<div class="paragraph tbd">
<p>ISSUE-fwd-refs: entry_instance is a forward reference - which requires updating the Task Plan after the Tasks have beed performed and relevant Entries committed. Is this complication worth the benefit obtained, i.e. directly followable links rather than querying, to find Entries from the Task Plan items? Is being able to determine the resulting Entries starting from the Task Plan even useful?</p>
</div>
<div class="paragraph">
<p>The Execution history for a Plan execution will grow and might become quite long for some Task Plan executions. How it may be persisted in various ways. The following possibilities are all compatible with both the model, and typical EHR requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In the Task Plan application persistence:</p>
<div class="ulist">
<ul>
<li>
<p>persist the full history, delete or archive once the Task Plan is fully completed;</p>
</li>
</ul>
</div>
</li>
<li>
<p>In the EHR:</p>
<div class="ulist">
<ul>
<li>
<p>persist the full history in some or all cases, if useful in the EHR environment (e.g. for teaching);</p>
</li>
<li>
<p>persist a partial / filtered version of the history, e.g. retain only <em>cancel</em> and <em>abort</em> events, on the basis that completed Tasks will show up as <code>ACTIONs</code> elsewhere in the EHR;</p>
</li>
<li>
<p>don&#8217;t persist any of the history - rely on the workflow application persistence for it during execution, and forget afterward.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>This approach cleanly separates the definitional representation of a Task Plan, which should only change if changes to the plan are made, and the execution state, which is built during the work performance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_class_descriptions_8"><a class="anchor" href="#_class_descriptions_8"></a>10.2. Class Descriptions</h3>
<div class="sect3">
<h4 id="_task_plan_execution_history_class"><a class="anchor" href="#_task_plan_execution_history_class"></a>10.2.1. TASK_PLAN_EXECUTION_HISTORY Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PLAN_EXECUTION_HISTORY</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>History of Task Plan execution events and notifications. May be used by a workflow application to record all events during execution.</p>
</div>
<div class="paragraph">
<p>May be persisted in the EHR in partial or complete form, or not at all.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>task_events</strong>: <code>List&lt;TASK_EVENT_RECORD&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Task-level execution time events.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>plan_events</strong>: <code>List&lt;TASK_PLAN_EVENT_RECORD&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Execution time events that occurred at the Task Plan level, i.e. not to a particular task. These include events such as Task Plan abandonment.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_event_record_class"><a class="anchor" href="#_event_record_class"></a>10.2.2. EVENT_RECORD Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong><em>EVENT_RECORD (abstract)</em></strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Abstract parent of types representing execution time events on a Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>time</strong>: <code>Date_time</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Time the event occurred.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>description</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional description associated with the event. Would typically be populated for Cancel and Abort events.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_plan_event_record_class"><a class="anchor" href="#_task_plan_event_record_class"></a>10.2.3. TASK_PLAN_EVENT_RECORD Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_PLAN_EVENT_RECORD</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Record of an runtime event to a Task Plan, including abandonment, performer allocation and re-allocation and so on.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EVENT_RECORD</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>details</strong>: <code>Hash&lt;String, String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Other details as a name/value list.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_event_record_class"><a class="anchor" href="#_task_event_record_class"></a>10.2.4. TASK_EVENT_RECORD Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_EVENT_RECORD</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Record of an event for a single Task. Records task identifier, time, resulting lifecycle state and optional reason.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>EVENT_RECORD</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>task_id</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identification of Task in the Task Plan structre using a path of the form <code>/task_group_id/task_group_id</code>.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_state</strong>: <code>TASK_LIFECYCLE</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>The lifecycle state that was reached due to this event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>notifications_sent</strong>: <code>List&lt;TASK_NOTIFICATION_RECORD&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Notifications that were performed as part of this Task Event.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>entry_instances</strong>: <code>List&lt;LOCATABLE_REF&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Forward references to Entry (e.g. <code>ACTION</code>, <code>OBSERVATION</code> etc) that was recorded as a result of this Task being performed. If this is set, it indicates that the planned Task is 'done' i.e. checked off the plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>preconditions_satisfied</strong>: <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set to True if all preconditions defined on the corresponding Task were satisfied at runtime. If set to False, and there were preconditions, this means that preconditions were overridden by the user at runtime.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>wait_conditions_satisfied</strong>: <code>Boolean</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Set to True if all wait_conditions for the corresponding Task were satisfied when it was performed. If False, and there were wait_conditions, wait_conditions were overridden by the user at runtime.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>lifecycle_transition_reason</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Optional reason for lifecycle transition.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_task_notification_record_class"><a class="anchor" href="#_task_notification_record_class"></a>10.2.5. TASK_NOTIFICATION_RECORD Class</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>TASK_NOTIFICATION_RECORD</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Record of a notification to another party (i.e. performer).</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>reciever</strong>: <code>PARTY_PROXY</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identification of the receiver party</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>receiver_task_plan</strong>: <code>String</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Identifier of receiving Task Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>1..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>details</strong>: <code>Hash&lt;String, String&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Other details as a name/value list.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_transactional_service_model"><a class="anchor" href="#_transactional_service_model"></a>11. Transactional Service Model</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_4"><a class="anchor" href="#_overview_4"></a>11.1. Overview</h3>
<div class="paragraph">
<p>The information structures required to represent planned Tasks and references at design and runtime are non-trivial. For this reason, an abstract service is defined, with a transactional interface that converts calls into correct underlying information structures. The following UML diagram illustrates the services.</p>
</div>
<div id="proc_task_planning_service" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="../UML/diagrams/PROC-task_planning.service.svg" alt="PROC task planning.service">
</div>
<div class="title">Figure 29. proc.task_planning.service package</div>
</div>
</div>
<div class="sect2">
<h3 id="_definition_interface"><a class="anchor" href="#_definition_interface"></a>11.2. Definition Interface</h3>
<div class="paragraph tbd">
<p>TBC:</p>
</div>
</div>
<div class="sect2">
<h3 id="_execution_time_interface"><a class="anchor" href="#_execution_time_interface"></a>11.3. Execution-time Interface</h3>
<div class="paragraph tbd">
<p>TBC:</p>
</div>
</div>
<div class="sect2">
<h3 id="_class_descriptions_9"><a class="anchor" href="#_class_descriptions_9"></a>11.4. Class Descriptions</h3>
<div class="sect3">
<h4 id="_i_work_plan_definition_interface"><a class="anchor" href="#_i_work_plan_definition_interface"></a>11.4.1. I_WORK_PLAN_DEFINITION Interface</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_WORK_PLAN_DEFINITION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task planning API that converts transactional calls to correct Task Planning information structures at Work Plan level.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>plans</strong> (): <code>List&lt;UID_BASED_ID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of Task Plan ids for this Work Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>plan</strong> (<br>
a_task_plan_id: <code>UID_BASED_ID[1]</code><br>
): <code>List&lt;I_TASK_PLAN_DEFINITION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Obtain a Task Plan definition API interface.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_task_plan_materialised_interface"><a class="anchor" href="#_i_task_plan_materialised_interface"></a>11.4.2. I_TASK_PLAN_MATERIALISED Interface</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_TASK_PLAN_MATERIALISED</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task planning API for materialised Task Plan level.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>materialise</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>activate</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>terminate</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_work_plan_definition_interface_2"><a class="anchor" href="#_i_work_plan_definition_interface_2"></a>11.4.3. I_WORK_PLAN_DEFINITION Interface</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_WORK_PLAN_DEFINITION</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task planning API that converts transactional calls to correct Task Planning information structures at Work Plan level.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>plans</strong> (): <code>List&lt;UID_BASED_ID&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>List of Task Plan ids for this Work Plan.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>plan</strong> (<br>
a_task_plan_id: <code>UID_BASED_ID[1]</code><br>
): <code>List&lt;I_TASK_PLAN_DEFINITION&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Obtain a Task Plan definition API interface.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_i_task_plan_materialised_interface_2"><a class="anchor" href="#_i_task_plan_materialised_interface_2"></a>11.4.4. I_TASK_PLAN_MATERIALISED Interface</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Interface</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>I_TASK_PLAN_MATERIALISED</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div><div class="paragraph">
<p>Task planning API for materialised Task Plan level.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>materialise</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>activate</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>terminate</strong></p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_relationship_with_other_openehr_ehr_artefacts"><a class="anchor" href="#_relationship_with_other_openehr_ehr_artefacts"></a>12. Relationship with other openEHR EHR Artefacts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_5"><a class="anchor" href="#_overview_5"></a>12.1. Overview</h3>
<div class="paragraph">
<p>One of the side-effects of distinct state machines for <code>INSTRUCTIONs</code> and Task Plans is that not all careflow steps and states in the former need to be represented as Tasks in a Task Plan. For example, a significant number of careflow steps defined in <code>ACTION</code> archetypes are for non-Active states, e.g. Planning, Postponement, Suspension etc. These steps do not need to have Tasks defined for them, since by definition they are nearly all unplanned.</p>
</div>
<div class="paragraph">
<p>As a consequence, most Tasks in a Task Plan correspond only to Active-state careflow steps of constituent order <code>INSTRUCTIONs</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_execution_time_ehr_structures"><a class="anchor" href="#_execution_time_ehr_structures"></a>12.2. Execution-time EHR Structures</h3>
<div class="paragraph">
<p>The model described here provides significant power when used with openEHR Instructions, Actions and Observations to represent clinical work driven by guidelines and order sets. This section describes the relationship of information instances that correspond to the various phases of work described earlier, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>ordering</em>: creation of <code>INSTRUCTIONs</code>;</p>
</li>
<li>
<p><em>task planning</em>: creation of <code>TASK_PLAN(s)</code> representing a plan of individual tasks that achieve the order intention;</p>
</li>
<li>
<p><em>execution</em>: creation of <code>ACTION</code> and other Entry types that document the Tasks as they were performed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The model supports logical linking between these items to support workflow traceability. The following figure illustrates both aspects, which are further described below.</p>
</div>
<div id="runtime_planning_structures" class="imageblock text-center" style="text-align: center">
<div class="content">
<img src="diagrams/planning_runtime_structures.svg" alt="planning runtime structures" width="80%">
</div>
<div class="title">Figure 30. Runtime planning structures</div>
</div>
<div class="paragraph">
<p>Various links can be recorded at execution time, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>planned Task to Order reference</strong>: the <code>TASK_EVENT_RECORD.entry_instances</code> attribute is used to record reverse reference(s) from a <code>TASK</code> to an <code>ACTIVITY</code> within an <code>INSTRUCTION</code> that records a corresponding order, if one exists (shown on the diagram as a logical link from <code>DEFINED_ACTION</code> to <code>ACTIVITY</code> instances);</p>
</li>
<li>
<p><strong>planned Task to performed Task reference</strong>: the <code>TASK_EVENT_RECORD.entry_instances</code> attribute is used to record a forward reference to the Entry instance that was created when this Task was performed, i.e. some <code>ACTION</code>, <code>OBSERVATION</code> etc (shown on the diagram as a logical link from <code>DEFINED_ACTION</code> to <code>ACTION</code> instances);</p>
</li>
<li>
<p><strong>performed Task to planned Task reference</strong>: the <code>ENTRY.<em>workflow_id</em></code> attribute may be used to record a reverse reference from an <code>ACTION</code>, <code>OBSERVATION</code> etc to a causing <code>TASK</code> instance.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_publications"><a class="anchor" href="#_publications"></a>Publications</h3>
<div class="olist bibliography">
<ol class="bibliography">
<li>
<p><a id="van_der_Aalst_2005a"></a>[van_der_Aalst_2005a] Van der Aalst, Weske, Grunbauer. <strong>Case Handling: A New Paradigm for Business Process Support.</strong> Data and Knowledge Engineering, 53(2):129-162, 2005.</p>
</li>
<li>
<p><a id="van_der_Aalst_2013a"></a>[van_der_Aalst_2013a] Wil van der Aalst. <strong>Business Process Management: A Comprehensive Survey.</strong> ISRN Software Engineering, pages 1-37, 2013. doi:10.1155/2013/507984.</p>
</li>
<li>
<p><a id="Baretto_2005"></a>[Baretto_2005] Barretto S A. <strong>Designing Guideline-based Workflow-Integrated Electronic Health Records.</strong> 2005. PhD dissertation, University of South Australia. Available at <a href="http://www.cis.unisa.edu.au/~cissab/Barretto_PhD_Thesis_Revised_FINAL.pdf" class="bare">http://www.cis.unisa.edu.au/~cissab/Barretto_PhD_Thesis_Revised_FINAL.pdf</a>.</p>
</li>
<li>
<p><a id="Beale_2000"></a>[Beale_2000] Beale T. <strong>Archetypes: Constraint-based Domain Models for Future-proof Information Systems.</strong> 2000.  Available at <a href="http://www.openehr.org/files/resources/publications/archetypes/archetypes_beale_web_2000.pdf" class="bare">http://www.openehr.org/files/resources/publications/archetypes/archetypes_beale_web_2000.pdf</a> .</p>
</li>
<li>
<p><a id="Beale_2002"></a>[Beale_2002] Beale T. <strong>Archetypes: Constraint-based Domain Models for Future-proof Information Systems.</strong> Eleventh OOPSLA Workshop on Behavioral Semantics: Serving the Customer (Seattle, Washington, USA, November 4, 2002). Edited by Kenneth Baclawski and Haim Kilov. Northeastern University, Boston, 2002, pp. 16-32. Available at <a href="http://www.openehr.org/files/resources/publications/archetypes/archetypes_beale_oopsla_2002.pdf" class="bare">http://www.openehr.org/files/resources/publications/archetypes/archetypes_beale_oopsla_2002.pdf</a> .</p>
</li>
<li>
<p><a id="BPTrends_2009"></a>[BPTrends_2009] <strong>Case Management: Combining Knowledge With Process.</strong> White paper in BPTrends July 2009.</p>
</li>
<li>
<p><a id="Browne_2005"></a>[Browne_2005] Eric Browne. <strong>Workflow Modelling of Coordinated Inter-Health-Provider Care Plans.</strong> PhD thesis submitted to the School of Computer and Information Science, University of South Australia. January 2005.</p>
</li>
<li>
<p><a id="GLIF"></a>[GLIF] Lucila Ohno-Machado, John H. Gennari, Shawn N. Murphy, Nilesh L. Jain, Samson W. Tu, Diane E. Oliver, Edward Pattison-Gordon, Robert A. Greenes, Edward H. Shortliffe, and G. Octo Barnett.  <strong>The GuideLine Interchange Format - A Model for Representing Guidelines</strong>. J Am Med Inform Assoc. 1998 Jul-Aug; 5(4): 357–372.</p>
</li>
<li>
<p><a id="Hull_et_al_2010a"></a>[Hull_et_al_2010a] Richard Hull et al. <strong>Introducing the Guard-Stage-Milestone Approach for Specifying Business Entity Lifecycles.</strong> Preprint from Proc. Intl. Workshop on Web Services and Formal Methods (WS-FM), 2010. To appear in Springer-VerlagLNCS 6551.</p>
</li>
<li>
<p><a id="Mulyar_et_al_2007"></a>[Mulyar_et_al_2007]  Nataliya Mulyar, Maja Pesic, Wil M.P. van der Aalst and Mor Peleg. <strong>Declarative and Procedural Approaches for Modelling Clinical Guidelines: Addressing Flexibility Issues.</strong> Conference: Business Process Management Workshops, BPM 2007 International Workshops, BPI, BPD, CBP, ProHealth, RefMod, semantics4ws, Brisbane, Australia, September 24, 2007.</p>
</li>
<li>
<p><a id="Mulyar_et_al_2008"></a>[Mulyar_et_al_2008] Nataliya Mulyar, Maja Pesic, Wil M.P. van der Aalst and Mor Peleg. <strong>Towards the Flexibility in Clinical Guideline Modelling Languages.</strong></p>
</li>
<li>
<p><a id="Hofstede_van_der_Aalst_2009"></a>[Hofstede_van_der_Aalst_2009] Hofstede, van der Aalst et al. <strong>Modern Business Process Automation: YAWL and its Support Environment.</strong> Springer 2009.</p>
</li>
<li>
<p><a id="Mei_et_al_2014"></a>[Mei_et_al_2014] Jing MEI, Jing LI, Yiqin YU, Xiang LI, Haifeng LIU and Guotong XIE. <strong>Embracing case management for computerization of care pathways.</strong> e-Health – For Continuity of Care C. Lovis et al. (Eds.) 2014 European Federation for Medical Informatics and IOS Press. doi:10.3233/978-1-61499-432-9-3</p>
</li>
<li>
<p><a id="Müller_2003"></a>[Müller_2003] Robert Müller. <strong>Event-Oriented Dynamic Adaptation of Workflows: Model, Architecture, and Implementation.</strong> PhD thesis submitted to Fakultät für Mathematik und Informatik at the Universität Leipzig, 2003.</p>
</li>
<li>
<p><a id="Pescosolido"></a>[Pescosolido] Bernice A. Pescosolido, Indiana University, USA. <strong>Patient trajectories.</strong> <a href="http://onlinelibrary.wiley.com/doi/10.1002/9781118410868.wbehibs282/pdf">Wiley Online Library</a></p>
</li>
<li>
<p><a id="Russell_et_al_2007"></a>[Russell_et_al_2007]  N. Russell, A.H.M. ter Hofstede, and W.M.P. van der Aalst. <strong>newYAWL: Specifying a Workflow Reference Language using Coloured Petri Nets.</strong> In K. Jensen, editor, Proceedings of the Eighth Workshop on the Practical Use of Coloured Petri Nets and CPN Tools (CPN 2007), volume 584 of DAIMI, pages 107-126, Aarhus, Denmark, October 2007. University of Aarhus.</p>
</li>
<li>
<p><a id="Schrijvers_et_al_2012"></a>[Schrijvers_et_al_2012] Guus Schrijvers, Arjan van Hoorn, Nicolette Huiskes. <strong>The Care Pathway Concept: concepts and theories: an introduction.</strong> International Journal of Integrated Care. 2012;12(6). DOI: <a href="http://doi.org/10.5334/ijic.812" class="bare">http://doi.org/10.5334/ijic.812</a></p>
</li>
<li>
<p><a id="Vanhaecht_et_al_2007"></a>[Vanhaecht_et_al_2007] Vanhaecht K, De Witte K, Sermeus W. <strong>The impact of clinical pathways on the organisation of care processes.</strong> PhD dissertation, Belgium: KU Leuven; 2007.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-11-30 00:01:07 GMT
</div>
</div>
</body>
</html>